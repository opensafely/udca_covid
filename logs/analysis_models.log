
. 
. * Open file to write results to 
. file open tablecontent using ./output/tables/cox_models.txt, write text repla
> ce
(note: file ./output/tables/cox_models.txt not found)

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     missings report
  4.     * Open file to write results
.     describe
  5.     gen index_date = date("01/03/2020", "DMY")
  6.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  7.     count if `outcome'_flag==1
  8.     if r(N) > 10 {
  9.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
 10.         graph export ./output/graphs/km_`outcome'.svg, as(svg) replace
 11.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 12.         estimates save "./output/tempdata/crude_`outcome'", replace 
 13.         eststo model1
 14.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_`outcome'", replace) idstr("crude_`outcome'") 
 15.         estat phtest, detail
 16.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_`outcome') ///
>                     note("")
 17.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 18.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 19.         eststo model2
 20.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_`outcome'", replace) idstr("adj_`outcome'") 
 21.         estat phtest, detail
 22.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 23.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 24.         eststo model3
 25.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_`outcome'", replace) idstr("adj_`outcome'") 
 26.         estat phtest, detail
 27.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_`outcome') ///
>                     note("")
 28.         graph combine uni_plot_`outcome' adj_plot_`outcome'
 29.         graph export ./output/graphs/schoenplot_`outcome'.svg, as(svg) rep
> lace 
 30.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 31.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 32.         tab number 
 33.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 34.         tab unexposed_ever if number==1
 35.         safecount if unexposed_ever==0 & number==1
 36.         local denominator = r(N)
 37.         safecount if udca == 0 & `outcome'_flag == 1
 38.         local event = r(N)
 39.         di "no udca events = " `event'
 40.         bysort udca: egen total_follow_up = total(_t) if number==1
 41.         su total_follow_up if udca==0 & number==1
 42.         local person_mth = r(mean)/30
 43.         di `person_mth'
 44.         local rate = 100000*(`event'/`person_mth')
 45.         di `rate'
 46.         if `event'>10 & `event'!=. {
 47.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 48.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 49.             }
 50.         else {
 51.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 52.             continue
 53.         }
 54.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 55.         tab exposed_ever if number==1
 56.         qui safecount if exposed_ever==1 & number==1
 57.         local denominator = r(N)
 58.         qui safecount if udca == 1 & `outcome'_flag == 1
 59.         local event = r(N)
 60.         di "udca events = " `event'
 61.         qui su total_follow_up if udca==1 & number==1
 62.         local person_mth = r(mean)/30
 63.         local rate = 100000*(`event'/`person_mth')
 64.         if `event'>10 & `event'!=. {
 65.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 66.             cap estimates use "./output/tempdata/crude_`outcome'" 
 67.             cap lincom udca, eform
 68.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 69.             cap estimates clear
 70.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 71.             cap lincom udca, eform
 72.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 73.             cap estimates clear
 74.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 75.             cap lincom udca, eform
 76.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 77.             cap estimates clear
 78.         }
 79.         else {
 80.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 81.             continue
 82.         }
 83.     
. drop total_follow_up
 84.     }
 85. else { 
 86.     file write tablecontent ("`outcome'") _tab ("redact") _n
 87.     continue
 88. }
 89. }

Checking missings in all variables:
1485 observations with missing values

  +------------------+
  |        # missing |
  |------------------|
  |  stp        1473 |
  | male          22 |
  +------------------+

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         2,927                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,927  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,927  observations remaining, representing
      1,000  subjects
        168  failures in single-failure-per-subject data
    652,287  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  168

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_died_covid_any.svg not found)
(file ./output/graphs/km_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -411.91547
Iteration 1:   log pseudolikelihood = -411.91449
Iteration 2:   log pseudolikelihood = -411.91449
Refining estimates:
Iteration 0:   log pseudolikelihood = -411.91449

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,454
No. of failures      =          168
Time at risk         =       652287
                                                Wald chi2(1)     =        0.00
Log pseudolikelihood =   -411.91449             Prob > chi2      =      0.9648

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9827369   .3878719    -0.04   0.965     .4533989    2.130071
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/crude_died_covid_any.ster not found)
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.04003         0.14        1         0.7064
      ------------+---------------------------------------------------
      global test |                      0.14        1         0.7064
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -410.85503
Iteration 2:   log pseudolikelihood = -410.85503
Refining estimates:
Iteration 0:   log pseudolikelihood = -410.85503

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(3)     =        0.61
Log pseudolikelihood =   -410.85503             Prob > chi2      =      0.8951

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9732719   .3842749    -0.07   0.945     .4489067    2.110145
      age_tv |   1.000493   .0046262     0.11   0.915     .9914673    1.009602
        male |   1.179671   .2518546     0.77   0.439     .7763067    1.792622
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/p_adj_model_died_covid_any.ster not found)
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.05587         0.28        1         0.5971
      age_tv      |     -0.23208         5.68        1         0.0172
      male        |      0.01986         0.03        1         0.8549
      ------------+---------------------------------------------------
      global test |                      5.94        3         0.1147
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -404.26959
Iteration 2:   log pseudolikelihood = -403.98411
Iteration 3:   log pseudolikelihood = -403.98232
Iteration 4:   log pseudolikelihood = -403.98232
Refining estimates:
Iteration 0:   log pseudolikelihood = -403.98232

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(19)    =       15.90
Log pseudolikelihood =   -403.98232             Prob > chi2      =      0.6643

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9683593   .4019515    -0.08   0.938     .4292551    2.184528
      age_tv |   1.000846   .0047264     0.18   0.858     .9916256    1.010153
        male |   1.293802   .2794157     1.19   0.233     .8473024    1.975593
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.071915   .3323795     0.22   0.823     .5837405    1.968344
    Unknown  |   1.788013   .8906233     1.17   0.243     .6735663    4.746362
             |
         imd |
          2  |   1.178111   .3974714     0.49   0.627     .6081452    2.282258
          3  |   1.077853   .3916301     0.21   0.837     .5287884    2.197038
          4  |   .7453349   .2844944    -0.77   0.441     .3527343    1.574908
          5  |   .9128101   .3440421    -0.24   0.809     .4360727    1.910742
          6  |   2.019923   1.021382     1.39   0.164     .7497584    5.441873
             |
     bmi_cat |
Underweight  |   .6458651   .3034937    -0.93   0.352     .2571343    1.622272
 Overweight  |   1.335408   .3923846     0.98   0.325     .7507654    2.375328
      Obese  |   1.039927   .2911164     0.14   0.889     .6007838    1.800062
Morbidly ..  |   .9998716   .4273108    -0.00   1.000     .4326831    2.310567
             |
     smoking |
Current s..  |   1.153337   .3589253     0.46   0.647     .6266967    2.122537
  Ex-smoker  |   .6188986   .3044902    -0.98   0.329     .2359605    1.623304
             |
severe_dis~e |    1.03248   .2381679     0.14   0.890     .6569471    1.622681
covid_vacc~t |    .507449   .1819476    -1.89   0.058     .2512992    1.024693
 liver_trans |   2.226117   2.107592     0.85   0.398     .3480701    14.23735
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/adj_model_died_covid_any.ster not found)
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.03650         0.19        1         0.6602
      age_tv      |     -0.22717         7.10        1         0.0077
      male        |      0.02190         0.06        1         0.8096
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.04544         0.25        1         0.6184
      2.eth_bin   |      0.10861         1.13        1         0.2872
      1b.imd      |            .            .        1             .
      2.imd       |     -0.09073         0.92        1         0.3368
      3.imd       |     -0.08972         0.96        1         0.3272
      4.imd       |      0.03296         0.13        1         0.7189
      5.imd       |     -0.08989         0.80        1         0.3724
      6.imd       |     -0.01621         0.03        1         0.8658
      1.bmi_cat   |      0.03246         0.12        1         0.7247
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.17776         3.89        1         0.0485
      4.bmi_cat   |     -0.08980         0.98        1         0.3220
      5.bmi_cat   |      0.22558         4.44        1         0.0350
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.01312         0.02        1         0.8839
      2.smoking   |     -0.13560         2.55        1         0.1101
      severe_dis~e|      0.07018         0.67        1         0.4130
      covid_vacc~t|      0.07430         0.54        1         0.4609
      liver_trans |      0.11659         1.17        1         0.2799
      ------------+---------------------------------------------------
      global test |                     25.81       19         0.1357
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -402.50317
Iteration 2:   log pseudolikelihood = -402.18398
Iteration 3:   log pseudolikelihood = -402.18216
Iteration 4:   log pseudolikelihood = -402.18216
Refining estimates:
Iteration 0:   log pseudolikelihood = -402.18216

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(22)    =       20.22
Log pseudolikelihood =   -402.18216             Prob > chi2      =      0.5693

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.111618   .4779027     0.25   0.806     .4786417    2.581672
      age_tv |   1.000041   .0047095     0.01   0.993     .9908531    1.009314
        male |    1.34283   .2987337     1.33   0.185     .8682765     2.07675
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.277969   .4675204     0.67   0.503     .6239141    2.617677
      Asian  |   1.037712   .4085391     0.09   0.925     .4796951    2.244855
      Black  |   .7257296   .2893493    -0.80   0.421     .3322001     1.58544
      Other  |   1.336854   .5086889     0.76   0.445     .6341498    2.818229
    Unknown  |    1.74001   .8605136     1.12   0.263     .6600761    4.586795
             |
         imd |
          2  |   1.293633   .4636368     0.72   0.473      .640828    2.611445
          3  |   1.213166    .457728     0.51   0.609     .5791107    2.541434
          4  |   .7804023   .3038869    -0.64   0.524        .3638    1.674073
          5  |   .9294887   .3496732    -0.19   0.846     .4446543    1.942969
          6  |   2.028777   1.056474     1.36   0.174     .7310987    5.629794
             |
     bmi_cat |
Underweight  |    .646646   .3130374    -0.90   0.368     .2503831    1.670045
 Overweight  |   1.397154    .418222     1.12   0.264     .7770462    2.512127
      Obese  |   1.114527   .3262864     0.37   0.711     .6279061    1.978274
Morbidly ..  |   1.063288   .4550817     0.14   0.886     .4595589    2.460145
             |
     smoking |
Current s..  |   1.152576   .3557752     0.46   0.645     .6293934    2.110654
  Ex-smoker  |   .6232706    .305813    -0.96   0.335      .238247    1.630519
             |
severe_dis~e |   1.069872   .2491968     0.29   0.772     .6777478    1.688867
covid_vacc~t |   .5091391   .1805432    -1.90   0.057     .2540951     1.02018
 liver_trans |   1.817112   1.533161     0.71   0.479     .3476907    9.496649
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,927       65.84       65.84
          1 |      1,000       34.16      100.00
------------+-----------------------------------
      Total |      2,927      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  153
no udca events = 153
(1927 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      587642           0     587642     587642
19588.067
781.08781

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 15

Checking missings in all variables:
1452 observations with missing values

  +------------------+
  |        # missing |
  |------------------|
  |  stp        1440 |
  | male          22 |
  +------------------+

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,866                          
 vars:            23                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
         44  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  44

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_hosp_any.svg not found)
(file ./output/graphs/km_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -99.827775
Iteration 1:   log pseudolikelihood = -99.353009
Iteration 2:   log pseudolikelihood =  -99.26236
Iteration 3:   log pseudolikelihood = -99.261794
Iteration 4:   log pseudolikelihood = -99.261794
Refining estimates:
Iteration 0:   log pseudolikelihood = -99.261794

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,426
No. of failures      =           44
Time at risk         =       632950
                                                Wald chi2(1)     =        1.47
Log pseudolikelihood =   -99.261794             Prob > chi2      =      0.2255

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    2.06439   1.234471     1.21   0.225     .6394218    6.664939
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/crude_hosp_any.ster not found)
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_hosp_any.dta not found)
file ./output/tempdata/surv_crude_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.14865         0.41        1         0.5224
      ------------+---------------------------------------------------
      global test |                      0.41        1         0.5224
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -99.073863
Iteration 2:   log pseudolikelihood = -98.990197
Iteration 3:   log pseudolikelihood = -98.989708
Iteration 4:   log pseudolikelihood = -98.989708
Refining estimates:
Iteration 0:   log pseudolikelihood = -98.989708

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(3)     =        1.57
Log pseudolikelihood =   -98.989708             Prob > chi2      =      0.6671

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.996213   1.184566     1.16   0.244      .623876    6.387275
      age_tv |   .9978458    .008679    -0.25   0.804     .9809794    1.015002
        male |   .9198596   .3947443    -0.19   0.846     .3966805    2.133056
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/p_adj_model_hosp_any.ster not found)
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.19925         0.87        1         0.3503
      age_tv      |      0.12349         0.25        1         0.6198
      male        |     -0.24867         1.43        1         0.2320
      ------------+---------------------------------------------------
      global test |                      2.25        3         0.5227
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -92.990257
Iteration 2:   log pseudolikelihood = -89.452583
Iteration 3:   log pseudolikelihood = -89.169481
Iteration 4:   log pseudolikelihood =  -89.08867
Iteration 5:   log pseudolikelihood = -89.059229
Iteration 6:   log pseudolikelihood = -89.048425
Iteration 7:   log pseudolikelihood = -89.044454
Iteration 8:   log pseudolikelihood = -89.042994
Iteration 9:   log pseudolikelihood = -89.042456
Iteration 10:  log pseudolikelihood = -89.042259
Iteration 11:  log pseudolikelihood = -89.042186
Iteration 12:  log pseudolikelihood = -89.042159
Iteration 13:  log pseudolikelihood =  -89.04215
Iteration 14:  log pseudolikelihood = -89.042146
Iteration 15:  log pseudolikelihood = -89.042145
Iteration 16:  log pseudolikelihood = -89.042144
Iteration 17:  log pseudolikelihood = -89.042144
Iteration 18:  log pseudolikelihood = -89.042144
Iteration 19:  log pseudolikelihood = -89.042144
Iteration 20:  log pseudolikelihood = -89.042144
Iteration 21:  log pseudolikelihood = -89.042144
Iteration 22:  log pseudolikelihood = -89.042144
Iteration 23:  log pseudolikelihood = -89.042144
Iteration 24:  log pseudolikelihood = -89.042144
Iteration 25:  log pseudolikelihood = -89.042144
Iteration 26:  log pseudolikelihood = -89.042144
Iteration 27:  log pseudolikelihood = -89.042144
Iteration 28:  log pseudolikelihood = -89.042144
Iteration 29:  log pseudolikelihood = -89.042144
Iteration 30:  log pseudolikelihood = -89.042144
Iteration 31:  log pseudolikelihood = -89.042144
Iteration 32:  log pseudolikelihood = -89.042144
Iteration 33:  log pseudolikelihood = -89.042144
Refining estimates:
Iteration 0:   log pseudolikelihood = -89.042144
Iteration 1:   log pseudolikelihood = -89.042144
Iteration 2:   log pseudolikelihood = -89.042144

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(19)    =    11236.56
Log pseudolikelihood =   -89.042144             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.446321   .8739786     0.61   0.541     .4424896    4.727443
      age_tv |   .9924327   .0095843    -0.79   0.432     .9738245    1.011396
        male |   .9594088   .4801741    -0.08   0.934     .3597379    2.558711
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .5546275   .3187268    -1.03   0.305      .179822    1.710645
    Unknown  |   3.53e-16   2.83e-16   -44.36   0.000     7.34e-17    1.70e-15
             |
         imd |
          2  |   3.982731    3.03394     1.81   0.070     .8948658    17.72572
          3  |   1.802284   1.667495     0.64   0.524     .2939552    11.05007
          4  |   .5811847    .672927    -0.47   0.639     .0600824    5.621876
          5  |   5.783452   4.637027     2.19   0.029     1.201476    27.83936
          6  |   1.66e-15   1.32e-15   -42.81   0.000     3.49e-16    7.88e-15
             |
     bmi_cat |
Underweight  |   .6366883   .7245653    -0.40   0.692     .0684291    5.923971
 Overweight  |   1.921125   1.004495     1.25   0.212     .6894288    5.353302
      Obese  |   .8199968   .5599119    -0.29   0.771     .2150765    3.126305
Morbidly ..  |   .7407404   .5512253    -0.40   0.687     .1722823    3.184868
             |
     smoking |
Current s..  |   .7600568   .4730419    -0.44   0.659     .2244284    2.574034
  Ex-smoker  |   .5114322    .498571    -0.69   0.492     .0756819    3.456082
             |
severe_dis~e |   .7083489   .3018047    -0.81   0.418     .3073106    1.632739
covid_vacc~t |   .6108878   .4274101    -0.70   0.481     .1550297    2.407177
 liver_trans |   8.951747   12.34243     1.59   0.112     .6001972    133.5124
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/adj_model_hosp_any.ster not found)
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_hosp_any.dta not found)
file ./output/tempdata/surv_adj_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.37076         5.39        1         0.0202
      age_tv      |     -0.01707         0.02        1         0.8926
      male        |     -0.27569         8.70        1         0.0032
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.14552         1.44        1         0.2308
      2.eth_bin   |      0.24690         3.91        1         0.0481
      1b.imd      |            .            .        1             .
      2.imd       |      0.11960         0.56        1         0.4539
      3.imd       |     -0.08639         0.69        1         0.4073
      4.imd       |      0.02118         0.03        1         0.8623
      5.imd       |     -0.08862         0.42        1         0.5193
      6.imd       |      0.06086         0.14        1         0.7057
      1.bmi_cat   |     -0.34725         8.05        1         0.0046
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.43655        11.19        1         0.0008
      4.bmi_cat   |     -0.04624         0.15        1         0.7001
      5.bmi_cat   |     -0.00280         0.00        1         0.9906
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.12543         0.88        1         0.3488
      2.smoking   |      0.09978         0.69        1         0.4074
      severe_dis~e|      0.28879         6.14        1         0.0132
      covid_vacc~t|     -0.08408         0.50        1         0.4774
      liver_trans |     -0.13151         1.23        1         0.2667
      ------------+---------------------------------------------------
      global test |                     23.56       19         0.2137
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_hosp_any.svg not found)
(file ./output/graphs/schoenplot_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -91.662102
Iteration 2:   log pseudolikelihood = -87.230417
Iteration 3:   log pseudolikelihood = -86.936106
Iteration 4:   log pseudolikelihood = -86.858762
Iteration 5:   log pseudolikelihood = -86.830606
Iteration 6:   log pseudolikelihood = -86.820272
Iteration 7:   log pseudolikelihood = -86.816474
Iteration 8:   log pseudolikelihood = -86.815078
Iteration 9:   log pseudolikelihood = -86.814564
Iteration 10:  log pseudolikelihood = -86.814375
Iteration 11:  log pseudolikelihood = -86.814305
Iteration 12:  log pseudolikelihood =  -86.81428
Iteration 13:  log pseudolikelihood =  -86.81427
Iteration 14:  log pseudolikelihood = -86.814267
Iteration 15:  log pseudolikelihood = -86.814266
Iteration 16:  log pseudolikelihood = -86.814265
Iteration 17:  log pseudolikelihood = -86.814265
Iteration 18:  log pseudolikelihood = -86.814265
Iteration 19:  log pseudolikelihood = -86.814265
Iteration 20:  log pseudolikelihood = -86.814265
Iteration 21:  log pseudolikelihood = -86.814265
Iteration 22:  log pseudolikelihood = -86.814265
Iteration 23:  log pseudolikelihood = -86.814265
Iteration 24:  log pseudolikelihood = -86.814265
Iteration 25:  log pseudolikelihood = -86.814265
Iteration 26:  log pseudolikelihood = -86.814265
Iteration 27:  log pseudolikelihood = -86.814265
Iteration 28:  log pseudolikelihood = -86.814265
Iteration 29:  log pseudolikelihood = -86.814265
Iteration 30:  log pseudolikelihood = -86.814265
Iteration 31:  log pseudolikelihood = -86.814265
Iteration 32:  log pseudolikelihood = -86.814265
Iteration 33:  log pseudolikelihood = -86.814265
Iteration 34:  log pseudolikelihood = -86.814265
Iteration 35:  log pseudolikelihood = -86.814265
Refining estimates:
Iteration 0:   log pseudolikelihood = -86.814265
Iteration 1:   log pseudolikelihood = -86.814265
Iteration 2:   log pseudolikelihood = -86.814265

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(22)    =    11985.09
Log pseudolikelihood =   -86.814265             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.137915   1.282689     1.27   0.205      .659619    6.929271
      age_tv |   .9921833   .0095265    -0.82   0.414     .9736862    1.011032
        male |   1.176194   .5639723     0.34   0.735     .4595544    3.010377
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .7774169     .54609    -0.36   0.720     .1962161    3.080161
      Asian  |   .8015876   .5922163    -0.30   0.765     .1883995    3.410533
      Black  |    .174503   .1492701    -2.04   0.041      .032635    .9330863
      Other  |   .7085181   .5174806    -0.47   0.637     .1693006    2.965127
    Unknown  |   4.62e-17   3.67e-17   -47.37   0.000     9.74e-18    2.19e-16
             |
         imd |
          2  |   4.664033   3.574615     2.01   0.045     1.038443    20.94791
          3  |   2.214724   2.145688     0.82   0.412     .3316281    14.79067
          4  |   .6057652   .7080928    -0.43   0.668     .0612795    5.988158
          5  |   5.924274   4.747511     2.22   0.026     1.231718    28.49437
          6  |   2.47e-16   2.01e-16   -44.17   0.000     5.02e-17    1.22e-15
             |
     bmi_cat |
Underweight  |   .5428729   .6208131    -0.53   0.593     .0577151    5.106304
 Overweight  |   2.026482   1.092217     1.31   0.190     .7046426    5.827962
      Obese  |    .981749   .6693317    -0.03   0.978     .2580315    3.735323
Morbidly ..  |   .8212683   .6450194    -0.25   0.802     .1761799     3.82837
             |
     smoking |
Current s..  |   .7118658    .469194    -0.52   0.606     .1955993    2.590771
  Ex-smoker  |   .4312128   .4088677    -0.89   0.375     .0672355     2.76557
             |
severe_dis~e |   .7563753   .3206154    -0.66   0.510      .329554    1.735994
covid_vacc~t |   .5270285   .3640783    -0.93   0.354     .1360858    2.041058
 liver_trans |    6.27172   7.510692     1.53   0.125      .599834    65.57559
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  40
no udca events = 40
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      570166           0     570166     570166
19005.533
210.46502

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = .

Checking missings in all variables:
1452 observations with missing values

  +------------------+
  |        # missing |
  |------------------|
  |  stp        1440 |
  | male          22 |
  +------------------+

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,866                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
        204  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  204

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_composite_any.svg not found)
(file ./output/graphs/km_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -496.25556
Iteration 1:   log pseudolikelihood = -496.22541
Iteration 2:   log pseudolikelihood = -496.22537
Refining estimates:
Iteration 0:   log pseudolikelihood = -496.22537

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,426
No. of failures      =          204
Time at risk         =       632950
                                                Wald chi2(1)     =        0.06
Log pseudolikelihood =   -496.22537             Prob > chi2      =      0.8049

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.090726   .3834635     0.25   0.805      .547597    2.172552
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/crude_composite_any.ster not found)
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_composite_any.dta not found)
file ./output/tempdata/surv_crude_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03695         0.15        1         0.7015
      ------------+---------------------------------------------------
      global test |                      0.15        1         0.7015
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -495.11751
Iteration 2:   log pseudolikelihood = -495.11749
Refining estimates:
Iteration 0:   log pseudolikelihood = -495.11749

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(3)     =        0.29
Log pseudolikelihood =   -495.11749             Prob > chi2      =      0.9625

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.078153   .3806123     0.21   0.831     .5397435    2.153643
      age_tv |   .9998217   .0042075    -0.04   0.966     .9916091    1.008102
        male |    1.09492   .2123307     0.47   0.640     .7487114    1.601218
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/p_adj_model_composite_any.ster not found)
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.05209         0.30        1         0.5819
      age_tv      |     -0.17523         3.78        1         0.0517
      male        |     -0.03378         0.12        1         0.7327
      ------------+---------------------------------------------------
      global test |                      3.96        3         0.2661
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -486.77106
Iteration 2:   log pseudolikelihood = -486.54791
Iteration 3:   log pseudolikelihood = -486.54704
Iteration 4:   log pseudolikelihood = -486.54704
Refining estimates:
Iteration 0:   log pseudolikelihood = -486.54704

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(19)    =       15.87
Log pseudolikelihood =   -486.54704             Prob > chi2      =      0.6661

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.034144   .3908878     0.09   0.929     .4929949    2.169301
      age_tv |   .9998862   .0043364    -0.03   0.979     .9914231    1.008422
        male |   1.177819   .2349566     0.82   0.412     .7966678    1.741326
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .9632611   .2687004    -0.13   0.893     .5575739    1.664124
    Unknown  |   1.117294   .5478944     0.23   0.821     .4273252    2.921302
             |
         imd |
          2  |   1.490729   .4647529     1.28   0.200     .8091446    2.746446
          3  |   1.188749   .4061731     0.51   0.613     .6084862    2.322361
          4  |   .7350592   .2638286    -0.86   0.391      .363754    1.485378
          5  |   1.316127   .4452076     0.81   0.417     .6782048     2.55408
          6  |    1.67937   .8202985     1.06   0.289     .6447214    4.374425
             |
     bmi_cat |
Underweight  |   .6631003    .296176    -0.92   0.358     .2763041     1.59137
 Overweight  |    1.43559   .3851481     1.35   0.178      .848526    2.428821
      Obese  |   1.064919   .2772381     0.24   0.809     .6393186    1.773847
Morbidly ..  |   .9665432   .3670186    -0.09   0.929     .4591985    2.034427
             |
     smoking |
Current s..  |   .9747373   .2690597    -0.09   0.926     .5674504    1.674354
  Ex-smoker  |   .5769517   .2527028    -1.26   0.209      .244521    1.361328
             |
severe_dis~e |    .930021   .1895802    -0.36   0.722     .6237054    1.386775
covid_vacc~t |   .4700089   .1583883    -2.24   0.025     .2428061    .9098138
 liver_trans |   1.807762   2.173686     0.49   0.622     .1712541    19.08277
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/adj_model_composite_any.ster not found)
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_composite_any.dta not found)
file ./output/tempdata/surv_adj_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.05956         0.59        1         0.4408
      age_tv      |     -0.16588         4.20        1         0.0405
      male        |     -0.08437         0.97        1         0.3259
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.07937         1.01        1         0.3144
      2.eth_bin   |      0.12781         2.04        1         0.1527
      1b.imd      |            .            .        1             .
      2.imd       |     -0.08536         0.93        1         0.3342
      3.imd       |     -0.11596         2.09        1         0.1486
      4.imd       |      0.04787         0.31        1         0.5774
      5.imd       |     -0.07243         0.67        1         0.4118
      6.imd       |     -0.02190         0.06        1         0.8095
      1.bmi_cat   |     -0.04876         0.33        1         0.5677
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.24299         8.06        1         0.0045
      4.bmi_cat   |     -0.12764         2.32        1         0.1276
      5.bmi_cat   |      0.19017         3.28        1         0.0700
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.05113         0.37        1         0.5454
      2.smoking   |     -0.12614         2.74        1         0.0981
      severe_dis~e|      0.13178         2.14        1         0.1436
      covid_vacc~t|      0.02198         0.06        1         0.8091
      liver_trans |      0.01692         0.05        1         0.8220
      ------------+---------------------------------------------------
      global test |                     28.91       19         0.0674
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_composite_any.svg not found)
(file ./output/graphs/schoenplot_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -483.73333
Iteration 2:   log pseudolikelihood = -483.42072
Iteration 3:   log pseudolikelihood = -483.41985
Iteration 4:   log pseudolikelihood = -483.41985
Refining estimates:
Iteration 0:   log pseudolikelihood = -483.41985

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(22)    =       22.19
Log pseudolikelihood =   -483.41985             Prob > chi2      =      0.4484

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.236906   .4766312     0.55   0.581     .5812107    2.632328
      age_tv |   .9987114   .0043375    -0.30   0.767     .9902461    1.007249
        male |   1.241945    .250847     1.07   0.283     .8359442    1.845131
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.219601   .3933284     0.62   0.538     .6481874    2.294749
      Asian  |   1.051284   .3713858     0.14   0.887      .526038    2.100985
      Black  |    .586205   .2141067    -1.46   0.144     .2865201    1.199345
      Other  |   1.117877   .3999453     0.31   0.755     .5544438    2.253877
    Unknown  |   1.096328   .5320779     0.19   0.850     .4234765    2.838258
             |
         imd |
          2  |   1.630661    .525524     1.52   0.129     .8670445    3.066804
          3  |   1.341662   .4743305     0.83   0.406     .6709803    2.682727
          4  |   .7608864   .2763932    -0.75   0.452     .3733529    1.550673
          5  |   1.349076   .4516244     0.89   0.371     .6999764    2.600097
          6  |   1.706556   .8615227     1.06   0.290     .6344647    4.590222
             |
     bmi_cat |
Underweight  |   .6404039     .29613    -0.96   0.335     .2587311    1.585109
 Overweight  |   1.494832   .4035401     1.49   0.136     .8806529    2.537348
      Obese  |   1.135296    .304336     0.47   0.636       .67132    1.919944
Morbidly ..  |   1.015823   .3884109     0.04   0.967     .4801222    2.149236
             |
     smoking |
Current s..  |   .9939412   .2731101    -0.02   0.982     .5800587    1.703137
  Ex-smoker  |   .5778138   .2513244    -1.26   0.207     .2463494    1.355266
             |
severe_dis~e |   .9658511   .1984981    -0.17   0.866     .6456162    1.444927
covid_vacc~t |   .4628309    .153741    -2.32   0.020     .2413649    .8875044
 liver_trans |   1.626462   1.781645     0.44   0.657     .1900325    13.92066
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  186
no udca events = 186
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      570166           0     570166     570166
19005.533
978.66235

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 18

. 
. * sensitivity analysis - 90 day exposure 
. file write tablecontent _n ("90 day exposure sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_90_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_90_`outcome'.svg, as(svg) replace
 10.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model4
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_90_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_90_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model5
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_90_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model6
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_90_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_90_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_90_`outcome' adj_plot_90_`outcome'
 28.         graph export ./output/graphs/schoenplot_90_`outcome'.svg, as(svg) 
> replace 
 29.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1
 34.         safecount if unexposed_ever==0 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1
 55.         qui safecount if exposed_ever==1 & number==1
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. }

Contains data from ./output/an_dataset_90_died_covid_any.dta
  obs:         2,927                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,927  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,927  observations remaining, representing
      1,000  subjects
        168  failures in single-failure-per-subject data
    652,287  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  168

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_90_died_covid_any.svg not found)
(file ./output/graphs/km_90_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -411.91547
Iteration 1:   log pseudolikelihood = -411.91449
Iteration 2:   log pseudolikelihood = -411.91449
Refining estimates:
Iteration 0:   log pseudolikelihood = -411.91449

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,454
No. of failures      =          168
Time at risk         =       652287
                                                Wald chi2(1)     =        0.00
Log pseudolikelihood =   -411.91449             Prob > chi2      =      0.9648

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9827369   .3878719    -0.04   0.965     .4533989    2.130071
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_90_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_90_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.04003         0.14        1         0.7064
      ------------+---------------------------------------------------
      global test |                      0.14        1         0.7064
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -410.85503
Iteration 2:   log pseudolikelihood = -410.85503
Refining estimates:
Iteration 0:   log pseudolikelihood = -410.85503

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(3)     =        0.61
Log pseudolikelihood =   -410.85503             Prob > chi2      =      0.8951

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9732719   .3842749    -0.07   0.945     .4489067    2.110145
      age_tv |   1.000493   .0046262     0.11   0.915     .9914673    1.009602
        male |   1.179671   .2518546     0.77   0.439     .7763067    1.792622
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_90_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_90_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.05587         0.28        1         0.5971
      age_tv      |     -0.23208         5.68        1         0.0172
      male        |      0.01986         0.03        1         0.8549
      ------------+---------------------------------------------------
      global test |                      5.94        3         0.1147
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -404.26959
Iteration 2:   log pseudolikelihood = -403.98411
Iteration 3:   log pseudolikelihood = -403.98232
Iteration 4:   log pseudolikelihood = -403.98232
Refining estimates:
Iteration 0:   log pseudolikelihood = -403.98232

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(19)    =       15.90
Log pseudolikelihood =   -403.98232             Prob > chi2      =      0.6643

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9683593   .4019515    -0.08   0.938     .4292551    2.184528
      age_tv |   1.000846   .0047264     0.18   0.858     .9916256    1.010153
        male |   1.293802   .2794157     1.19   0.233     .8473024    1.975593
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.071915   .3323795     0.22   0.823     .5837405    1.968344
    Unknown  |   1.788013   .8906233     1.17   0.243     .6735663    4.746362
             |
         imd |
          2  |   1.178111   .3974714     0.49   0.627     .6081452    2.282258
          3  |   1.077853   .3916301     0.21   0.837     .5287884    2.197038
          4  |   .7453349   .2844944    -0.77   0.441     .3527343    1.574908
          5  |   .9128101   .3440421    -0.24   0.809     .4360727    1.910742
          6  |   2.019923   1.021382     1.39   0.164     .7497584    5.441873
             |
     bmi_cat |
Underweight  |   .6458651   .3034937    -0.93   0.352     .2571343    1.622272
 Overweight  |   1.335408   .3923846     0.98   0.325     .7507654    2.375328
      Obese  |   1.039927   .2911164     0.14   0.889     .6007838    1.800062
Morbidly ..  |   .9998716   .4273108    -0.00   1.000     .4326831    2.310567
             |
     smoking |
Current s..  |   1.153337   .3589253     0.46   0.647     .6266967    2.122537
  Ex-smoker  |   .6188986   .3044902    -0.98   0.329     .2359605    1.623304
             |
severe_dis~e |    1.03248   .2381679     0.14   0.890     .6569471    1.622681
covid_vacc~t |    .507449   .1819476    -1.89   0.058     .2512992    1.024693
 liver_trans |   2.226117   2.107592     0.85   0.398     .3480701    14.23735
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_90_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_90_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.03650         0.19        1         0.6602
      age_tv      |     -0.22717         7.10        1         0.0077
      male        |      0.02190         0.06        1         0.8096
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.04544         0.25        1         0.6184
      2.eth_bin   |      0.10861         1.13        1         0.2872
      1b.imd      |            .            .        1             .
      2.imd       |     -0.09073         0.92        1         0.3368
      3.imd       |     -0.08972         0.96        1         0.3272
      4.imd       |      0.03296         0.13        1         0.7189
      5.imd       |     -0.08989         0.80        1         0.3724
      6.imd       |     -0.01621         0.03        1         0.8658
      1.bmi_cat   |      0.03246         0.12        1         0.7247
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.17776         3.89        1         0.0485
      4.bmi_cat   |     -0.08980         0.98        1         0.3220
      5.bmi_cat   |      0.22558         4.44        1         0.0350
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.01312         0.02        1         0.8839
      2.smoking   |     -0.13560         2.55        1         0.1101
      severe_dis~e|      0.07018         0.67        1         0.4130
      covid_vacc~t|      0.07430         0.54        1         0.4609
      liver_trans |      0.11659         1.17        1         0.2799
      ------------+---------------------------------------------------
      global test |                     25.81       19         0.1357
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_90_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_90_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -402.50317
Iteration 2:   log pseudolikelihood = -402.18398
Iteration 3:   log pseudolikelihood = -402.18216
Iteration 4:   log pseudolikelihood = -402.18216
Refining estimates:
Iteration 0:   log pseudolikelihood = -402.18216

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(22)    =       20.22
Log pseudolikelihood =   -402.18216             Prob > chi2      =      0.5693

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.111618   .4779027     0.25   0.806     .4786417    2.581672
      age_tv |   1.000041   .0047095     0.01   0.993     .9908531    1.009314
        male |    1.34283   .2987337     1.33   0.185     .8682765     2.07675
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.277969   .4675204     0.67   0.503     .6239141    2.617677
      Asian  |   1.037712   .4085391     0.09   0.925     .4796951    2.244855
      Black  |   .7257296   .2893493    -0.80   0.421     .3322001     1.58544
      Other  |   1.336854   .5086889     0.76   0.445     .6341498    2.818229
    Unknown  |    1.74001   .8605136     1.12   0.263     .6600761    4.586795
             |
         imd |
          2  |   1.293633   .4636368     0.72   0.473      .640828    2.611445
          3  |   1.213166    .457728     0.51   0.609     .5791107    2.541434
          4  |   .7804023   .3038869    -0.64   0.524        .3638    1.674073
          5  |   .9294887   .3496732    -0.19   0.846     .4446543    1.942969
          6  |   2.028777   1.056474     1.36   0.174     .7310987    5.629794
             |
     bmi_cat |
Underweight  |    .646646   .3130374    -0.90   0.368     .2503831    1.670045
 Overweight  |   1.397154    .418222     1.12   0.264     .7770462    2.512127
      Obese  |   1.114527   .3262864     0.37   0.711     .6279061    1.978274
Morbidly ..  |   1.063288   .4550817     0.14   0.886     .4595589    2.460145
             |
     smoking |
Current s..  |   1.152576   .3557752     0.46   0.645     .6293934    2.110654
  Ex-smoker  |   .6232706    .305813    -0.96   0.335      .238247    1.630519
             |
severe_dis~e |   1.069872   .2491968     0.29   0.772     .6777478    1.688867
covid_vacc~t |   .5091391   .1805432    -1.90   0.057     .2540951     1.02018
 liver_trans |   1.817112   1.533161     0.71   0.479     .3476907    9.496649
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,927       65.84       65.84
          1 |      1,000       34.16      100.00
------------+-----------------------------------
      Total |      2,927      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  153
no udca events = 153
(1927 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      587642           0     587642     587642
19588.067
781.08781

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 15

Contains data from ./output/an_dataset_90_hosp_any.dta
  obs:         2,866                          
 vars:            23                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
         44  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  44

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_90_hosp_any.svg not found)
(file ./output/graphs/km_90_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -99.827775
Iteration 1:   log pseudolikelihood = -99.353009
Iteration 2:   log pseudolikelihood =  -99.26236
Iteration 3:   log pseudolikelihood = -99.261794
Iteration 4:   log pseudolikelihood = -99.261794
Refining estimates:
Iteration 0:   log pseudolikelihood = -99.261794

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,426
No. of failures      =           44
Time at risk         =       632950
                                                Wald chi2(1)     =        1.47
Log pseudolikelihood =   -99.261794             Prob > chi2      =      0.2255

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    2.06439   1.234471     1.21   0.225     .6394218    6.664939
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_90_hosp_any.dta not found)
file ./output/tempdata/surv_crude_90_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.14865         0.41        1         0.5224
      ------------+---------------------------------------------------
      global test |                      0.41        1         0.5224
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -99.073863
Iteration 2:   log pseudolikelihood = -98.990197
Iteration 3:   log pseudolikelihood = -98.989708
Iteration 4:   log pseudolikelihood = -98.989708
Refining estimates:
Iteration 0:   log pseudolikelihood = -98.989708

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(3)     =        1.57
Log pseudolikelihood =   -98.989708             Prob > chi2      =      0.6671

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.996213   1.184566     1.16   0.244      .623876    6.387275
      age_tv |   .9978458    .008679    -0.25   0.804     .9809794    1.015002
        male |   .9198596   .3947443    -0.19   0.846     .3966805    2.133056
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_90_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_90_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.19925         0.87        1         0.3503
      age_tv      |      0.12349         0.25        1         0.6198
      male        |     -0.24867         1.43        1         0.2320
      ------------+---------------------------------------------------
      global test |                      2.25        3         0.5227
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -92.990257
Iteration 2:   log pseudolikelihood = -89.452583
Iteration 3:   log pseudolikelihood = -89.169481
Iteration 4:   log pseudolikelihood =  -89.08867
Iteration 5:   log pseudolikelihood = -89.059229
Iteration 6:   log pseudolikelihood = -89.048425
Iteration 7:   log pseudolikelihood = -89.044454
Iteration 8:   log pseudolikelihood = -89.042994
Iteration 9:   log pseudolikelihood = -89.042456
Iteration 10:  log pseudolikelihood = -89.042259
Iteration 11:  log pseudolikelihood = -89.042186
Iteration 12:  log pseudolikelihood = -89.042159
Iteration 13:  log pseudolikelihood =  -89.04215
Iteration 14:  log pseudolikelihood = -89.042146
Iteration 15:  log pseudolikelihood = -89.042145
Iteration 16:  log pseudolikelihood = -89.042144
Iteration 17:  log pseudolikelihood = -89.042144
Iteration 18:  log pseudolikelihood = -89.042144
Iteration 19:  log pseudolikelihood = -89.042144
Iteration 20:  log pseudolikelihood = -89.042144
Iteration 21:  log pseudolikelihood = -89.042144
Iteration 22:  log pseudolikelihood = -89.042144
Iteration 23:  log pseudolikelihood = -89.042144
Iteration 24:  log pseudolikelihood = -89.042144
Iteration 25:  log pseudolikelihood = -89.042144
Iteration 26:  log pseudolikelihood = -89.042144
Iteration 27:  log pseudolikelihood = -89.042144
Iteration 28:  log pseudolikelihood = -89.042144
Iteration 29:  log pseudolikelihood = -89.042144
Iteration 30:  log pseudolikelihood = -89.042144
Iteration 31:  log pseudolikelihood = -89.042144
Iteration 32:  log pseudolikelihood = -89.042144
Iteration 33:  log pseudolikelihood = -89.042144
Refining estimates:
Iteration 0:   log pseudolikelihood = -89.042144
Iteration 1:   log pseudolikelihood = -89.042144
Iteration 2:   log pseudolikelihood = -89.042144

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(19)    =    11236.56
Log pseudolikelihood =   -89.042144             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.446321   .8739786     0.61   0.541     .4424896    4.727443
      age_tv |   .9924327   .0095843    -0.79   0.432     .9738245    1.011396
        male |   .9594088   .4801741    -0.08   0.934     .3597379    2.558711
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .5546275   .3187268    -1.03   0.305      .179822    1.710645
    Unknown  |   3.53e-16   2.83e-16   -44.36   0.000     7.34e-17    1.70e-15
             |
         imd |
          2  |   3.982731    3.03394     1.81   0.070     .8948658    17.72572
          3  |   1.802284   1.667495     0.64   0.524     .2939552    11.05007
          4  |   .5811847    .672927    -0.47   0.639     .0600824    5.621876
          5  |   5.783452   4.637027     2.19   0.029     1.201476    27.83936
          6  |   1.66e-15   1.32e-15   -42.81   0.000     3.49e-16    7.88e-15
             |
     bmi_cat |
Underweight  |   .6366883   .7245653    -0.40   0.692     .0684291    5.923971
 Overweight  |   1.921125   1.004495     1.25   0.212     .6894288    5.353302
      Obese  |   .8199968   .5599119    -0.29   0.771     .2150765    3.126305
Morbidly ..  |   .7407404   .5512253    -0.40   0.687     .1722823    3.184868
             |
     smoking |
Current s..  |   .7600568   .4730419    -0.44   0.659     .2244284    2.574034
  Ex-smoker  |   .5114322    .498571    -0.69   0.492     .0756819    3.456082
             |
severe_dis~e |   .7083489   .3018047    -0.81   0.418     .3073106    1.632739
covid_vacc~t |   .6108878   .4274101    -0.70   0.481     .1550297    2.407177
 liver_trans |   8.951747   12.34243     1.59   0.112     .6001972    133.5124
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_90_hosp_any.dta not found)
file ./output/tempdata/surv_adj_90_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.37076         5.39        1         0.0202
      age_tv      |     -0.01707         0.02        1         0.8926
      male        |     -0.27569         8.70        1         0.0032
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.14552         1.44        1         0.2308
      2.eth_bin   |      0.24690         3.91        1         0.0481
      1b.imd      |            .            .        1             .
      2.imd       |      0.11960         0.56        1         0.4539
      3.imd       |     -0.08639         0.69        1         0.4073
      4.imd       |      0.02118         0.03        1         0.8623
      5.imd       |     -0.08862         0.42        1         0.5193
      6.imd       |      0.06086         0.14        1         0.7057
      1.bmi_cat   |     -0.34725         8.05        1         0.0046
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.43655        11.19        1         0.0008
      4.bmi_cat   |     -0.04624         0.15        1         0.7001
      5.bmi_cat   |     -0.00280         0.00        1         0.9906
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.12543         0.88        1         0.3488
      2.smoking   |      0.09978         0.69        1         0.4074
      severe_dis~e|      0.28879         6.14        1         0.0132
      covid_vacc~t|     -0.08408         0.50        1         0.4774
      liver_trans |     -0.13151         1.23        1         0.2667
      ------------+---------------------------------------------------
      global test |                     23.56       19         0.2137
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_90_hosp_any.svg not found)
(file ./output/graphs/schoenplot_90_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -91.662102
Iteration 2:   log pseudolikelihood = -87.230417
Iteration 3:   log pseudolikelihood = -86.936106
Iteration 4:   log pseudolikelihood = -86.858762
Iteration 5:   log pseudolikelihood = -86.830606
Iteration 6:   log pseudolikelihood = -86.820272
Iteration 7:   log pseudolikelihood = -86.816474
Iteration 8:   log pseudolikelihood = -86.815078
Iteration 9:   log pseudolikelihood = -86.814564
Iteration 10:  log pseudolikelihood = -86.814375
Iteration 11:  log pseudolikelihood = -86.814305
Iteration 12:  log pseudolikelihood =  -86.81428
Iteration 13:  log pseudolikelihood =  -86.81427
Iteration 14:  log pseudolikelihood = -86.814267
Iteration 15:  log pseudolikelihood = -86.814266
Iteration 16:  log pseudolikelihood = -86.814265
Iteration 17:  log pseudolikelihood = -86.814265
Iteration 18:  log pseudolikelihood = -86.814265
Iteration 19:  log pseudolikelihood = -86.814265
Iteration 20:  log pseudolikelihood = -86.814265
Iteration 21:  log pseudolikelihood = -86.814265
Iteration 22:  log pseudolikelihood = -86.814265
Iteration 23:  log pseudolikelihood = -86.814265
Iteration 24:  log pseudolikelihood = -86.814265
Iteration 25:  log pseudolikelihood = -86.814265
Iteration 26:  log pseudolikelihood = -86.814265
Iteration 27:  log pseudolikelihood = -86.814265
Iteration 28:  log pseudolikelihood = -86.814265
Iteration 29:  log pseudolikelihood = -86.814265
Iteration 30:  log pseudolikelihood = -86.814265
Iteration 31:  log pseudolikelihood = -86.814265
Iteration 32:  log pseudolikelihood = -86.814265
Iteration 33:  log pseudolikelihood = -86.814265
Iteration 34:  log pseudolikelihood = -86.814265
Iteration 35:  log pseudolikelihood = -86.814265
Refining estimates:
Iteration 0:   log pseudolikelihood = -86.814265
Iteration 1:   log pseudolikelihood = -86.814265
Iteration 2:   log pseudolikelihood = -86.814265

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(22)    =    11985.09
Log pseudolikelihood =   -86.814265             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.137915   1.282689     1.27   0.205      .659619    6.929271
      age_tv |   .9921833   .0095265    -0.82   0.414     .9736862    1.011032
        male |   1.176194   .5639723     0.34   0.735     .4595544    3.010377
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .7774169     .54609    -0.36   0.720     .1962161    3.080161
      Asian  |   .8015876   .5922163    -0.30   0.765     .1883995    3.410533
      Black  |    .174503   .1492701    -2.04   0.041      .032635    .9330863
      Other  |   .7085181   .5174806    -0.47   0.637     .1693006    2.965127
    Unknown  |   4.62e-17   3.67e-17   -47.37   0.000     9.74e-18    2.19e-16
             |
         imd |
          2  |   4.664033   3.574615     2.01   0.045     1.038443    20.94791
          3  |   2.214724   2.145688     0.82   0.412     .3316281    14.79067
          4  |   .6057652   .7080928    -0.43   0.668     .0612795    5.988158
          5  |   5.924274   4.747511     2.22   0.026     1.231718    28.49437
          6  |   2.47e-16   2.01e-16   -44.17   0.000     5.02e-17    1.22e-15
             |
     bmi_cat |
Underweight  |   .5428729   .6208131    -0.53   0.593     .0577151    5.106304
 Overweight  |   2.026482   1.092217     1.31   0.190     .7046426    5.827962
      Obese  |    .981749   .6693317    -0.03   0.978     .2580315    3.735323
Morbidly ..  |   .8212683   .6450194    -0.25   0.802     .1761799     3.82837
             |
     smoking |
Current s..  |   .7118658    .469194    -0.52   0.606     .1955993    2.590771
  Ex-smoker  |   .4312128   .4088677    -0.89   0.375     .0672355     2.76557
             |
severe_dis~e |   .7563753   .3206154    -0.66   0.510      .329554    1.735994
covid_vacc~t |   .5270285   .3640783    -0.93   0.354     .1360858    2.041058
 liver_trans |    6.27172   7.510692     1.53   0.125      .599834    65.57559
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  40
no udca events = 40
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      570166           0     570166     570166
19005.533
210.46502

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = .

Contains data from ./output/an_dataset_90_composite_any.dta
  obs:         2,866                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
        204  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  204

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_90_composite_any.svg not found)
(file ./output/graphs/km_90_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -496.25556
Iteration 1:   log pseudolikelihood = -496.22541
Iteration 2:   log pseudolikelihood = -496.22537
Refining estimates:
Iteration 0:   log pseudolikelihood = -496.22537

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,426
No. of failures      =          204
Time at risk         =       632950
                                                Wald chi2(1)     =        0.06
Log pseudolikelihood =   -496.22537             Prob > chi2      =      0.8049

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.090726   .3834635     0.25   0.805      .547597    2.172552
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_90_composite_any.dta not found)
file ./output/tempdata/surv_crude_90_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03695         0.15        1         0.7015
      ------------+---------------------------------------------------
      global test |                      0.15        1         0.7015
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -495.11751
Iteration 2:   log pseudolikelihood = -495.11749
Refining estimates:
Iteration 0:   log pseudolikelihood = -495.11749

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(3)     =        0.29
Log pseudolikelihood =   -495.11749             Prob > chi2      =      0.9625

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.078153   .3806123     0.21   0.831     .5397435    2.153643
      age_tv |   .9998217   .0042075    -0.04   0.966     .9916091    1.008102
        male |    1.09492   .2123307     0.47   0.640     .7487114    1.601218
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_90_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_90_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.05209         0.30        1         0.5819
      age_tv      |     -0.17523         3.78        1         0.0517
      male        |     -0.03378         0.12        1         0.7327
      ------------+---------------------------------------------------
      global test |                      3.96        3         0.2661
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -486.77106
Iteration 2:   log pseudolikelihood = -486.54791
Iteration 3:   log pseudolikelihood = -486.54704
Iteration 4:   log pseudolikelihood = -486.54704
Refining estimates:
Iteration 0:   log pseudolikelihood = -486.54704

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(19)    =       15.87
Log pseudolikelihood =   -486.54704             Prob > chi2      =      0.6661

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.034144   .3908878     0.09   0.929     .4929949    2.169301
      age_tv |   .9998862   .0043364    -0.03   0.979     .9914231    1.008422
        male |   1.177819   .2349566     0.82   0.412     .7966678    1.741326
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .9632611   .2687004    -0.13   0.893     .5575739    1.664124
    Unknown  |   1.117294   .5478944     0.23   0.821     .4273252    2.921302
             |
         imd |
          2  |   1.490729   .4647529     1.28   0.200     .8091446    2.746446
          3  |   1.188749   .4061731     0.51   0.613     .6084862    2.322361
          4  |   .7350592   .2638286    -0.86   0.391      .363754    1.485378
          5  |   1.316127   .4452076     0.81   0.417     .6782048     2.55408
          6  |    1.67937   .8202985     1.06   0.289     .6447214    4.374425
             |
     bmi_cat |
Underweight  |   .6631003    .296176    -0.92   0.358     .2763041     1.59137
 Overweight  |    1.43559   .3851481     1.35   0.178      .848526    2.428821
      Obese  |   1.064919   .2772381     0.24   0.809     .6393186    1.773847
Morbidly ..  |   .9665432   .3670186    -0.09   0.929     .4591985    2.034427
             |
     smoking |
Current s..  |   .9747373   .2690597    -0.09   0.926     .5674504    1.674354
  Ex-smoker  |   .5769517   .2527028    -1.26   0.209      .244521    1.361328
             |
severe_dis~e |    .930021   .1895802    -0.36   0.722     .6237054    1.386775
covid_vacc~t |   .4700089   .1583883    -2.24   0.025     .2428061    .9098138
 liver_trans |   1.807762   2.173686     0.49   0.622     .1712541    19.08277
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_90_composite_any.dta not found)
file ./output/tempdata/surv_adj_90_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.05956         0.59        1         0.4408
      age_tv      |     -0.16588         4.20        1         0.0405
      male        |     -0.08437         0.97        1         0.3259
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.07937         1.01        1         0.3144
      2.eth_bin   |      0.12781         2.04        1         0.1527
      1b.imd      |            .            .        1             .
      2.imd       |     -0.08536         0.93        1         0.3342
      3.imd       |     -0.11596         2.09        1         0.1486
      4.imd       |      0.04787         0.31        1         0.5774
      5.imd       |     -0.07243         0.67        1         0.4118
      6.imd       |     -0.02190         0.06        1         0.8095
      1.bmi_cat   |     -0.04876         0.33        1         0.5677
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.24299         8.06        1         0.0045
      4.bmi_cat   |     -0.12764         2.32        1         0.1276
      5.bmi_cat   |      0.19017         3.28        1         0.0700
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.05113         0.37        1         0.5454
      2.smoking   |     -0.12614         2.74        1         0.0981
      severe_dis~e|      0.13178         2.14        1         0.1436
      covid_vacc~t|      0.02198         0.06        1         0.8091
      liver_trans |      0.01692         0.05        1         0.8220
      ------------+---------------------------------------------------
      global test |                     28.91       19         0.0674
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_90_composite_any.svg not found)
(file ./output/graphs/schoenplot_90_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -483.73333
Iteration 2:   log pseudolikelihood = -483.42072
Iteration 3:   log pseudolikelihood = -483.41985
Iteration 4:   log pseudolikelihood = -483.41985
Refining estimates:
Iteration 0:   log pseudolikelihood = -483.41985

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(22)    =       22.19
Log pseudolikelihood =   -483.41985             Prob > chi2      =      0.4484

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.236906   .4766312     0.55   0.581     .5812107    2.632328
      age_tv |   .9987114   .0043375    -0.30   0.767     .9902461    1.007249
        male |   1.241945    .250847     1.07   0.283     .8359442    1.845131
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.219601   .3933284     0.62   0.538     .6481874    2.294749
      Asian  |   1.051284   .3713858     0.14   0.887      .526038    2.100985
      Black  |    .586205   .2141067    -1.46   0.144     .2865201    1.199345
      Other  |   1.117877   .3999453     0.31   0.755     .5544438    2.253877
    Unknown  |   1.096328   .5320779     0.19   0.850     .4234765    2.838258
             |
         imd |
          2  |   1.630661    .525524     1.52   0.129     .8670445    3.066804
          3  |   1.341662   .4743305     0.83   0.406     .6709803    2.682727
          4  |   .7608864   .2763932    -0.75   0.452     .3733529    1.550673
          5  |   1.349076   .4516244     0.89   0.371     .6999764    2.600097
          6  |   1.706556   .8615227     1.06   0.290     .6344647    4.590222
             |
     bmi_cat |
Underweight  |   .6404039     .29613    -0.96   0.335     .2587311    1.585109
 Overweight  |   1.494832   .4035401     1.49   0.136     .8806529    2.537348
      Obese  |   1.135296    .304336     0.47   0.636       .67132    1.919944
Morbidly ..  |   1.015823   .3884109     0.04   0.967     .4801222    2.149236
             |
     smoking |
Current s..  |   .9939412   .2731101    -0.02   0.982     .5800587    1.703137
  Ex-smoker  |   .5778138   .2513244    -1.26   0.207     .2463494    1.355266
             |
severe_dis~e |   .9658511   .1984981    -0.17   0.866     .6456162    1.444927
covid_vacc~t |   .4628309    .153741    -2.32   0.020     .2413649    .8875044
 liver_trans |   1.626462   1.781645     0.44   0.657     .1900325    13.92066
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  186
no udca events = 186
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      570166           0     570166     570166
19005.533
978.66235

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 18

. 
. * sensitivity analysis - 120 day overlap exposure 
. file write tablecontent _n ("120 day overlap exposure sensitivity analysis") 
> _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_overlap_120_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_o_120_`outcome'.svg, as(svg) repla
> ce
 10.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model7
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_o_120_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_o_120_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model8
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_o_120_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model9
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_o_120_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_o_120_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_o_120_`outcome' adj_plot_o_120_`outcome'
 28.         graph export ./output/graphs/schoenplot_o_120_`outcome'.svg, as(sv
> g) replace 
 29.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1
 34.         safecount if unexposed_ever==0 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1
 55.         qui safecount if exposed_ever==1 & number==1
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. 
. }

Contains data from ./output/an_dataset_overlap_120_died_covid_any.dta
  obs:         2,927                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,927  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,927  observations remaining, representing
      1,000  subjects
        168  failures in single-failure-per-subject data
    652,287  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  168

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_o_120_died_covid_any.svg not found)
(file ./output/graphs/km_o_120_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -411.91547
Iteration 1:   log pseudolikelihood = -411.91449
Iteration 2:   log pseudolikelihood = -411.91449
Refining estimates:
Iteration 0:   log pseudolikelihood = -411.91449

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,454
No. of failures      =          168
Time at risk         =       652287
                                                Wald chi2(1)     =        0.00
Log pseudolikelihood =   -411.91449             Prob > chi2      =      0.9648

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9827369   .3878719    -0.04   0.965     .4533989    2.130071
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_o_120_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_o_120_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.04003         0.14        1         0.7064
      ------------+---------------------------------------------------
      global test |                      0.14        1         0.7064
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -410.85503
Iteration 2:   log pseudolikelihood = -410.85503
Refining estimates:
Iteration 0:   log pseudolikelihood = -410.85503

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(3)     =        0.61
Log pseudolikelihood =   -410.85503             Prob > chi2      =      0.8951

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9732719   .3842749    -0.07   0.945     .4489067    2.110145
      age_tv |   1.000493   .0046262     0.11   0.915     .9914673    1.009602
        male |   1.179671   .2518546     0.77   0.439     .7763067    1.792622
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_o_120_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_o_120_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.05587         0.28        1         0.5971
      age_tv      |     -0.23208         5.68        1         0.0172
      male        |      0.01986         0.03        1         0.8549
      ------------+---------------------------------------------------
      global test |                      5.94        3         0.1147
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -404.26959
Iteration 2:   log pseudolikelihood = -403.98411
Iteration 3:   log pseudolikelihood = -403.98232
Iteration 4:   log pseudolikelihood = -403.98232
Refining estimates:
Iteration 0:   log pseudolikelihood = -403.98232

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(19)    =       15.90
Log pseudolikelihood =   -403.98232             Prob > chi2      =      0.6643

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9683593   .4019515    -0.08   0.938     .4292551    2.184528
      age_tv |   1.000846   .0047264     0.18   0.858     .9916256    1.010153
        male |   1.293802   .2794157     1.19   0.233     .8473024    1.975593
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.071915   .3323795     0.22   0.823     .5837405    1.968344
    Unknown  |   1.788013   .8906233     1.17   0.243     .6735663    4.746362
             |
         imd |
          2  |   1.178111   .3974714     0.49   0.627     .6081452    2.282258
          3  |   1.077853   .3916301     0.21   0.837     .5287884    2.197038
          4  |   .7453349   .2844944    -0.77   0.441     .3527343    1.574908
          5  |   .9128101   .3440421    -0.24   0.809     .4360727    1.910742
          6  |   2.019923   1.021382     1.39   0.164     .7497584    5.441873
             |
     bmi_cat |
Underweight  |   .6458651   .3034937    -0.93   0.352     .2571343    1.622272
 Overweight  |   1.335408   .3923846     0.98   0.325     .7507654    2.375328
      Obese  |   1.039927   .2911164     0.14   0.889     .6007838    1.800062
Morbidly ..  |   .9998716   .4273108    -0.00   1.000     .4326831    2.310567
             |
     smoking |
Current s..  |   1.153337   .3589253     0.46   0.647     .6266967    2.122537
  Ex-smoker  |   .6188986   .3044902    -0.98   0.329     .2359605    1.623304
             |
severe_dis~e |    1.03248   .2381679     0.14   0.890     .6569471    1.622681
covid_vacc~t |    .507449   .1819476    -1.89   0.058     .2512992    1.024693
 liver_trans |   2.226117   2.107592     0.85   0.398     .3480701    14.23735
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_o_120_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_o_120_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.03650         0.19        1         0.6602
      age_tv      |     -0.22717         7.10        1         0.0077
      male        |      0.02190         0.06        1         0.8096
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.04544         0.25        1         0.6184
      2.eth_bin   |      0.10861         1.13        1         0.2872
      1b.imd      |            .            .        1             .
      2.imd       |     -0.09073         0.92        1         0.3368
      3.imd       |     -0.08972         0.96        1         0.3272
      4.imd       |      0.03296         0.13        1         0.7189
      5.imd       |     -0.08989         0.80        1         0.3724
      6.imd       |     -0.01621         0.03        1         0.8658
      1.bmi_cat   |      0.03246         0.12        1         0.7247
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.17776         3.89        1         0.0485
      4.bmi_cat   |     -0.08980         0.98        1         0.3220
      5.bmi_cat   |      0.22558         4.44        1         0.0350
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.01312         0.02        1         0.8839
      2.smoking   |     -0.13560         2.55        1         0.1101
      severe_dis~e|      0.07018         0.67        1         0.4130
      covid_vacc~t|      0.07430         0.54        1         0.4609
      liver_trans |      0.11659         1.17        1         0.2799
      ------------+---------------------------------------------------
      global test |                     25.81       19         0.1357
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_o_120_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_o_120_died_covid_any.svg written in SVG format
> )

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -411.15058
Iteration 1:   log pseudolikelihood = -402.50317
Iteration 2:   log pseudolikelihood = -402.18398
Iteration 3:   log pseudolikelihood = -402.18216
Iteration 4:   log pseudolikelihood = -402.18216
Refining estimates:
Iteration 0:   log pseudolikelihood = -402.18216

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,442
No. of failures      =          168
Time at risk         =       647067
                                                Wald chi2(22)    =       20.22
Log pseudolikelihood =   -402.18216             Prob > chi2      =      0.5693

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.111618   .4779027     0.25   0.806     .4786417    2.581672
      age_tv |   1.000041   .0047095     0.01   0.993     .9908531    1.009314
        male |    1.34283   .2987337     1.33   0.185     .8682765     2.07675
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.277969   .4675204     0.67   0.503     .6239141    2.617677
      Asian  |   1.037712   .4085391     0.09   0.925     .4796951    2.244855
      Black  |   .7257296   .2893493    -0.80   0.421     .3322001     1.58544
      Other  |   1.336854   .5086889     0.76   0.445     .6341498    2.818229
    Unknown  |    1.74001   .8605136     1.12   0.263     .6600761    4.586795
             |
         imd |
          2  |   1.293633   .4636368     0.72   0.473      .640828    2.611445
          3  |   1.213166    .457728     0.51   0.609     .5791107    2.541434
          4  |   .7804023   .3038869    -0.64   0.524        .3638    1.674073
          5  |   .9294887   .3496732    -0.19   0.846     .4446543    1.942969
          6  |   2.028777   1.056474     1.36   0.174     .7310987    5.629794
             |
     bmi_cat |
Underweight  |    .646646   .3130374    -0.90   0.368     .2503831    1.670045
 Overweight  |   1.397154    .418222     1.12   0.264     .7770462    2.512127
      Obese  |   1.114527   .3262864     0.37   0.711     .6279061    1.978274
Morbidly ..  |   1.063288   .4550817     0.14   0.886     .4595589    2.460145
             |
     smoking |
Current s..  |   1.152576   .3557752     0.46   0.645     .6293934    2.110654
  Ex-smoker  |   .6232706    .305813    -0.96   0.335      .238247    1.630519
             |
severe_dis~e |   1.069872   .2491968     0.29   0.772     .6777478    1.688867
covid_vacc~t |   .5091391   .1805432    -1.90   0.057     .2540951     1.02018
 liver_trans |   1.817112   1.533161     0.71   0.479     .3476907    9.496649
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,927       65.84       65.84
          1 |      1,000       34.16      100.00
------------+-----------------------------------
      Total |      2,927      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  153
no udca events = 153
(1927 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      587642           0     587642     587642
19588.067
781.08781

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 15

Contains data from ./output/an_dataset_overlap_120_hosp_any.dta
  obs:         2,866                          
 vars:            23                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
         44  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  44

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_o_120_hosp_any.svg not found)
(file ./output/graphs/km_o_120_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -99.827775
Iteration 1:   log pseudolikelihood = -99.353009
Iteration 2:   log pseudolikelihood =  -99.26236
Iteration 3:   log pseudolikelihood = -99.261794
Iteration 4:   log pseudolikelihood = -99.261794
Refining estimates:
Iteration 0:   log pseudolikelihood = -99.261794

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,426
No. of failures      =           44
Time at risk         =       632950
                                                Wald chi2(1)     =        1.47
Log pseudolikelihood =   -99.261794             Prob > chi2      =      0.2255

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    2.06439   1.234471     1.21   0.225     .6394218    6.664939
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_o_120_hosp_any.dta not found)
file ./output/tempdata/surv_crude_o_120_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.14865         0.41        1         0.5224
      ------------+---------------------------------------------------
      global test |                      0.41        1         0.5224
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -99.073863
Iteration 2:   log pseudolikelihood = -98.990197
Iteration 3:   log pseudolikelihood = -98.989708
Iteration 4:   log pseudolikelihood = -98.989708
Refining estimates:
Iteration 0:   log pseudolikelihood = -98.989708

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(3)     =        1.57
Log pseudolikelihood =   -98.989708             Prob > chi2      =      0.6671

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.996213   1.184566     1.16   0.244      .623876    6.387275
      age_tv |   .9978458    .008679    -0.25   0.804     .9809794    1.015002
        male |   .9198596   .3947443    -0.19   0.846     .3966805    2.133056
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_o_120_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_o_120_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.19925         0.87        1         0.3503
      age_tv      |      0.12349         0.25        1         0.6198
      male        |     -0.24867         1.43        1         0.2320
      ------------+---------------------------------------------------
      global test |                      2.25        3         0.5227
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -92.990257
Iteration 2:   log pseudolikelihood = -89.452583
Iteration 3:   log pseudolikelihood = -89.169481
Iteration 4:   log pseudolikelihood =  -89.08867
Iteration 5:   log pseudolikelihood = -89.059229
Iteration 6:   log pseudolikelihood = -89.048425
Iteration 7:   log pseudolikelihood = -89.044454
Iteration 8:   log pseudolikelihood = -89.042994
Iteration 9:   log pseudolikelihood = -89.042456
Iteration 10:  log pseudolikelihood = -89.042259
Iteration 11:  log pseudolikelihood = -89.042186
Iteration 12:  log pseudolikelihood = -89.042159
Iteration 13:  log pseudolikelihood =  -89.04215
Iteration 14:  log pseudolikelihood = -89.042146
Iteration 15:  log pseudolikelihood = -89.042145
Iteration 16:  log pseudolikelihood = -89.042144
Iteration 17:  log pseudolikelihood = -89.042144
Iteration 18:  log pseudolikelihood = -89.042144
Iteration 19:  log pseudolikelihood = -89.042144
Iteration 20:  log pseudolikelihood = -89.042144
Iteration 21:  log pseudolikelihood = -89.042144
Iteration 22:  log pseudolikelihood = -89.042144
Iteration 23:  log pseudolikelihood = -89.042144
Iteration 24:  log pseudolikelihood = -89.042144
Iteration 25:  log pseudolikelihood = -89.042144
Iteration 26:  log pseudolikelihood = -89.042144
Iteration 27:  log pseudolikelihood = -89.042144
Iteration 28:  log pseudolikelihood = -89.042144
Iteration 29:  log pseudolikelihood = -89.042144
Iteration 30:  log pseudolikelihood = -89.042144
Iteration 31:  log pseudolikelihood = -89.042144
Iteration 32:  log pseudolikelihood = -89.042144
Iteration 33:  log pseudolikelihood = -89.042144
Refining estimates:
Iteration 0:   log pseudolikelihood = -89.042144
Iteration 1:   log pseudolikelihood = -89.042144
Iteration 2:   log pseudolikelihood = -89.042144

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(19)    =    11236.56
Log pseudolikelihood =   -89.042144             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.446321   .8739786     0.61   0.541     .4424896    4.727443
      age_tv |   .9924327   .0095843    -0.79   0.432     .9738245    1.011396
        male |   .9594088   .4801741    -0.08   0.934     .3597379    2.558711
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .5546275   .3187268    -1.03   0.305      .179822    1.710645
    Unknown  |   3.53e-16   2.83e-16   -44.36   0.000     7.34e-17    1.70e-15
             |
         imd |
          2  |   3.982731    3.03394     1.81   0.070     .8948658    17.72572
          3  |   1.802284   1.667495     0.64   0.524     .2939552    11.05007
          4  |   .5811847    .672927    -0.47   0.639     .0600824    5.621876
          5  |   5.783452   4.637027     2.19   0.029     1.201476    27.83936
          6  |   1.66e-15   1.32e-15   -42.81   0.000     3.49e-16    7.88e-15
             |
     bmi_cat |
Underweight  |   .6366883   .7245653    -0.40   0.692     .0684291    5.923971
 Overweight  |   1.921125   1.004495     1.25   0.212     .6894288    5.353302
      Obese  |   .8199968   .5599119    -0.29   0.771     .2150765    3.126305
Morbidly ..  |   .7407404   .5512253    -0.40   0.687     .1722823    3.184868
             |
     smoking |
Current s..  |   .7600568   .4730419    -0.44   0.659     .2244284    2.574034
  Ex-smoker  |   .5114322    .498571    -0.69   0.492     .0756819    3.456082
             |
severe_dis~e |   .7083489   .3018047    -0.81   0.418     .3073106    1.632739
covid_vacc~t |   .6108878   .4274101    -0.70   0.481     .1550297    2.407177
 liver_trans |   8.951747   12.34243     1.59   0.112     .6001972    133.5124
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_o_120_hosp_any.dta not found)
file ./output/tempdata/surv_adj_o_120_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.37076         5.39        1         0.0202
      age_tv      |     -0.01707         0.02        1         0.8926
      male        |     -0.27569         8.70        1         0.0032
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.14552         1.44        1         0.2308
      2.eth_bin   |      0.24690         3.91        1         0.0481
      1b.imd      |            .            .        1             .
      2.imd       |      0.11960         0.56        1         0.4539
      3.imd       |     -0.08639         0.69        1         0.4073
      4.imd       |      0.02118         0.03        1         0.8623
      5.imd       |     -0.08862         0.42        1         0.5193
      6.imd       |      0.06086         0.14        1         0.7057
      1.bmi_cat   |     -0.34725         8.05        1         0.0046
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.43655        11.19        1         0.0008
      4.bmi_cat   |     -0.04624         0.15        1         0.7001
      5.bmi_cat   |     -0.00280         0.00        1         0.9906
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.12543         0.88        1         0.3488
      2.smoking   |      0.09978         0.69        1         0.4074
      severe_dis~e|      0.28879         6.14        1         0.0132
      covid_vacc~t|     -0.08408         0.50        1         0.4774
      liver_trans |     -0.13151         1.23        1         0.2667
      ------------+---------------------------------------------------
      global test |                     23.56       19         0.2137
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_o_120_hosp_any.svg not found)
(file ./output/graphs/schoenplot_o_120_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -99.578927
Iteration 1:   log pseudolikelihood = -91.662102
Iteration 2:   log pseudolikelihood = -87.230417
Iteration 3:   log pseudolikelihood = -86.936106
Iteration 4:   log pseudolikelihood = -86.858762
Iteration 5:   log pseudolikelihood = -86.830606
Iteration 6:   log pseudolikelihood = -86.820272
Iteration 7:   log pseudolikelihood = -86.816474
Iteration 8:   log pseudolikelihood = -86.815078
Iteration 9:   log pseudolikelihood = -86.814564
Iteration 10:  log pseudolikelihood = -86.814375
Iteration 11:  log pseudolikelihood = -86.814305
Iteration 12:  log pseudolikelihood =  -86.81428
Iteration 13:  log pseudolikelihood =  -86.81427
Iteration 14:  log pseudolikelihood = -86.814267
Iteration 15:  log pseudolikelihood = -86.814266
Iteration 16:  log pseudolikelihood = -86.814265
Iteration 17:  log pseudolikelihood = -86.814265
Iteration 18:  log pseudolikelihood = -86.814265
Iteration 19:  log pseudolikelihood = -86.814265
Iteration 20:  log pseudolikelihood = -86.814265
Iteration 21:  log pseudolikelihood = -86.814265
Iteration 22:  log pseudolikelihood = -86.814265
Iteration 23:  log pseudolikelihood = -86.814265
Iteration 24:  log pseudolikelihood = -86.814265
Iteration 25:  log pseudolikelihood = -86.814265
Iteration 26:  log pseudolikelihood = -86.814265
Iteration 27:  log pseudolikelihood = -86.814265
Iteration 28:  log pseudolikelihood = -86.814265
Iteration 29:  log pseudolikelihood = -86.814265
Iteration 30:  log pseudolikelihood = -86.814265
Iteration 31:  log pseudolikelihood = -86.814265
Iteration 32:  log pseudolikelihood = -86.814265
Iteration 33:  log pseudolikelihood = -86.814265
Iteration 34:  log pseudolikelihood = -86.814265
Iteration 35:  log pseudolikelihood = -86.814265
Refining estimates:
Iteration 0:   log pseudolikelihood = -86.814265
Iteration 1:   log pseudolikelihood = -86.814265
Iteration 2:   log pseudolikelihood = -86.814265

Stratified Cox regr. -- no ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =           44
Time at risk         =       627730
                                                Wald chi2(22)    =    11985.09
Log pseudolikelihood =   -86.814265             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.137915   1.282689     1.27   0.205      .659619    6.929271
      age_tv |   .9921833   .0095265    -0.82   0.414     .9736862    1.011032
        male |   1.176194   .5639723     0.34   0.735     .4595544    3.010377
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .7774169     .54609    -0.36   0.720     .1962161    3.080161
      Asian  |   .8015876   .5922163    -0.30   0.765     .1883995    3.410533
      Black  |    .174503   .1492701    -2.04   0.041      .032635    .9330863
      Other  |   .7085181   .5174806    -0.47   0.637     .1693006    2.965127
    Unknown  |   4.62e-17   3.67e-17   -47.37   0.000     9.74e-18    2.19e-16
             |
         imd |
          2  |   4.664033   3.574615     2.01   0.045     1.038443    20.94791
          3  |   2.214724   2.145688     0.82   0.412     .3316281    14.79067
          4  |   .6057652   .7080928    -0.43   0.668     .0612795    5.988158
          5  |   5.924274   4.747511     2.22   0.026     1.231718    28.49437
          6  |   2.47e-16   2.01e-16   -44.17   0.000     5.02e-17    1.22e-15
             |
     bmi_cat |
Underweight  |   .5428729   .6208131    -0.53   0.593     .0577151    5.106304
 Overweight  |   2.026482   1.092217     1.31   0.190     .7046426    5.827962
      Obese  |    .981749   .6693317    -0.03   0.978     .2580315    3.735323
Morbidly ..  |   .8212683   .6450194    -0.25   0.802     .1761799     3.82837
             |
     smoking |
Current s..  |   .7118658    .469194    -0.52   0.606     .1955993    2.590771
  Ex-smoker  |   .4312128   .4088677    -0.89   0.375     .0672355     2.76557
             |
severe_dis~e |   .7563753   .3206154    -0.66   0.510      .329554    1.735994
covid_vacc~t |   .5270285   .3640783    -0.93   0.354     .1360858    2.041058
 liver_trans |    6.27172   7.510692     1.53   0.125      .599834    65.57559
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  40
no udca events = 40
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      570166           0     570166     570166
19005.533
210.46502

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = .

Contains data from ./output/an_dataset_overlap_120_composite_any.dta
  obs:         2,866                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
        204  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  204

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_o_120_composite_any.svg not found)
(file ./output/graphs/km_o_120_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -496.25556
Iteration 1:   log pseudolikelihood = -496.22541
Iteration 2:   log pseudolikelihood = -496.22537
Refining estimates:
Iteration 0:   log pseudolikelihood = -496.22537

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,426
No. of failures      =          204
Time at risk         =       632950
                                                Wald chi2(1)     =        0.06
Log pseudolikelihood =   -496.22537             Prob > chi2      =      0.8049

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.090726   .3834635     0.25   0.805      .547597    2.172552
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_o_120_composite_any.dta not found)
file ./output/tempdata/surv_crude_o_120_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03695         0.15        1         0.7015
      ------------+---------------------------------------------------
      global test |                      0.15        1         0.7015
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -495.11751
Iteration 2:   log pseudolikelihood = -495.11749
Refining estimates:
Iteration 0:   log pseudolikelihood = -495.11749

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(3)     =        0.29
Log pseudolikelihood =   -495.11749             Prob > chi2      =      0.9625

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.078153   .3806123     0.21   0.831     .5397435    2.153643
      age_tv |   .9998217   .0042075    -0.04   0.966     .9916091    1.008102
        male |    1.09492   .2123307     0.47   0.640     .7487114    1.601218
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_o_120_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_o_120_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.05209         0.30        1         0.5819
      age_tv      |     -0.17523         3.78        1         0.0517
      male        |     -0.03378         0.12        1         0.7327
      ------------+---------------------------------------------------
      global test |                      3.96        3         0.2661
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -486.77106
Iteration 2:   log pseudolikelihood = -486.54791
Iteration 3:   log pseudolikelihood = -486.54704
Iteration 4:   log pseudolikelihood = -486.54704
Refining estimates:
Iteration 0:   log pseudolikelihood = -486.54704

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(19)    =       15.87
Log pseudolikelihood =   -486.54704             Prob > chi2      =      0.6661

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.034144   .3908878     0.09   0.929     .4929949    2.169301
      age_tv |   .9998862   .0043364    -0.03   0.979     .9914231    1.008422
        male |   1.177819   .2349566     0.82   0.412     .7966678    1.741326
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .9632611   .2687004    -0.13   0.893     .5575739    1.664124
    Unknown  |   1.117294   .5478944     0.23   0.821     .4273252    2.921302
             |
         imd |
          2  |   1.490729   .4647529     1.28   0.200     .8091446    2.746446
          3  |   1.188749   .4061731     0.51   0.613     .6084862    2.322361
          4  |   .7350592   .2638286    -0.86   0.391      .363754    1.485378
          5  |   1.316127   .4452076     0.81   0.417     .6782048     2.55408
          6  |    1.67937   .8202985     1.06   0.289     .6447214    4.374425
             |
     bmi_cat |
Underweight  |   .6631003    .296176    -0.92   0.358     .2763041     1.59137
 Overweight  |    1.43559   .3851481     1.35   0.178      .848526    2.428821
      Obese  |   1.064919   .2772381     0.24   0.809     .6393186    1.773847
Morbidly ..  |   .9665432   .3670186    -0.09   0.929     .4591985    2.034427
             |
     smoking |
Current s..  |   .9747373   .2690597    -0.09   0.926     .5674504    1.674354
  Ex-smoker  |   .5769517   .2527028    -1.26   0.209      .244521    1.361328
             |
severe_dis~e |    .930021   .1895802    -0.36   0.722     .6237054    1.386775
covid_vacc~t |   .4700089   .1583883    -2.24   0.025     .2428061    .9098138
 liver_trans |   1.807762   2.173686     0.49   0.622     .1712541    19.08277
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_o_120_composite_any.dta not found)
file ./output/tempdata/surv_adj_o_120_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.05956         0.59        1         0.4408
      age_tv      |     -0.16588         4.20        1         0.0405
      male        |     -0.08437         0.97        1         0.3259
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.07937         1.01        1         0.3144
      2.eth_bin   |      0.12781         2.04        1         0.1527
      1b.imd      |            .            .        1             .
      2.imd       |     -0.08536         0.93        1         0.3342
      3.imd       |     -0.11596         2.09        1         0.1486
      4.imd       |      0.04787         0.31        1         0.5774
      5.imd       |     -0.07243         0.67        1         0.4118
      6.imd       |     -0.02190         0.06        1         0.8095
      1.bmi_cat   |     -0.04876         0.33        1         0.5677
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.24299         8.06        1         0.0045
      4.bmi_cat   |     -0.12764         2.32        1         0.1276
      5.bmi_cat   |      0.19017         3.28        1         0.0700
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.05113         0.37        1         0.5454
      2.smoking   |     -0.12614         2.74        1         0.0981
      severe_dis~e|      0.13178         2.14        1         0.1436
      covid_vacc~t|      0.02198         0.06        1         0.8091
      liver_trans |      0.01692         0.05        1         0.8220
      ------------+---------------------------------------------------
      global test |                     28.91       19         0.0674
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_o_120_composite_any.svg not found)
(file ./output/graphs/schoenplot_o_120_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -495.25237
Iteration 1:   log pseudolikelihood = -483.73333
Iteration 2:   log pseudolikelihood = -483.42072
Iteration 3:   log pseudolikelihood = -483.41985
Iteration 4:   log pseudolikelihood = -483.41985
Refining estimates:
Iteration 0:   log pseudolikelihood = -483.41985

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          992             Number of obs    =       1,414
No. of failures      =          204
Time at risk         =       627730
                                                Wald chi2(22)    =       22.19
Log pseudolikelihood =   -483.41985             Prob > chi2      =      0.4484

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.236906   .4766312     0.55   0.581     .5812107    2.632328
      age_tv |   .9987114   .0043375    -0.30   0.767     .9902461    1.007249
        male |   1.241945    .250847     1.07   0.283     .8359442    1.845131
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.219601   .3933284     0.62   0.538     .6481874    2.294749
      Asian  |   1.051284   .3713858     0.14   0.887      .526038    2.100985
      Black  |    .586205   .2141067    -1.46   0.144     .2865201    1.199345
      Other  |   1.117877   .3999453     0.31   0.755     .5544438    2.253877
    Unknown  |   1.096328   .5320779     0.19   0.850     .4234765    2.838258
             |
         imd |
          2  |   1.630661    .525524     1.52   0.129     .8670445    3.066804
          3  |   1.341662   .4743305     0.83   0.406     .6709803    2.682727
          4  |   .7608864   .2763932    -0.75   0.452     .3733529    1.550673
          5  |   1.349076   .4516244     0.89   0.371     .6999764    2.600097
          6  |   1.706556   .8615227     1.06   0.290     .6344647    4.590222
             |
     bmi_cat |
Underweight  |   .6404039     .29613    -0.96   0.335     .2587311    1.585109
 Overweight  |   1.494832   .4035401     1.49   0.136     .8806529    2.537348
      Obese  |   1.135296    .304336     0.47   0.636       .67132    1.919944
Morbidly ..  |   1.015823   .3884109     0.04   0.967     .4801222    2.149236
             |
     smoking |
Current s..  |   .9939412   .2731101    -0.02   0.982     .5800587    1.703137
  Ex-smoker  |   .5778138   .2513244    -1.26   0.207     .2463494    1.355266
             |
severe_dis~e |   .9658511   .1984981    -0.17   0.866     .6456162    1.444927
covid_vacc~t |   .4628309    .153741    -2.32   0.020     .2413649    .8875044
 liver_trans |   1.626462   1.781645     0.44   0.657     .1900325    13.92066
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  186
no udca events = 186
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        909      570166           0     570166     570166
19005.533
978.66235

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        909       90.90       90.90
          1 |         91        9.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 18

. 
. * sensitivity analysis - stratify by PBC vs PSC
. file write tablecontent _n ("PBC only sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1 & has_pbc==1
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_pbc_`outcome'.svg, as(svg) replace
 10.         * Cox model - crude
.         stcox udca if has_pbc==1, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model10
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_pbc_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_pbc_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male if has_pbc==1, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model11
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_pbc_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==1, st
> rata(stp) vce(robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model12
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_pbc_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_pbc_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_pbc_`outcome' adj_plot_pbc_`outcome'
 28.         graph export ./output/graphs/schoenplot_pbc_`outcome'.svg, as(svg)
>  replace 
 29.         * Cox model - fully adjusted with categorical ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==1, 
> strata(stp) vce(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1 & has_pbc==1
 34.         safecount if unexposed_ever==0 & has_pbc==1 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1 & has_pbc==1
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1 & has_pbc==1
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1 & has_pbc==1
 55.         qui safecount if exposed_ever==1 & number==1 & has_pbc==1
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1 & has_pbc==1
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1 & has_pbc==1
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. 
. }

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         2,927                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,927  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,927  observations remaining, representing
      1,000  subjects
        168  failures in single-failure-per-subject data
    652,287  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  80

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_pbc_died_covid_any.svg not found)
(file ./output/graphs/km_pbc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -161.90733
Iteration 1:   log pseudolikelihood =  -161.8461
Iteration 2:   log pseudolikelihood = -161.84503
Iteration 3:   log pseudolikelihood = -161.84503
Refining estimates:
Iteration 0:   log pseudolikelihood = -161.84503

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         683
No. of failures      =           80
Time at risk         =       326633
                                                Wald chi2(1)     =        0.14
Log pseudolikelihood =   -161.84503             Prob > chi2      =      0.7128

                           (Std. Err. adjusted for 237 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.310858   .9639419     0.37   0.713     .3101867    5.539726
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_pbc_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_pbc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.06303         0.16        1         0.6850
      ------------+---------------------------------------------------
      global test |                      0.16        1         0.6850
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -161.72811
Iteration 1:   log pseudolikelihood = -160.81844
Iteration 2:   log pseudolikelihood =  -160.8172
Iteration 3:   log pseudolikelihood =  -160.8172
Refining estimates:
Iteration 0:   log pseudolikelihood =  -160.8172

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         680
No. of failures      =           80
Time at risk         =       324811
                                                Wald chi2(3)     =        1.58
Log pseudolikelihood =    -160.8172             Prob > chi2      =      0.6628

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.238343   .8999481     0.29   0.769     .2980179    5.145641
      age_tv |   1.008968   .0075569     1.19   0.233     .9942648    1.023888
        male |   1.054851   .3340148     0.17   0.866     .5671021      1.9621
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_pbc_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_pbc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.05291         0.11        1         0.7387
      age_tv      |     -0.20662         2.62        1         0.1054
      male        |      0.10543         0.46        1         0.4967
      ------------+---------------------------------------------------
      global test |                      3.23        3         0.3569
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -161.72811
Iteration 1:   log pseudolikelihood = -153.94855
Iteration 2:   log pseudolikelihood = -149.68189
Iteration 3:   log pseudolikelihood = -149.57894
Iteration 4:   log pseudolikelihood = -149.57062
Iteration 5:   log pseudolikelihood = -149.56765
Iteration 6:   log pseudolikelihood = -149.56656
Iteration 7:   log pseudolikelihood = -149.56616
Iteration 8:   log pseudolikelihood = -149.56602
Iteration 9:   log pseudolikelihood = -149.56596
Iteration 10:  log pseudolikelihood = -149.56594
Iteration 11:  log pseudolikelihood = -149.56593
Iteration 12:  log pseudolikelihood = -149.56593
Iteration 13:  log pseudolikelihood = -149.56593
Iteration 14:  log pseudolikelihood = -149.56593
Iteration 15:  log pseudolikelihood = -149.56593
Iteration 16:  log pseudolikelihood = -149.56593
Iteration 17:  log pseudolikelihood = -149.56593
Iteration 18:  log pseudolikelihood = -149.56593
Iteration 19:  log pseudolikelihood = -149.56593
Iteration 20:  log pseudolikelihood = -149.56593
Iteration 21:  log pseudolikelihood = -149.56593
Iteration 22:  log pseudolikelihood = -149.56593
Iteration 23:  log pseudolikelihood = -149.56593
Iteration 24:  log pseudolikelihood = -149.56593
Iteration 25:  log pseudolikelihood = -149.56593
Iteration 26:  log pseudolikelihood = -149.56593
Iteration 27:  log pseudolikelihood = -149.56593
Iteration 28:  log pseudolikelihood = -149.56593
Iteration 29:  log pseudolikelihood = -149.56593
Iteration 30:  log pseudolikelihood = -149.56593
Iteration 31:  log pseudolikelihood = -149.56593
Refining estimates:
Iteration 0:   log pseudolikelihood = -149.56593
Iteration 1:   log pseudolikelihood = -149.56593

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         680
No. of failures      =           80
Time at risk         =       324811
                                                Wald chi2(19)    =     1256.77
Log pseudolikelihood =   -149.56593             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.271244   .8784224     0.35   0.728     .3281355    4.924979
      age_tv |   1.010229   .0082732     1.24   0.214     .9941436    1.026575
        male |   .9947958   .3394878    -0.02   0.988     .5096238    1.941861
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   3.301365   2.200599     1.79   0.073     .8939351    12.19217
    Unknown  |   4.030377   4.043087     1.39   0.165     .5642348    28.78933
             |
         imd |
          2  |   1.246976   .7112244     0.39   0.699     .4077253     3.81372
          3  |   1.239227   .7521011     0.35   0.724     .3771782    4.071504
          4  |   .6866267   .4673473    -0.55   0.581     .1808659    2.606661
          5  |   1.146349   .6332854     0.25   0.805     .3882235    3.384947
          6  |   3.921783   2.963876     1.81   0.071     .8916417    17.24951
             |
     bmi_cat |
Underweight  |   .4369002   .3589264    -1.01   0.313     .0873162    2.186097
 Overweight  |   .9158459   .4630421    -0.17   0.862     .3399882    2.467067
      Obese  |   .5486404   .2358997    -1.40   0.163     .2362084    1.274325
Morbidly ..  |   .9174131   .4610606    -0.17   0.864     .3425942    2.456687
             |
     smoking |
Current s..  |   1.212073    .561574     0.42   0.678     .4888239    3.005418
  Ex-smoker  |   .8425261   .5852649    -0.25   0.805     .2159196    3.287568
             |
severe_dis~e |   .4052125   .1486674    -2.46   0.014     .1974184    .8317217
covid_vacc~t |   .7202989   .3986445    -0.59   0.553     .2434564    2.131103
 liver_trans |   1.70e-14   1.73e-14   -31.08   0.000     2.30e-15    1.25e-13
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_pbc_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_pbc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.08329         0.43        1         0.5115
      age_tv      |     -0.22562         5.33        1         0.0209
      male        |      0.05051         0.15        1         0.6971
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.18722         1.84        1         0.1751
      2.eth_bin   |     -0.34154         6.92        1         0.0085
      1b.imd      |            .            .        1             .
      2.imd       |     -0.05170         0.19        1         0.6637
      3.imd       |     -0.06869         0.56        1         0.4557
      4.imd       |     -0.12048         0.91        1         0.3390
      5.imd       |      0.08794         0.48        1         0.4899
      6.imd       |      0.10614         1.01        1         0.3140
      1.bmi_cat   |      0.18117         3.39        1         0.0658
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.21377         4.80        1         0.0284
      4.bmi_cat   |     -0.14227         1.33        1         0.2481
      5.bmi_cat   |      0.26309         3.32        1         0.0685
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.25793         4.63        1         0.0315
      2.smoking   |     -0.35864        10.86        1         0.0010
      severe_dis~e|      0.24605         4.93        1         0.0264
      covid_vacc~t|      0.13831         1.32        1         0.2499
      liver_trans |     -0.11568         0.28        1         0.5935
      ------------+---------------------------------------------------
      global test |                     38.62       19         0.0049
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_pbc_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_pbc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -161.72811
Iteration 1:   log pseudolikelihood = -153.13538
Iteration 2:   log pseudolikelihood = -149.22993
Iteration 3:   log pseudolikelihood = -149.12439
Iteration 4:   log pseudolikelihood = -149.11579
Iteration 5:   log pseudolikelihood = -149.11272
Iteration 6:   log pseudolikelihood = -149.11159
Iteration 7:   log pseudolikelihood = -149.11118
Iteration 8:   log pseudolikelihood = -149.11102
Iteration 9:   log pseudolikelihood = -149.11097
Iteration 10:  log pseudolikelihood = -149.11095
Iteration 11:  log pseudolikelihood = -149.11094
Iteration 12:  log pseudolikelihood = -149.11094
Iteration 13:  log pseudolikelihood = -149.11094
Iteration 14:  log pseudolikelihood = -149.11094
Iteration 15:  log pseudolikelihood = -149.11094
Iteration 16:  log pseudolikelihood = -149.11093
Iteration 17:  log pseudolikelihood = -149.11093
Iteration 18:  log pseudolikelihood = -149.11093
Iteration 19:  log pseudolikelihood = -149.11093
Iteration 20:  log pseudolikelihood = -149.11093
Iteration 21:  log pseudolikelihood = -149.11093
Iteration 22:  log pseudolikelihood = -149.11093
Iteration 23:  log pseudolikelihood = -149.11093
Iteration 24:  log pseudolikelihood = -149.11093
Iteration 25:  log pseudolikelihood = -149.11093
Iteration 26:  log pseudolikelihood = -149.11093
Iteration 27:  log pseudolikelihood = -149.11093
Iteration 28:  log pseudolikelihood = -149.11093
Iteration 29:  log pseudolikelihood = -149.11093
Iteration 30:  log pseudolikelihood = -149.11093
Refining estimates:
Iteration 0:   log pseudolikelihood = -149.11093
Iteration 1:   log pseudolikelihood = -149.11093
Iteration 2:   log pseudolikelihood = -149.11093
Iteration 3:   log pseudolikelihood = -149.11093

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         680
No. of failures      =           80
Time at risk         =       324811
                                                Wald chi2(22)    =     1335.82
Log pseudolikelihood =   -149.11093             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.253122   .8567782     0.33   0.741     .3281063    4.785998
      age_tv |   1.010224   .0082713     1.24   0.214     .9941422    1.026566
        male |   1.028284   .3567159     0.08   0.936     .5209879    2.029543
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   3.289293   2.359417     1.66   0.097     .8063687    13.41749
      Asian  |   3.047401   2.285407     1.49   0.137     .7007591    13.25228
      Black  |   2.791244   2.020987     1.42   0.156     .6752885    11.53735
      Other  |   4.528025   3.476856     1.97   0.049     1.005336    20.39418
    Unknown  |   4.105904   4.154626     1.40   0.163     .5650754    29.83397
             |
         imd |
          2  |   1.177309    .692427     0.28   0.781     .3717587    3.728374
          3  |   1.259589   .7904756     0.37   0.713     .3681657    4.309375
          4  |   .7461389   .5171593    -0.42   0.673     .1917962    2.902681
          5  |   1.110129    .615698     0.19   0.851     .3743529    3.292043
          6  |   4.455845    3.70602     1.80   0.072     .8729066    22.74534
             |
     bmi_cat |
Underweight  |   .4759911   .4059187    -0.87   0.384     .0894758    2.532164
 Overweight  |   .9108833   .4812182    -0.18   0.860     .3234255    2.565377
      Obese  |   .5997726   .2729861    -1.12   0.261     .2457892     1.46356
Morbidly ..  |   1.009232   .5459474     0.02   0.986     .3495675    2.913743
             |
     smoking |
Current s..  |   1.228149   .5748782     0.44   0.661     .4907002    3.073872
  Ex-smoker  |   .8508511   .6027604    -0.23   0.820     .2122486    3.410847
             |
severe_dis~e |   .4367957     .16384    -2.21   0.027     .2094096    .9110874
covid_vacc~t |   .7451693   .3993124    -0.55   0.583     .2606893    2.130034
 liver_trans |   5.51e-15   5.58e-15   -32.47   0.000     7.60e-16    4.00e-14
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,927       65.84       65.84
          1 |      1,000       34.16      100.00
------------+-----------------------------------
      Total |      2,927      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  73
no udca events = 73
(1927 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        459      587642           0     587642     587642
19588.067
372.67588

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        459       91.80       91.80
          1 |         41        8.20      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 7

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,866                          
 vars:            23                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
         44  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  23

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_pbc_hosp_any.svg not found)
(file ./output/graphs/km_pbc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -37.153737
Iteration 1:   log pseudolikelihood = -36.845441
Iteration 2:   log pseudolikelihood = -36.739068
Iteration 3:   log pseudolikelihood = -36.700794
Iteration 4:   log pseudolikelihood = -36.686827
Iteration 5:   log pseudolikelihood = -36.681703
Iteration 6:   log pseudolikelihood = -36.679821
Iteration 7:   log pseudolikelihood = -36.679128
Iteration 8:   log pseudolikelihood = -36.678874
Iteration 9:   log pseudolikelihood =  -36.67878
Iteration 10:  log pseudolikelihood = -36.678745
Iteration 11:  log pseudolikelihood = -36.678733
Iteration 12:  log pseudolikelihood = -36.678728
Iteration 13:  log pseudolikelihood = -36.678726
Iteration 14:  log pseudolikelihood = -36.678726
Iteration 15:  log pseudolikelihood = -36.678725
Iteration 16:  log pseudolikelihood = -36.678725
Iteration 17:  log pseudolikelihood = -36.678725
Iteration 18:  log pseudolikelihood = -36.678725
Iteration 19:  log pseudolikelihood = -36.678725
Iteration 20:  log pseudolikelihood = -36.678725
Iteration 21:  log pseudolikelihood = -36.678725
Iteration 22:  log pseudolikelihood = -36.678725
Iteration 23:  log pseudolikelihood = -36.678725
Iteration 24:  log pseudolikelihood = -36.678725
Iteration 25:  log pseudolikelihood = -36.678725
Iteration 26:  log pseudolikelihood = -36.678725
Iteration 27:  log pseudolikelihood = -36.678725
Iteration 28:  log pseudolikelihood = -36.678725
Iteration 29:  log pseudolikelihood = -36.678725
Iteration 30:  log pseudolikelihood = -36.678725
Iteration 31:  log pseudolikelihood = -36.678725
Iteration 32:  log pseudolikelihood = -36.678725
Iteration 33:  log pseudolikelihood = -36.678725
Iteration 34:  log pseudolikelihood = -36.678725
Iteration 35:  log pseudolikelihood = -36.678725
Refining estimates:
Iteration 0:   log pseudolikelihood = -36.678725
Iteration 1:   log pseudolikelihood = -36.678725

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         670
No. of failures      =           23
Time at risk         =       315810
                                                Wald chi2(1)     =     5089.90
Log pseudolikelihood =   -36.678725             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 237 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.09e-16   1.06e-16   -71.34   0.000     7.74e-17    5.62e-16
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_pbc_hosp_any.dta not found)
file ./output/tempdata/surv_crude_pbc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |            .         0.00        1         1.0000
      ------------+---------------------------------------------------
      global test |                      0.00        1         1.0000
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -37.060183
Iteration 1:   log pseudolikelihood = -33.982918
Iteration 2:   log pseudolikelihood = -33.748694
Iteration 3:   log pseudolikelihood = -33.708073
Iteration 4:   log pseudolikelihood = -33.694374
Iteration 5:   log pseudolikelihood =  -33.68935
Iteration 6:   log pseudolikelihood = -33.687504
Iteration 7:   log pseudolikelihood = -33.686825
Iteration 8:   log pseudolikelihood = -33.686576
Iteration 9:   log pseudolikelihood = -33.686484
Iteration 10:  log pseudolikelihood =  -33.68645
Iteration 11:  log pseudolikelihood = -33.686437
Iteration 12:  log pseudolikelihood = -33.686433
Iteration 13:  log pseudolikelihood = -33.686431
Iteration 14:  log pseudolikelihood = -33.686431
Iteration 15:  log pseudolikelihood =  -33.68643
Iteration 16:  log pseudolikelihood =  -33.68643
Iteration 17:  log pseudolikelihood =  -33.68643
Iteration 18:  log pseudolikelihood =  -33.68643
Iteration 19:  log pseudolikelihood =  -33.68643
Iteration 20:  log pseudolikelihood =  -33.68643
Iteration 21:  log pseudolikelihood =  -33.68643
Iteration 22:  log pseudolikelihood =  -33.68643
Iteration 23:  log pseudolikelihood =  -33.68643
Iteration 24:  log pseudolikelihood =  -33.68643
Iteration 25:  log pseudolikelihood =  -33.68643
Iteration 26:  log pseudolikelihood =  -33.68643
Iteration 27:  log pseudolikelihood =  -33.68643
Iteration 28:  log pseudolikelihood =  -33.68643
Iteration 29:  log pseudolikelihood =  -33.68643
Iteration 30:  log pseudolikelihood =  -33.68643
Iteration 31:  log pseudolikelihood =  -33.68643
Iteration 32:  log pseudolikelihood =  -33.68643
Iteration 33:  log pseudolikelihood =  -33.68643
Refining estimates:
Iteration 0:   log pseudolikelihood =  -33.68643
Iteration 1:   log pseudolikelihood =  -33.68643

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         667
No. of failures      =           23
Time at risk         =       313988
                                                Wald chi2(3)     =     3644.28
Log pseudolikelihood =    -33.68643             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.63e-15   9.49e-16   -58.59   0.000     5.23e-16    5.10e-15
      age_tv |   .9943383   .0102664    -0.55   0.582     .9744187    1.014665
        male |   7.181009   7.469951     1.90   0.058     .9348333    55.16159
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_pbc_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_pbc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.24031         0.01        1         0.9213
      age_tv      |      0.31424         0.18        1         0.6731
      male        |     -0.05810         0.03        1         0.8668
      ------------+---------------------------------------------------
      global test |                      0.22        3         0.9750
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -37.060183
Iteration 1:   log pseudolikelihood = -27.574125
Iteration 2:   log pseudolikelihood = -25.194483
Iteration 3:   log pseudolikelihood = -24.717203
Iteration 4:   log pseudolikelihood = -24.590154
Iteration 5:   log pseudolikelihood = -24.544572
Iteration 6:   log pseudolikelihood = -24.527897
Iteration 7:   log pseudolikelihood = -24.521773
Iteration 8:   log pseudolikelihood = -24.519522
Iteration 9:   log pseudolikelihood = -24.518694
Iteration 10:  log pseudolikelihood = -24.518389
Iteration 11:  log pseudolikelihood = -24.518277
Iteration 12:  log pseudolikelihood = -24.518236
Iteration 13:  log pseudolikelihood = -24.518221
Iteration 14:  log pseudolikelihood = -24.518215
Iteration 15:  log pseudolikelihood = -24.518213
Iteration 16:  log pseudolikelihood = -24.518213
Iteration 17:  log pseudolikelihood = -24.518212
Iteration 18:  log pseudolikelihood = -24.518212
Iteration 19:  log pseudolikelihood = -24.518212
Iteration 20:  log pseudolikelihood = -24.518212
Iteration 21:  log pseudolikelihood = -24.518212
Iteration 22:  log pseudolikelihood = -24.518212
Iteration 23:  log pseudolikelihood = -24.518212
Iteration 24:  log pseudolikelihood = -24.518212
Iteration 25:  log pseudolikelihood = -24.518212
Iteration 26:  log pseudolikelihood = -24.518212
Iteration 27:  log pseudolikelihood = -24.518212
Iteration 28:  log pseudolikelihood = -24.518212
Iteration 29:  log pseudolikelihood = -24.518212
Iteration 30:  log pseudolikelihood = -24.518212
Iteration 31:  log pseudolikelihood = -24.518212
Iteration 32:  log pseudolikelihood = -24.518212
Iteration 33:  log pseudolikelihood = -24.518212
Iteration 34:  log pseudolikelihood = -24.518212
Iteration 35:  log pseudolikelihood = -24.518212
Iteration 36:  log pseudolikelihood = -24.518212
Iteration 37:  log pseudolikelihood = -24.518212
Iteration 38:  log pseudolikelihood = -24.518212
Iteration 39:  log pseudolikelihood = -24.518212
Refining estimates:
Iteration 0:   log pseudolikelihood = -24.518212
Iteration 1:   log pseudolikelihood = -24.518212
Iteration 2:   log pseudolikelihood = -24.518212
Iteration 3:   log pseudolikelihood = -24.518212

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         667
No. of failures      =           23
Time at risk         =       313988
                                                Wald chi2(16)    =    13693.44
Log pseudolikelihood =   -24.518212             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.90e-18   2.02e-18   -38.42   0.000     2.37e-19    1.52e-17
      age_tv |   .9951082   .0137357    -0.36   0.722     .9685477    1.022397
        male |   9.815854    12.2336     1.83   0.067      .853232    112.9247
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .2491564   .1986087    -1.74   0.081     .0522346    1.188463
    Unknown  |   9.60e-20   1.38e-19   -30.55   0.000     5.78e-21    1.59e-18
             |
         imd |
          2  |   1.21e+10   1.88e+10    14.89   0.000     5.68e+08    2.57e+11
          3  |   1.22e+10          .        .       .            .           .
          4  |   1.92e-09   2.86e-09   -13.44   0.000     1.03e-10    3.58e-08
          5  |   3.26e+10   3.73e+10    21.18   0.000     3.47e+09    3.06e+11
          6  |   1.00e-09          .        .       .            .           .
             |
     bmi_cat |
Underweight  |   7.10e-19   1.64e-18   -18.09   0.000     7.66e-21    6.57e-17
 Overweight  |    3.82124   3.144109     1.63   0.103     .7617937    19.16776
      Obese  |   1.216627   .9969687     0.24   0.811     .2441393    6.062855
Morbidly ..  |   8.22e-19   8.57e-19   -39.94   0.000     1.07e-19    6.34e-18
             |
     smoking |
Current s..  |   1.479185   1.624813     0.36   0.722     .1717984    12.73579
  Ex-smoker  |   2.211516   2.810629     0.62   0.532     .1831862    26.69853
             |
severe_dis~e |   3.036136   2.148325     1.57   0.117     .7586183     12.1512
covid_vacc~t |   1.551949   1.175822     0.58   0.562     .3515371    6.851466
 liver_trans |   4.06e-18          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_pbc_hosp_any.dta not found)
file ./output/tempdata/surv_adj_pbc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.13801         0.52        1         0.4723
      age_tv      |     -0.13804         0.64        1         0.4224
      male        |     -0.15201         1.44        1         0.2298
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.04012         0.07        1         0.7862
      2.eth_bin   |      0.07134         0.07        1         0.7984
      1b.imd      |            .            .        1             .
      2.imd       |     -0.11610         0.55        1         0.4583
      3.imd       |            .            .        1             .
      4.imd       |     -0.12759         1.00        1         0.3169
      5.imd       |     -0.13040         0.99        1         0.3199
      6.imd       |            .            .        1             .
      1.bmi_cat   |     -0.15040         1.27        1         0.2605
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.38914         2.71        1         0.0996
      4.bmi_cat   |      0.15396         0.56        1         0.4534
      5.bmi_cat   |     -0.24630         2.24        1         0.1347
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.32599         3.49        1         0.0617
      2.smoking   |     -0.15846         0.70        1         0.4014
      severe_dis~e|      0.19308         1.16        1         0.2818
      covid_vacc~t|      0.20934         0.95        1         0.3291
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                      8.03       16         0.9480
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_pbc_hosp_any.svg not found)
(file ./output/graphs/schoenplot_pbc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -37.060183
Iteration 1:   log pseudolikelihood = -26.571801
Iteration 2:   log pseudolikelihood = -24.496642
Iteration 3:   log pseudolikelihood = -24.069879
Iteration 4:   log pseudolikelihood =  -23.95764
Iteration 5:   log pseudolikelihood = -23.916896
Iteration 6:   log pseudolikelihood = -23.901902
Iteration 7:   log pseudolikelihood = -23.896382
Iteration 8:   log pseudolikelihood =  -23.89435
Iteration 9:   log pseudolikelihood = -23.893603
Iteration 10:  log pseudolikelihood = -23.893328
Iteration 11:  log pseudolikelihood = -23.893227
Iteration 12:  log pseudolikelihood =  -23.89319
Iteration 13:  log pseudolikelihood = -23.893176
Iteration 14:  log pseudolikelihood = -23.893171
Iteration 15:  log pseudolikelihood = -23.893169
Iteration 16:  log pseudolikelihood = -23.893168
Iteration 17:  log pseudolikelihood = -23.893168
Iteration 18:  log pseudolikelihood = -23.893168
Iteration 19:  log pseudolikelihood = -23.893168
Iteration 20:  log pseudolikelihood = -23.893168
Iteration 21:  log pseudolikelihood = -23.893168
Iteration 22:  log pseudolikelihood = -23.893168
Iteration 23:  log pseudolikelihood = -23.893168
Iteration 24:  log pseudolikelihood = -23.893168
Iteration 25:  log pseudolikelihood = -23.893168
Iteration 26:  log pseudolikelihood = -23.893168
Iteration 27:  log pseudolikelihood = -23.893168
Iteration 28:  log pseudolikelihood = -23.893168
Iteration 29:  log pseudolikelihood = -23.893168
Iteration 30:  log pseudolikelihood = -23.893168
Iteration 31:  log pseudolikelihood = -23.893168
Iteration 32:  log pseudolikelihood = -23.893168
Iteration 33:  log pseudolikelihood = -23.893168
Iteration 34:  log pseudolikelihood = -23.893168
Refining estimates:
Iteration 0:   log pseudolikelihood = -23.893168
Iteration 1:   log pseudolikelihood = -23.893168

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         667
No. of failures      =           23
Time at risk         =       313988
                                                Wald chi2(21)    =    12913.00
Log pseudolikelihood =   -23.893168             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.87e-15   2.32e-15   -27.40   0.000     1.65e-16    2.12e-14
      age_tv |   .9938753   .0129145    -0.47   0.636     .9688829    1.019512
        male |    10.2745   12.08834     1.98   0.048     1.023975    103.0937
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .3431101   .4445561    -0.83   0.409     .0270745    4.348168
      Asian  |   .4538021   .4791596    -0.75   0.454      .057293    3.594441
      Black  |   .1165618    .121197    -2.07   0.039     .0151882    .8945542
      Other  |   .2527218   .3601054    -0.97   0.334     .0154796    4.125977
    Unknown  |   1.45e-16   2.19e-16   -24.15   0.000     7.51e-18    2.80e-15
             |
         imd |
          2  |   1.37e+10          .        .       .            .           .
          3  |   1.28e+10   2.18e+10    13.69   0.000     4.57e+08    3.59e+11
          4  |   2.21e-06   3.36e-06    -8.56   0.000     1.12e-07    .0000435
          5  |   2.97e+10   2.77e+10    25.90   0.000     4.79e+09    1.84e+11
          6  |   1.22e-06   2.04e-06    -8.10   0.000     4.51e-08    .0000328
             |
     bmi_cat |
Underweight  |   1.53e-15   3.82e-15   -13.66   0.000     1.14e-17    2.04e-13
 Overweight  |    4.04302   4.005824     1.41   0.159     .5798766    28.18878
      Obese  |   1.310854    1.50938     0.24   0.814     .1372272    12.52185
Morbidly ..  |   8.47e-16   9.04e-16   -32.51   0.000     1.05e-16    6.87e-15
             |
     smoking |
Current s..  |   2.055885   2.233814     0.66   0.507     .2444156    17.29293
  Ex-smoker  |   2.443094    4.34631     0.50   0.616     .0747543     79.8443
             |
severe_dis~e |    2.84743   1.884451     1.58   0.114      .778254    10.41801
covid_vacc~t |   1.222856   1.002882     0.25   0.806     .2450713    6.101806
 liver_trans |   1.76e-15   3.36e-15   -17.85   0.000     4.23e-17    7.36e-14
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  22
no udca events = 22
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        459      570166           0     570166     570166
19005.533
115.75576

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        459       91.80       91.80
          1 |         41        8.20      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = .

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,866                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
        204  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  99

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_pbc_composite_any.svg not found)
(file ./output/graphs/km_pbc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -190.82697
Iteration 1:   log pseudolikelihood = -190.82693
Iteration 2:   log pseudolikelihood = -190.82693
Refining estimates:
Iteration 0:   log pseudolikelihood = -190.82693

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         670
No. of failures      =           99
Time at risk         =       315810
                                                Wald chi2(1)     =        0.00
Log pseudolikelihood =   -190.82693             Prob > chi2      =      0.9924

                           (Std. Err. adjusted for 237 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9930165   .7313325    -0.01   0.992     .2344592    4.205772
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_pbc_composite_any.dta not found)
file ./output/tempdata/surv_crude_pbc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.04059         0.08        1         0.7753
      ------------+---------------------------------------------------
      global test |                      0.08        1         0.7753
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -190.54924
Iteration 1:   log pseudolikelihood = -189.83526
Iteration 2:   log pseudolikelihood =  -189.8352
Iteration 3:   log pseudolikelihood =  -189.8352
Refining estimates:
Iteration 0:   log pseudolikelihood =  -189.8352

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         667
No. of failures      =           99
Time at risk         =       313988
                                                Wald chi2(3)     =        1.58
Log pseudolikelihood =    -189.8352             Prob > chi2      =      0.6638

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9567305   .6951995    -0.06   0.951     .2302883    3.974728
      age_tv |    1.00523   .0066167     0.79   0.428     .9923446    1.018282
        male |   1.318407   .3796454     0.96   0.337     .7497894    2.318246
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_pbc_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_pbc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03880         0.07        1         0.7892
      age_tv      |     -0.15812         1.53        1         0.2165
      male        |      0.05128         0.12        1         0.7264
      ------------+---------------------------------------------------
      global test |                      1.71        3         0.6358
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -190.54924
Iteration 1:   log pseudolikelihood = -182.03208
Iteration 2:   log pseudolikelihood = -180.53439
Iteration 3:   log pseudolikelihood = -180.47985
Iteration 4:   log pseudolikelihood = -180.47079
Iteration 5:   log pseudolikelihood = -180.46748
Iteration 6:   log pseudolikelihood = -180.46626
Iteration 7:   log pseudolikelihood = -180.46582
Iteration 8:   log pseudolikelihood = -180.46565
Iteration 9:   log pseudolikelihood = -180.46559
Iteration 10:  log pseudolikelihood = -180.46557
Iteration 11:  log pseudolikelihood = -180.46556
Iteration 12:  log pseudolikelihood = -180.46556
Iteration 13:  log pseudolikelihood = -180.46556
Iteration 14:  log pseudolikelihood = -180.46556
Iteration 15:  log pseudolikelihood = -180.46556
Iteration 16:  log pseudolikelihood = -180.46556
Iteration 17:  log pseudolikelihood = -180.46556
Iteration 18:  log pseudolikelihood = -180.46556
Iteration 19:  log pseudolikelihood = -180.46556
Iteration 20:  log pseudolikelihood = -180.46556
Iteration 21:  log pseudolikelihood = -180.46556
Iteration 22:  log pseudolikelihood = -180.46556
Iteration 23:  log pseudolikelihood = -180.46556
Iteration 24:  log pseudolikelihood = -180.46556
Iteration 25:  log pseudolikelihood = -180.46556
Iteration 26:  log pseudolikelihood = -180.46556
Iteration 27:  log pseudolikelihood = -180.46556
Iteration 28:  log pseudolikelihood = -180.46556
Iteration 29:  log pseudolikelihood = -180.46556
Iteration 30:  log pseudolikelihood = -180.46556
Iteration 31:  log pseudolikelihood = -180.46556
Iteration 32:  log pseudolikelihood = -180.46556
Iteration 33:  log pseudolikelihood = -180.46556
Iteration 34:  log pseudolikelihood = -180.46556
Iteration 35:  log pseudolikelihood = -180.46556
Iteration 36:  log pseudolikelihood = -180.46556
Iteration 37:  log pseudolikelihood = -180.46556
Iteration 38:  log pseudolikelihood = -180.46556
Iteration 39:  log pseudolikelihood = -180.46556
Iteration 40:  log pseudolikelihood = -180.46556
Iteration 41:  log pseudolikelihood = -180.46556
Iteration 42:  log pseudolikelihood = -180.46556
Iteration 43:  log pseudolikelihood = -180.46556
Refining estimates:
Iteration 0:   log pseudolikelihood = -180.46556

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         667
No. of failures      =           99
Time at risk         =       313988
                                                Wald chi2(18)    =       22.38
Log pseudolikelihood =   -180.46556             Prob > chi2      =      0.2157

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.046157   .7563185     0.06   0.950     .2536422    4.314917
      age_tv |   1.005814   .0071563     0.81   0.415     .9918854    1.019938
        male |   1.239289    .383509     0.69   0.488     .6757105    2.272922
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.684608    .869641     1.01   0.312     .6124703    4.633536
    Unknown  |   1.502423    1.49369     0.41   0.682     .2140615    10.54498
             |
         imd |
          2  |   1.580381   .8684226     0.83   0.405     .5383006    4.639795
          3  |    1.61174     .90449     0.85   0.395     .5365504    4.841495
          4  |   .7286319   .4793061    -0.48   0.630     .2007122    2.645103
          5  |   1.909086   1.014283     1.22   0.224     .6738886    5.408323
          6  |   3.672511   2.533023     1.89   0.059     .9503159    14.19248
             |
     bmi_cat |
Underweight  |   .4267112   .3269168    -1.11   0.266     .0950609     1.91543
 Overweight  |   1.081429   .4950114     0.17   0.864     .4409307    2.652318
      Obese  |   .6896954   .2679691    -0.96   0.339     .3220608    1.476988
Morbidly ..  |   .8566614    .431979    -0.31   0.759     .3188477    2.301628
             |
     smoking |
Current s..  |   1.174651   .4842615     0.39   0.696     .5235914     2.63527
  Ex-smoker  |   1.071709   .6422882     0.12   0.908     .3310868    3.469063
             |
severe_dis~e |   .4907483   .1584603    -2.20   0.027     .2606213    .9240761
covid_vacc~t |   .6884297   .3508597    -0.73   0.464     .2535379    1.869288
 liver_trans |   2.49e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_pbc_composite_any.dta not found)
file ./output/tempdata/surv_adj_pbc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03765         0.10        1         0.7542
      age_tv      |     -0.21315         4.18        1         0.0409
      male        |     -0.07305         0.33        1         0.5640
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.10234         0.93        1         0.3341
      2.eth_bin   |     -0.15658         2.69        1         0.1009
      1b.imd      |            .            .        1             .
      2.imd       |     -0.12118         1.07        1         0.3017
      3.imd       |     -0.06158         0.45        1         0.5047
      4.imd       |     -0.15882         1.67        1         0.1965
      5.imd       |     -0.04492         0.15        1         0.6968
      6.imd       |      0.11533         1.02        1         0.3114
      1.bmi_cat   |      0.16651         2.55        1         0.1102
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.32335        11.31        1         0.0008
      4.bmi_cat   |     -0.05769         0.21        1         0.6469
      5.bmi_cat   |      0.31922         5.94        1         0.0148
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.41777        11.55        1         0.0007
      2.smoking   |     -0.32183        10.18        1         0.0014
      severe_dis~e|      0.23956         4.70        1         0.0301
      covid_vacc~t|      0.12395         1.03        1         0.3094
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     46.64       18         0.0002
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_pbc_composite_any.svg not found)
(file ./output/graphs/schoenplot_pbc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -190.54924
Iteration 1:   log pseudolikelihood = -181.56841
Iteration 2:   log pseudolikelihood = -180.13141
Iteration 3:   log pseudolikelihood = -180.08243
Iteration 4:   log pseudolikelihood = -180.07348
Iteration 5:   log pseudolikelihood = -180.07021
Iteration 6:   log pseudolikelihood = -180.06901
Iteration 7:   log pseudolikelihood = -180.06856
Iteration 8:   log pseudolikelihood =  -180.0684
Iteration 9:   log pseudolikelihood = -180.06834
Iteration 10:  log pseudolikelihood = -180.06832
Iteration 11:  log pseudolikelihood = -180.06831
Iteration 12:  log pseudolikelihood = -180.06831
Iteration 13:  log pseudolikelihood = -180.06831
Iteration 14:  log pseudolikelihood = -180.06831
Iteration 15:  log pseudolikelihood = -180.06831
Iteration 16:  log pseudolikelihood = -180.06831
Iteration 17:  log pseudolikelihood = -180.06831
Iteration 18:  log pseudolikelihood = -180.06831
Iteration 19:  log pseudolikelihood = -180.06831
Iteration 20:  log pseudolikelihood = -180.06831
Iteration 21:  log pseudolikelihood = -180.06831
Iteration 22:  log pseudolikelihood = -180.06831
Iteration 23:  log pseudolikelihood = -180.06831
Iteration 24:  log pseudolikelihood = -180.06831
Iteration 25:  log pseudolikelihood = -180.06831
Iteration 26:  log pseudolikelihood = -180.06831
Iteration 27:  log pseudolikelihood = -180.06831
Iteration 28:  log pseudolikelihood = -180.06831
Iteration 29:  log pseudolikelihood = -180.06831
Iteration 30:  log pseudolikelihood = -180.06831
Iteration 31:  log pseudolikelihood = -180.06831
Iteration 32:  log pseudolikelihood = -180.06831
Iteration 33:  log pseudolikelihood = -180.06831
Iteration 34:  log pseudolikelihood = -180.06831
Refining estimates:
Iteration 0:   log pseudolikelihood = -180.06831
Iteration 1:   log pseudolikelihood = -180.06831
Iteration 2:   log pseudolikelihood = -180.06831

Stratified Cox regr. -- no ties

No. of subjects      =          497             Number of obs    =         667
No. of failures      =           99
Time at risk         =       313988
                                                Wald chi2(22)    =     2010.77
Log pseudolikelihood =   -180.06831             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 235 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.076225   .7768626     0.10   0.919     .2614998    4.429296
      age_tv |   1.005091   .0070739     0.72   0.471     .9913219    1.019052
        male |   1.285436   .4048542     0.80   0.425     .6933624     2.38309
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.848863   1.070306     1.06   0.288     .5944895    5.749964
      Asian  |   1.763764   1.025065     0.98   0.329     .5645975    5.509877
      Black  |   1.322771   .7733574     0.48   0.632     .4205622    4.160439
      Other  |   1.994358   1.315668     1.05   0.295     .5473558    7.266689
    Unknown  |   1.577685   1.573722     0.46   0.648     .2233351    11.14509
             |
         imd |
          2  |   1.570473   .8658775     0.82   0.413     .5329937     4.62742
          3  |   1.682942   .9769893     0.90   0.370     .5394181    5.250644
          4  |   .7728053   .5143117    -0.39   0.699     .2096934    2.848102
          5  |   1.896135   1.000603     1.21   0.225     .6740388     5.33401
          6  |    4.02052   3.061975     1.83   0.068     .9036879    17.88735
             |
     bmi_cat |
Underweight  |   .4360464   .3508493    -1.03   0.302     .0900831    2.110678
 Overweight  |   1.087513   .5094565     0.18   0.858     .4341904    2.723883
      Obese  |     .73527   .3002569    -0.75   0.451     .3302538    1.636989
Morbidly ..  |   .8605496   .4578846    -0.28   0.778      .303295    2.441668
             |
     smoking |
Current s..  |   1.219855   .5084461     0.48   0.634     .5389146    2.761191
  Ex-smoker  |   1.079197   .6517842     0.13   0.900      .330381    3.525221
             |
severe_dis~e |    .521961   .1731736    -1.96   0.050     .2724148    1.000105
covid_vacc~t |   .6743171   .3370969    -0.79   0.431     .2531286    1.796334
 liver_trans |   2.58e-16   2.34e-16   -39.58   0.000     4.35e-17    1.52e-15
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  91
no udca events = 91
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        459      570166           0     570166     570166
19005.533
478.80793

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        459       91.80       91.80
          1 |         41        8.20      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 8

. 
. file write tablecontent _n ("PSC only sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1 & has_pbc==0
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_psc_`outcome'.svg, as(svg) replace
 10.         * Cox model - crude
.         stcox udca if has_pbc==0, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model10
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_psc_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_psc_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male if has_pbc==0, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model11
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_psc_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==0, st
> rata(stp) vce(robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model12
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_psc_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_psc_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_psc_`outcome' adj_plot_psc_`outcome'
 28.         graph export ./output/graphs/schoenplot_psc_`outcome'.svg, as(svg)
>  replace 
 29.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==0, 
> strata(stp) vce(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1 & has_pbc==0
 34.         safecount if unexposed_ever==0 & has_pbc==0 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1 & has_pbc==0
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca has_pbc: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1 & has_pbc==0
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1 & has_pbc==0
 55.         qui safecount if exposed_ever==1 & number==1 & has_pbc==0
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1 & has_pbc==0
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         su total_follow_up if udca==1 & number==1 & has_pbc==0
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. 
. }

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         2,927                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,927  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,927  observations remaining, representing
      1,000  subjects
        168  failures in single-failure-per-subject data
    652,287  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  88

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_psc_died_covid_any.svg not found)
(file ./output/graphs/km_psc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -189.67715
Iteration 1:   log pseudolikelihood = -189.64172
Iteration 2:   log pseudolikelihood = -189.64165
Refining estimates:
Iteration 0:   log pseudolikelihood = -189.64165

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         771
No. of failures      =           88
Time at risk         =       325654
                                                Wald chi2(1)     =        0.07
Log pseudolikelihood =   -189.64165             Prob > chi2      =      0.7939

                           (Std. Err. adjusted for 263 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8826426   .4218165    -0.26   0.794     .3459347    2.252038
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_psc_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_psc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.00522         0.00        1         0.9708
      ------------+---------------------------------------------------
      global test |                      0.00        1         0.9708
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -189.0129
Iteration 1:   log pseudolikelihood = -187.78017
Iteration 2:   log pseudolikelihood = -187.78013
Refining estimates:
Iteration 0:   log pseudolikelihood = -187.78013

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         762
No. of failures      =           88
Time at risk         =       322256
                                                Wald chi2(3)     =        2.57
Log pseudolikelihood =   -187.78013             Prob > chi2      =      0.4635

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8343315   .4007451    -0.38   0.706     .3254547    2.138882
      age_tv |   .9941226   .0059462    -0.99   0.324     .9825363    1.005846
        male |    1.35243   .3968088     1.03   0.303     .7609721    2.403594
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_psc_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_psc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.01647         0.01        1         0.9071
      age_tv      |     -0.24386         2.92        1         0.0872
      male        |     -0.05030         0.12        1         0.7331
      ------------+---------------------------------------------------
      global test |                      2.93        3         0.4021
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -189.0129
Iteration 1:   log pseudolikelihood = -179.29185
Iteration 2:   log pseudolikelihood =  -175.7493
Iteration 3:   log pseudolikelihood = -175.47826
Iteration 4:   log pseudolikelihood = -175.46646
Iteration 5:   log pseudolikelihood = -175.46642
Refining estimates:
Iteration 0:   log pseudolikelihood = -175.46642

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         762
No. of failures      =           88
Time at risk         =       322256
                                                Wald chi2(19)    =       65.75
Log pseudolikelihood =   -175.46642             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8251638   .4776664    -0.33   0.740      .265339    2.566133
      age_tv |   .9967083   .0060305    -0.54   0.586     .9849586    1.008598
        male |   1.999639   .6914135     2.00   0.045     1.015389    3.937956
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .5414928   .2074535    -1.60   0.109     .2555556    1.147361
    Unknown  |    1.11654   .7040814     0.17   0.861     .3244242     3.84269
             |
         imd |
          2  |    1.01246   .4708252     0.03   0.979     .4069519    2.518911
          3  |   1.089934   .6050639     0.16   0.877      .367169    3.235449
          4  |   .6314089   .3144401    -0.92   0.356     .2379109    1.675741
          5  |   .5850563   .3520028    -0.89   0.373     .1799148    1.902516
          6  |   .7133974   .6774363    -0.36   0.722      .110927    4.588023
             |
     bmi_cat |
Underweight  |    1.05196   .7021823     0.08   0.940     .2843305    3.892023
 Overweight  |   2.110804   .8944834     1.76   0.078     .9198966    4.843471
      Obese  |   1.860555   .6782514     1.70   0.089     .9106331    3.801384
Morbidly ..  |   .9901251   .8843958    -0.01   0.991     .1719424    5.701605
             |
     smoking |
Current s..  |   .8670164   .3711628    -0.33   0.739     .3746577    2.006411
  Ex-smoker  |   .4826228   .3571855    -0.98   0.325     .1131462    2.058617
             |
severe_dis~e |    2.75775   1.032985     2.71   0.007     1.323476    5.746375
covid_vacc~t |   .3178144   .1666492    -2.19   0.029     .1137202    .8881979
 liver_trans |   7.731144   6.175937     2.56   0.010     1.615366    37.00126
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_psc_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_psc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.06488         0.42        1         0.5160
      age_tv      |     -0.05107         0.20        1         0.6512
      male        |     -0.18630         3.25        1         0.0716
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.10769         1.09        1         0.2966
      2.eth_bin   |      0.37201        10.20        1         0.0014
      1b.imd      |            .            .        1             .
      2.imd       |     -0.11800         1.11        1         0.2922
      3.imd       |     -0.09790         0.95        1         0.3302
      4.imd       |      0.07474         0.47        1         0.4923
      5.imd       |      0.00001         0.00        1         0.9999
      6.imd       |      0.00105         0.00        1         0.9912
      1.bmi_cat   |     -0.22852         4.08        1         0.0435
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.34329         8.81        1         0.0030
      4.bmi_cat   |     -0.13006         1.36        1         0.2441
      5.bmi_cat   |     -0.01886         0.01        1         0.9035
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.08525         0.55        1         0.4571
      2.smoking   |      0.02235         0.04        1         0.8352
      severe_dis~e|     -0.01330         0.02        1         0.8989
      covid_vacc~t|      0.08266         0.59        1         0.4443
      liver_trans |     -0.15126         1.55        1         0.2136
      ------------+---------------------------------------------------
      global test |                     17.54       19         0.5537
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_psc_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_psc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -189.0129
Iteration 1:   log pseudolikelihood =  -178.2353
Iteration 2:   log pseudolikelihood = -174.63887
Iteration 3:   log pseudolikelihood = -174.37414
Iteration 4:   log pseudolikelihood = -174.36288
Iteration 5:   log pseudolikelihood = -174.36284
Refining estimates:
Iteration 0:   log pseudolikelihood = -174.36284

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         762
No. of failures      =           88
Time at risk         =       322256
                                                Wald chi2(22)    =       68.25
Log pseudolikelihood =   -174.36284             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9459418   .5714002    -0.09   0.927     .2895292    3.090554
      age_tv |     .99495   .0060574    -0.83   0.406     .9831482    1.006893
        male |   1.981867   .7396748     1.83   0.067     .9536477    4.118708
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .7593187   .3654688    -0.57   0.567     .2956181    1.950371
      Asian  |   .5047472   .2714294    -1.27   0.204     .1759291    1.448139
      Black  |   .3664537   .2107829    -1.75   0.081     .1186892    1.131429
      Other  |   .5145177   .2912774    -1.17   0.240     .1696369    1.560559
    Unknown  |   1.043354   .6499448     0.07   0.946     .3077413    3.537345
             |
         imd |
          2  |   1.098903   .5566019     0.19   0.852     .4072117    2.965506
          3  |   1.201791   .6845748     0.32   0.747     .3935142    3.670269
          4  |   .5745975   .3028698    -1.05   0.293     .2045014    1.614475
          5  |   .6081351   .3752192    -0.81   0.420     .1814717    2.037939
          6  |   .6680249   .6426863    -0.42   0.675     .1013626    4.402583
             |
     bmi_cat |
Underweight  |   1.029475   .6738298     0.04   0.965     .2854122    3.713291
 Overweight  |   2.170914   .9065139     1.86   0.063     .9576444    4.921312
      Obese  |   1.822162   .6642298     1.65   0.100     .8918667    3.722838
Morbidly ..  |   1.151325   1.047527     0.15   0.877     .1935246    6.849508
             |
     smoking |
Current s..  |   .8583608   .3783402    -0.35   0.729      .361814     2.03636
  Ex-smoker  |   .4539662   .3593328    -1.00   0.318     .0962194    2.141826
             |
severe_dis~e |   2.702094   1.036253     2.59   0.010      1.27428    5.729756
covid_vacc~t |   .3129088   .1639205    -2.22   0.027     .1120746    .8736321
 liver_trans |   6.220687   6.064834     1.87   0.061     .9203709    42.04495
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,927       65.84       65.84
          1 |      1,000       34.16      100.00
------------+-----------------------------------
      Total |      2,927      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  80
no udca events = 80
(1927 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        450      289848           0     289848     289848
9661.6
828.0202

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        450       90.00       90.00
          1 |         50       10.00      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 8

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |         50       35806           0      35806      35806

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,866                          
 vars:            23                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
         44  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  21

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_psc_hosp_any.svg not found)
(file ./output/graphs/km_psc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -48.361328
Iteration 1:   log pseudolikelihood = -47.642778
Iteration 2:   log pseudolikelihood = -47.173707
Iteration 3:   log pseudolikelihood = -47.169897
Iteration 4:   log pseudolikelihood = -47.169897
Refining estimates:
Iteration 0:   log pseudolikelihood = -47.169897

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         756
No. of failures      =           21
Time at risk         =       317140
                                                Wald chi2(1)     =        2.92
Log pseudolikelihood =   -47.169897             Prob > chi2      =      0.0876

                           (Std. Err. adjusted for 263 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   3.157948   2.125939     1.71   0.088     .8440609    11.81507
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_psc_hosp_any.dta not found)
file ./output/tempdata/surv_crude_psc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.01153         0.00        1         0.9668
      ------------+---------------------------------------------------
      global test |                      0.00        1         0.9668
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -48.172254
Iteration 1:   log pseudolikelihood = -45.132155
Iteration 2:   log pseudolikelihood = -44.670952
Iteration 3:   log pseudolikelihood = -44.668048
Iteration 4:   log pseudolikelihood = -44.668048
Refining estimates:
Iteration 0:   log pseudolikelihood = -44.668048

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         747
No. of failures      =           21
Time at risk         =       313742
                                                Wald chi2(3)     =        6.06
Log pseudolikelihood =   -44.668048             Prob > chi2      =      0.1086

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.643388   1.858318     1.38   0.167       .66644    10.48482
      age_tv |   .9996431   .0138529    -0.03   0.979     .9728573    1.027166
        male |   .2299024   .1823225    -1.85   0.064     .0485852    1.087885
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_psc_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_psc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.06970         0.08        1         0.7813
      age_tv      |     -0.11356         0.29        1         0.5931
      male        |     -0.09142         0.15        1         0.7011
      ------------+---------------------------------------------------
      global test |                      0.32        3         0.9554
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -48.172254
Iteration 1:   log pseudolikelihood = -45.725004
Iteration 2:   log pseudolikelihood = -43.750351
Iteration 3:   log pseudolikelihood =  -41.35014
Iteration 4:   log pseudolikelihood = -38.601877
Iteration 5:   log pseudolikelihood = -37.214492
Iteration 6:   log pseudolikelihood = -36.917574
Iteration 7:   log pseudolikelihood = -36.845553
Iteration 8:   log pseudolikelihood =  -36.81938
Iteration 9:   log pseudolikelihood = -36.809784
Iteration 10:  log pseudolikelihood = -36.806259
Iteration 11:  log pseudolikelihood = -36.804962
Iteration 12:  log pseudolikelihood = -36.804486
Iteration 13:  log pseudolikelihood =  -36.80431
Iteration 14:  log pseudolikelihood = -36.804246
Iteration 15:  log pseudolikelihood = -36.804222
Iteration 16:  log pseudolikelihood = -36.804213
Iteration 17:  log pseudolikelihood =  -36.80421
Iteration 18:  log pseudolikelihood = -36.804209
Iteration 19:  log pseudolikelihood = -36.804208
Iteration 20:  log pseudolikelihood = -36.804208
Iteration 21:  log pseudolikelihood = -36.804208
Iteration 22:  log pseudolikelihood = -36.804208
Iteration 23:  log pseudolikelihood = -36.804208
Iteration 24:  log pseudolikelihood = -36.804208
Iteration 25:  log pseudolikelihood = -36.804208
Iteration 26:  log pseudolikelihood = -36.804208
Iteration 27:  log pseudolikelihood = -36.804208
Iteration 28:  log pseudolikelihood = -36.804208
Iteration 29:  log pseudolikelihood = -36.804208
Iteration 30:  log pseudolikelihood = -36.804208
Iteration 31:  log pseudolikelihood = -36.804208
Iteration 32:  log pseudolikelihood = -36.804208
Iteration 33:  log pseudolikelihood = -36.804208
Iteration 34:  log pseudolikelihood = -36.804208
Iteration 35:  log pseudolikelihood = -36.804208
Iteration 36:  log pseudolikelihood = -36.804208
Iteration 37:  log pseudolikelihood = -36.804208
Refining estimates:
Iteration 0:   log pseudolikelihood = -36.804208
Iteration 1:   log pseudolikelihood = -36.804208

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         747
No. of failures      =           21
Time at risk         =       313742
                                                Wald chi2(19)    =    10125.74
Log pseudolikelihood =   -36.804208             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8143455   .9576473    -0.17   0.861     .0812493     8.16202
      age_tv |   .9890036   .0201739    -0.54   0.588     .9502434    1.029345
        male |   .2569129   .2619758    -1.33   0.183     .0348185    1.895666
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.030239   .7581896     0.04   0.968     .2435056    4.358805
    Unknown  |   3.43e-16   3.78e-16   -32.35   0.000     3.97e-17    2.97e-15
             |
         imd |
          2  |   3.048936   2.227298     1.53   0.127     .7283356    12.76336
          3  |   .8198204   .9117226    -0.18   0.858     .0927037    7.250037
          4  |   .4616727    .578066    -0.62   0.537     .0396766    5.371974
          5  |   2.243861   1.980717     0.92   0.360     .3977565    12.65828
          6  |   4.61e-16   4.56e-16   -35.73   0.000     6.65e-17    3.20e-15
             |
     bmi_cat |
Underweight  |   .9354201   1.389367    -0.04   0.964     .0509012    17.19037
 Overweight  |   1.204826   1.136301     0.20   0.843     .1897298    7.650915
      Obese  |   1.340236   1.330146     0.30   0.768     .1915964    9.375079
Morbidly ..  |   1.330566   1.071619     0.35   0.723     .2744674    6.450335
             |
     smoking |
Current s..  |    .491826   .4318004    -0.81   0.419     .0880027    2.748698
  Ex-smoker  |   2.82e-16   2.74e-16   -36.79   0.000     4.19e-17    1.90e-15
             |
severe_dis~e |   .3926675   .2582239    -1.42   0.155     .1082088     1.42491
covid_vacc~t |   .5717801     .50687    -0.63   0.528      .100614    3.249375
 liver_trans |   95.89015   152.9798     2.86   0.004     4.205297    2186.509
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_psc_hosp_any.dta not found)
file ./output/tempdata/surv_adj_psc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.33113         9.22        1         0.0024
      age_tv      |     -0.12221         1.36        1         0.2442
      male        |     -0.17939         4.69        1         0.0304
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.10871         0.40        1         0.5279
      2.eth_bin   |     -0.01182         0.00        1         0.9451
      1b.imd      |            .            .        1             .
      2.imd       |      0.05488         0.12        1         0.7325
      3.imd       |     -0.28366         6.21        1         0.0127
      4.imd       |      0.20307         3.95        1         0.0468
      5.imd       |      0.46559        10.69        1         0.0011
      6.imd       |      0.36192         5.44        1         0.0197
      1.bmi_cat   |     -0.39914        19.56        1         0.0000
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.24496         4.90        1         0.0268
      4.bmi_cat   |     -0.51838         9.64        1         0.0019
      5.bmi_cat   |     -0.44729         3.78        1         0.0518
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.33081         4.60        1         0.0320
      2.smoking   |      0.38218         4.10        1         0.0429
      severe_dis~e|      0.37014        10.64        1         0.0011
      covid_vacc~t|      0.15749         2.29        1         0.1300
      liver_trans |     -0.31663         3.35        1         0.0674
      ------------+---------------------------------------------------
      global test |                     30.04       19         0.0513
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_psc_hosp_any.svg not found)
(file ./output/graphs/schoenplot_psc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -48.172254
Iteration 1:   log pseudolikelihood = -45.069804
Iteration 2:   log pseudolikelihood = -42.787176
Iteration 3:   log pseudolikelihood = -39.773691
Iteration 4:   log pseudolikelihood = -37.383473
Iteration 5:   log pseudolikelihood = -36.376534
Iteration 6:   log pseudolikelihood =  -36.20037
Iteration 7:   log pseudolikelihood =  -35.04332
Iteration 8:   log pseudolikelihood = -34.996163
Iteration 9:   log pseudolikelihood = -34.981604
Iteration 10:  log pseudolikelihood =  -34.97626
Iteration 11:  log pseudolikelihood = -34.974296
Iteration 12:  log pseudolikelihood = -34.973573
Iteration 13:  log pseudolikelihood = -34.973308
Iteration 14:  log pseudolikelihood =  -34.97321
Iteration 15:  log pseudolikelihood = -34.973174
Iteration 16:  log pseudolikelihood = -34.973161
Iteration 17:  log pseudolikelihood = -34.973156
Iteration 18:  log pseudolikelihood = -34.973154
Iteration 19:  log pseudolikelihood = -34.973153
Iteration 20:  log pseudolikelihood = -34.973153
Iteration 21:  log pseudolikelihood = -34.973153
Iteration 22:  log pseudolikelihood = -34.973153
Iteration 23:  log pseudolikelihood = -34.973153
Iteration 24:  log pseudolikelihood = -34.973153
Iteration 25:  log pseudolikelihood = -34.973153
Iteration 26:  log pseudolikelihood = -34.973153
Iteration 27:  log pseudolikelihood = -34.973153
Iteration 28:  log pseudolikelihood = -34.973153
Iteration 29:  log pseudolikelihood = -34.973153
Iteration 30:  log pseudolikelihood = -34.973153
Iteration 31:  log pseudolikelihood = -34.973153
Iteration 32:  log pseudolikelihood = -34.973153
Iteration 33:  log pseudolikelihood = -34.973153
Iteration 34:  log pseudolikelihood = -34.973153
Iteration 35:  log pseudolikelihood = -34.973153
Iteration 36:  log pseudolikelihood = -34.973153
Iteration 37:  log pseudolikelihood = -34.973153
Refining estimates:
Iteration 0:   log pseudolikelihood = -34.973153
Iteration 1:   log pseudolikelihood = -34.973153

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         747
No. of failures      =           21
Time at risk         =       313742
                                                Wald chi2(22)    =    11044.94
Log pseudolikelihood =   -34.973153             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.472807   1.741361     0.33   0.743     .1451225     14.9471
      age_tv |   .9864479   .0200018    -0.67   0.501     .9480138     1.02644
        male |   .3056376   .3377817    -1.07   0.283     .0350335    2.666428
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.838498   1.745411     0.64   0.521     .2859958    11.81862
      Asian  |   .9012486   1.106877    -0.08   0.933      .081177     10.0059
      Black  |    .248824   .2685802    -1.29   0.198      .029999    2.063848
      Other  |   1.783161   1.620711     0.64   0.525     .3002861    10.58877
    Unknown  |   3.73e-16   4.28e-16   -30.95   0.000     3.93e-17    3.54e-15
             |
         imd |
          2  |   6.196605   6.428531     1.76   0.079     .8111359    47.33845
          3  |   1.489994   2.198458     0.27   0.787     .0826518    26.86064
          4  |   .8249217   1.092517    -0.15   0.884     .0615306    11.05947
          5  |   4.235237   4.245034     1.44   0.150     .5938915    30.20287
          6  |   6.84e-16   7.38e-16   -32.38   0.000     8.26e-17    5.66e-15
             |
     bmi_cat |
Underweight  |   .7183845   .9763617    -0.24   0.808      .050059    10.30935
 Overweight  |   1.188776   1.182855     0.17   0.862     .1690979    8.357224
      Obese  |   1.542853   1.417485     0.47   0.637     .2548527    9.340281
Morbidly ..  |   1.561685    1.41537     0.49   0.623     .2643268    9.226682
             |
     smoking |
Current s..  |   .6944739   .7748057    -0.33   0.744     .0779818    6.184697
  Ex-smoker  |   4.67e-16   5.38e-16   -30.69   0.000     4.90e-17    4.46e-15
             |
severe_dis~e |   .3241192   .2101807    -1.74   0.082     .0909344    1.155263
covid_vacc~t |   .5368344   .5184576    -0.64   0.520      .080868    3.563722
 liver_trans |     31.267   45.05515     2.39   0.017     1.855757    526.8068
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  18
no udca events = 18
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        450      282617           0     282617     282617
9420.5667
191.07131

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        450       90.00       90.00
          1 |         50       10.00      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = .

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |         50       34523           0      34523      34523

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,866                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,866  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,866  observations remaining, representing
      1,000  subjects
        204  failures in single-failure-per-subject data
    632,950  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  105

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_psc_composite_any.svg not found)
(file ./output/graphs/km_psc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -232.6166
Iteration 1:   log pseudolikelihood = -232.57072
Iteration 2:   log pseudolikelihood = -232.57061
Iteration 3:   log pseudolikelihood = -232.57061
Refining estimates:
Iteration 0:   log pseudolikelihood = -232.57061

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          500             Number of obs    =         756
No. of failures      =          105
Time at risk         =       317140
                                                Wald chi2(1)     =        0.09
Log pseudolikelihood =   -232.57061             Prob > chi2      =      0.7673

                           (Std. Err. adjusted for 263 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.133345   .4794465     0.30   0.767     .4946209    2.596878
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_psc_composite_any.dta not found)
file ./output/tempdata/surv_crude_psc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.01900         0.02        1         0.8769
      ------------+---------------------------------------------------
      global test |                      0.02        1         0.8769
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -231.75072
Iteration 1:   log pseudolikelihood = -231.41659
Iteration 2:   log pseudolikelihood = -231.41651
Refining estimates:
Iteration 0:   log pseudolikelihood = -231.41651

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         747
No. of failures      =          105
Time at risk         =       313742
                                                Wald chi2(3)     =        0.67
Log pseudolikelihood =   -231.41651             Prob > chi2      =      0.8798

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.079026   .4614809     0.18   0.859     .4666459    2.495032
      age_tv |   .9958658   .0054332    -0.76   0.448     .9852737    1.006572
        male |   .9839829    .258578    -0.06   0.951      .587899    1.646919
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_psc_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_psc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.04731         0.15        1         0.6945
      age_tv      |     -0.19540         2.41        1         0.1204
      male        |     -0.07582         0.33        1         0.5673
      ------------+---------------------------------------------------
      global test |                      2.53        3         0.4703
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -231.75072
Iteration 1:   log pseudolikelihood = -224.78069
Iteration 2:   log pseudolikelihood = -219.73911
Iteration 3:   log pseudolikelihood = -219.63791
Iteration 4:   log pseudolikelihood = -219.63689
Iteration 5:   log pseudolikelihood = -219.63689
Refining estimates:
Iteration 0:   log pseudolikelihood = -219.63689

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         747
No. of failures      =          105
Time at risk         =       313742
                                                Wald chi2(19)    =       55.79
Log pseudolikelihood =   -219.63689             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9601482   .5173607    -0.08   0.940     .3339502    2.760545
      age_tv |   .9970642   .0055267    -0.53   0.596     .9862907    1.007955
        male |   1.299366   .3898889     0.87   0.383      .721638    2.339612
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .6653402   .2194886    -1.24   0.217     .3485311    1.270124
    Unknown  |   .8879091   .4842165    -0.22   0.827      .304909    2.585632
             |
         imd |
          2  |   1.406508   .5744784     0.84   0.404     .6316479    3.131912
          3  |    1.04327   .5262509     0.08   0.933     .3881773    2.803907
          4  |   .6852166    .296173    -0.87   0.382     .2937047    1.598619
          5  |   .8536374   .4304718    -0.31   0.754     .3177094    2.293596
          6  |   .6507167   .5558154    -0.50   0.615     .1219918    3.470989
             |
     bmi_cat |
Underweight  |   1.037227   .6443691     0.06   0.953     .3069526    3.504903
 Overweight  |   1.782734    .680322     1.51   0.130     .8438268    3.766342
      Obese  |   1.598707   .5442547     1.38   0.168      .820334    3.115639
Morbidly ..  |   1.079579   .6562717     0.13   0.900     .3279539    3.553828
             |
     smoking |
Current s..  |   .7099135   .2690825    -0.90   0.366       .33773    1.492249
  Ex-smoker  |   .3059454   .2172313    -1.67   0.095     .0760786     1.23034
             |
severe_dis~e |   1.680862    .512066     1.70   0.088     .9251623     3.05384
covid_vacc~t |   .3389656   .1630633    -2.25   0.025     .1320308    .8702338
 liver_trans |   12.48923   9.702293     3.25   0.001      2.72444    57.25243
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_psc_composite_any.dta not found)
file ./output/tempdata/surv_adj_psc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.13987         2.73        1         0.0985
      age_tv      |     -0.06187         0.34        1         0.5610
      male        |     -0.24397         6.44        1         0.0112
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.09611         0.77        1         0.3792
      2.eth_bin   |      0.38804        12.08        1         0.0005
      1b.imd      |            .            .        1             .
      2.imd       |     -0.10661         0.96        1         0.3270
      3.imd       |     -0.14861         2.19        1         0.1387
      4.imd       |      0.10713         0.90        1         0.3415
      5.imd       |      0.08952         0.80        1         0.3711
      6.imd       |      0.01684         0.03        1         0.8724
      1.bmi_cat   |     -0.31638        10.50        1         0.0012
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.38517        12.64        1         0.0004
      4.bmi_cat   |     -0.23114         4.71        1         0.0299
      5.bmi_cat   |     -0.05890         0.16        1         0.6904
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.18448         2.61        1         0.1065
      2.smoking   |      0.00382         0.00        1         0.9694
      severe_dis~e|      0.08270         0.53        1         0.4651
      covid_vacc~t|      0.03477         0.11        1         0.7400
      liver_trans |     -0.17782         2.09        1         0.1482
      ------------+---------------------------------------------------
      global test |                     27.61       19         0.0912
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_psc_composite_any.svg not found)
(file ./output/graphs/schoenplot_psc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -231.75072
Iteration 1:   log pseudolikelihood = -223.07243
Iteration 2:   log pseudolikelihood = -216.95696
Iteration 3:   log pseudolikelihood =   -216.825
Iteration 4:   log pseudolikelihood = -216.82404
Iteration 5:   log pseudolikelihood = -216.82404
Refining estimates:
Iteration 0:   log pseudolikelihood = -216.82404

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         747
No. of failures      =          105
Time at risk         =       313742
                                                Wald chi2(22)    =       55.96
Log pseudolikelihood =   -216.82404             Prob > chi2      =      0.0001

                           (Std. Err. adjusted for 260 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.139801   .6311651     0.24   0.813     .3850132    3.374288
      age_tv |   .9946109   .0056817    -0.95   0.344      .983537     1.00581
        male |   1.334777   .4168383     0.92   0.355     .7237461    2.461676
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.040513   .4216237     0.10   0.922     .4702556    2.302294
      Asian  |   .6383996   .3097547    -0.92   0.355     .2466524    1.652342
      Black  |   .3623739   .1849028    -1.99   0.047     .1332993     .985113
      Other  |   .6597413   .3274114    -0.84   0.402     .2494284    1.745024
    Unknown  |   .7828939    .421218    -0.45   0.649     .2727304    2.247358
             |
         imd |
          2  |   1.643161   .7260107     1.12   0.261     .6911737    3.906368
          3  |   1.271531   .6591926     0.46   0.643     .4603028    3.512453
          4  |   .6391531   .2916344    -0.98   0.327     .2613463    1.563124
          5  |   .9154838   .4730367    -0.17   0.864     .3325286    2.520416
          6  |   .6101087   .5402127    -0.56   0.577     .1075776     3.46013
             |
     bmi_cat |
Underweight  |   1.017215   .6248052     0.03   0.978     .3051957    3.390372
 Overweight  |   1.885292   .6973492     1.71   0.086     .9131212    3.892503
      Obese  |   1.590862   .5479545     1.35   0.178     .8099267    3.124779
Morbidly ..  |   1.353282   .8538933     0.48   0.632     .3929139       4.661
             |
     smoking |
Current s..  |   .7379645   .2862566    -0.78   0.433     .3450279    1.578399
  Ex-smoker  |   .2916478   .2229428    -1.61   0.107     .0651897    1.304783
             |
severe_dis~e |   1.663657   .5136422     1.65   0.099     .9083669    3.046956
covid_vacc~t |   .3393629   .1631691    -2.25   0.025     .1322508    .8708244
 liver_trans |   8.875067   7.465775     2.60   0.009      1.70661    46.15396
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,866       65.11       65.11
          1 |      1,000       34.89      100.00
------------+-----------------------------------
      Total |      2,866      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  95
no udca events = 95
(1866 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        450      282617           0     282617     282617
9420.5667
1008.4319

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        450       90.00       90.00
          1 |         50       10.00      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 10

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |         50       34523           0      34523      34523

. 
. * Take out people prescribed OCA at baseline  
. file write tablecontent _n ("Remove people prescribed OCA sensitivity analysi
> s") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     drop if oca_bl==1
  6.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  7.     count if `outcome'_flag==1
  8.     if r(N) > 10 {
  9.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
 10.         graph export ./output/graphs/km_oca_`outcome'.svg, as(svg) replace
 11.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 12.         estimates save "./output/tempdata/crude_`outcome'", replace 
 13.         eststo model7
 14.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_oca_`outcome'", replace) idstr("crude_`outcome'") 
 15.         estat phtest, detail
 16.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_oca_`outcome') ///
>                     note("")
 17.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 18.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 19.         eststo model8
 20.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_oca_`outcome'", replace) idstr("adj_`outcome'") 
 21.         estat phtest, detail
 22.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 23.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 24.         eststo model9
 25.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_oca_`outcome'", replace) idstr("adj_`outcome'") 
 26.         estat phtest, detail
 27.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_oca_`outcome') ///
>                     note("")
 28.         graph combine uni_plot_oca_`outcome' adj_plot_oca_`outcome'
 29.         graph export ./output/graphs/schoenplot_oca_`outcome'.svg, as(svg)
>  replace 
 30.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 31.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 32.         tab number 
 33.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 34.         tab unexposed_ever if number==1
 35.         safecount if unexposed_ever==0 & number==1
 36.         local denominator = r(N)
 37.         safecount if udca == 0 & `outcome'_flag == 1
 38.         local event = r(N)
 39.         di "no udca events = " `event'
 40.         bysort udca: egen total_follow_up = total(_t) if number==1
 41.         su total_follow_up if udca==0 & number==1
 42.         local person_mth = r(mean)/30
 43.         di `person_mth'
 44.         local rate = 100000*(`event'/`person_mth')
 45.         di `rate'
 46.         if `event'>10 & `event'!=. {
 47.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 48.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 49.             }
 50.         else {
 51.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 52.             continue
 53.         }
 54.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 55.         tab exposed_ever if number==1
 56.         qui safecount if exposed_ever==1 & number==1
 57.         local denominator = r(N)
 58.         qui safecount if udca == 1 & `outcome'_flag == 1
 59.         local event = r(N)
 60.         di "udca events = " `event'
 61.         qui su total_follow_up if udca==1 & number==1
 62.         local person_mth = r(mean)/30
 63.         local rate = 100000*(`event'/`person_mth')
 64.         if `event'>10 & `event'!=. {
 65.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 66.             cap estimates use "./output/tempdata/crude_`outcome'" 
 67.             cap lincom udca, eform
 68.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 69.             cap estimates clear
 70.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 71.             cap lincom udca, eform
 72.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 73.             cap estimates clear
 74.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 75.             cap lincom udca, eform
 76.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 77.             cap estimates clear
 78.         }
 79.         else {
 80.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 81.             continue
 82.         }
 83.     
. drop total_follow_up
 84.     }
 85. else { 
 86.     file write tablecontent ("`outcome'") _tab ("redact") _n
 87.     continue
 88. }
 89. 
. }

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         2,927                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1,443 observations deleted)

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,484  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,484  observations remaining, representing
        500  subjects
         78  failures in single-failure-per-subject data
    331,129  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  78

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_oca_died_covid_any.svg not found)
(file ./output/graphs/km_oca_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -154.24871
Iteration 1:   log pseudolikelihood = -153.62262
Iteration 2:   log pseudolikelihood = -153.55095
Iteration 3:   log pseudolikelihood = -153.55071
Refining estimates:
Iteration 0:   log pseudolikelihood = -153.55071

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         724
No. of failures      =           78
Time at risk         =       331129
                                                Wald chi2(1)     =        1.69
Log pseudolikelihood =   -153.55071             Prob > chi2      =      0.1933

                           (Std. Err. adjusted for 245 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.847567   .8717936     1.30   0.193     .7327431    4.658525
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_oca_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_oca_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.06464         0.16        1         0.6933
      ------------+---------------------------------------------------
      global test |                      0.16        1         0.6933
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -153.84809
Iteration 1:   log pseudolikelihood = -152.06528
Iteration 2:   log pseudolikelihood = -152.00698
Iteration 3:   log pseudolikelihood = -152.00682
Refining estimates:
Iteration 0:   log pseudolikelihood = -152.00682

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         717
No. of failures      =           78
Time at risk         =       328272
                                                Wald chi2(3)     =        4.02
Log pseudolikelihood =   -152.00682             Prob > chi2      =      0.2588

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.704803   .8177203     1.11   0.266     .6658702    4.364744
      age_tv |   .9916926    .006485    -1.28   0.202     .9790633    1.004485
        male |   1.253658   .4081136     0.69   0.487     .6623392    2.372891
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_oca_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_oca_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.08726         0.30        1         0.5820
      age_tv      |     -0.28561         3.20        1         0.0737
      male        |      0.05905         0.13        1         0.7135
      ------------+---------------------------------------------------
      global test |                      3.59        3         0.3098
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -153.84809
Iteration 1:   log pseudolikelihood = -147.44958
Iteration 2:   log pseudolikelihood = -147.05033
Iteration 3:   log pseudolikelihood = -147.04427
Iteration 4:   log pseudolikelihood = -147.04426
Refining estimates:
Iteration 0:   log pseudolikelihood = -147.04426

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         717
No. of failures      =           78
Time at risk         =       328272
                                                Wald chi2(19)    =       18.72
Log pseudolikelihood =   -147.04426             Prob > chi2      =      0.4752

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.044808   1.183907     1.24   0.217     .6573886    6.360376
      age_tv |   .9932262   .0066462    -1.02   0.310     .9802848    1.006338
        male |   1.340797   .4604413     0.85   0.393     .6839953    2.628288
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.436371   .7811272     0.67   0.505     .4947275    4.170297
    Unknown  |   2.032545   1.393606     1.03   0.301     .5301732    7.792247
             |
         imd |
          2  |   1.268726   .6476535     0.47   0.641     .4664986    3.450526
          3  |   1.081046   .5539185     0.15   0.879     .3960007    2.951157
          4  |   .6553011   .3868359    -0.72   0.474     .2060447    2.084109
          5  |   .8813331   .5634902    -0.20   0.843     .2517184    3.085782
          6  |   2.781406   2.160306     1.32   0.188     .6069317    12.74644
             |
     bmi_cat |
Underweight  |    .589243   .4347574    -0.72   0.473     .1387579    2.502252
 Overweight  |   .5721928   .3139384    -1.02   0.309     .1952196    1.677109
      Obese  |   .9459721   .3684661    -0.14   0.887      .440886    2.029693
Morbidly ..  |   .8619897    .540327    -0.24   0.813     .2523118    2.944873
             |
     smoking |
Current s..  |   .7490451   .3159663    -0.69   0.493     .3276796    1.712247
  Ex-smoker  |   .5327838    .354812    -0.95   0.344     .1444395    1.965242
             |
severe_dis~e |   1.992521   .8162438     1.68   0.092      .892699    4.447346
covid_vacc~t |    .728646   .3596877    -0.64   0.521     .2769049    1.917355
 liver_trans |   1.415432   1.239997     0.40   0.692     .2542082    7.881134
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_oca_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_oca_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.06290         0.37        1         0.5441
      age_tv      |     -0.23444         3.73        1         0.0533
      male        |      0.12682         1.27        1         0.2593
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.05610         0.29        1         0.5932
      2.eth_bin   |      0.24090         3.70        1         0.0543
      1b.imd      |            .            .        1             .
      2.imd       |      0.12624         1.09        1         0.2961
      3.imd       |      0.03814         0.07        1         0.7982
      4.imd       |      0.00187         0.00        1         0.9875
      5.imd       |     -0.10134         0.73        1         0.3934
      6.imd       |      0.07007         0.30        1         0.5831
      1.bmi_cat   |     -0.24243         5.34        1         0.0209
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.42484        11.00        1         0.0009
      4.bmi_cat   |     -0.26397         3.89        1         0.0486
      5.bmi_cat   |      0.19482         1.92        1         0.1660
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.15665         1.53        1         0.2159
      2.smoking   |     -0.09384         0.76        1         0.3841
      severe_dis~e|     -0.15155         2.05        1         0.1522
      covid_vacc~t|     -0.16454         1.90        1         0.1686
      liver_trans |      0.04678         0.16        1         0.6927
      ------------+---------------------------------------------------
      global test |                     27.49       19         0.0938
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_oca_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_oca_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -153.84809
Iteration 1:   log pseudolikelihood = -146.36347
Iteration 2:   log pseudolikelihood = -145.73816
Iteration 3:   log pseudolikelihood = -145.72051
Iteration 4:   log pseudolikelihood = -145.72042
Iteration 5:   log pseudolikelihood = -145.72042
Refining estimates:
Iteration 0:   log pseudolikelihood = -145.72042

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         717
No. of failures      =           78
Time at risk         =       328272
                                                Wald chi2(22)    =       32.93
Log pseudolikelihood =   -145.72042             Prob > chi2      =      0.0628

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   3.132658    2.13899     1.67   0.094     .8216927    11.94308
      age_tv |   .9924502   .0068026    -1.11   0.269     .9792066    1.005873
        male |   1.353187   .4710788     0.87   0.385     .6839636    2.677212
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.644062   1.072157     0.76   0.446     .4579483    5.902279
      Asian  |   1.540191   .9719123     0.68   0.494     .4471343    5.305317
      Black  |   .7618319   .5449685    -0.38   0.704     .1874826    3.095689
      Other  |   1.806648   1.088365     0.98   0.326     .5547417    5.883779
    Unknown  |   1.813389   1.205305     0.90   0.371     .4928596    6.672044
             |
         imd |
          2  |   1.266584   .6613907     0.45   0.651     .4551449    3.524669
          3  |    1.13204   .6132071     0.23   0.819     .3915433    3.272981
          4  |   .6152039    .377148    -0.79   0.428     .1850094    2.045711
          5  |   .7947093   .5356558    -0.34   0.733      .212068    2.978115
          6  |   2.356188   1.992816     1.01   0.311     .4490361    12.36342
             |
     bmi_cat |
Underweight  |     .51086   .4115101    -0.83   0.404     .1053509    2.477225
 Overweight  |   .6176827   .3651117    -0.82   0.415     .1939193    1.967478
      Obese  |   1.020257   .4276208     0.05   0.962     .4486886    2.319926
Morbidly ..  |   .9415141   .6168705    -0.09   0.927     .2606923    3.400364
             |
     smoking |
Current s..  |   .7148285   .2984843    -0.80   0.421      .315336     1.62043
  Ex-smoker  |   .5288991   .3597836    -0.94   0.349     .1394257    2.006332
             |
severe_dis~e |   2.005374   .8076615     1.73   0.084     .9106996    4.415863
covid_vacc~t |   .7410929   .3568211    -0.62   0.534     .2884274    1.904184
 liver_trans |   .7434015   .6885123    -0.32   0.749     .1210237    4.566425
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        984       66.31       66.31
          1 |        500       33.69      100.00
------------+-----------------------------------
      Total |      1,484      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  68
no udca events = 68
(984 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        458      300390           0     300390     300390
10013
679.11715

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        458       91.60       91.60
          1 |         42        8.40      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 10

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,866                          
 vars:            23                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1,413 observations deleted)

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,453  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,453  observations remaining, representing
        500  subjects
         22  failures in single-failure-per-subject data
    321,686  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  22

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_oca_hosp_any.svg not found)
(file ./output/graphs/km_oca_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -41.834179
Iteration 1:   log pseudolikelihood = -41.737079
Iteration 2:   log pseudolikelihood =   -41.7289
Iteration 3:   log pseudolikelihood =  -41.72888
Refining estimates:
Iteration 0:   log pseudolikelihood =  -41.72888

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         708
No. of failures      =           22
Time at risk         =       321686
                                                Wald chi2(1)     =        0.28
Log pseudolikelihood =    -41.72888             Prob > chi2      =      0.5941

                           (Std. Err. adjusted for 245 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.679721    1.63464     0.53   0.594     .2493911    11.31341
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_oca_hosp_any.dta not found)
file ./output/tempdata/surv_crude_oca_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.26692         0.57        1         0.4489
      ------------+---------------------------------------------------
      global test |                      0.57        1         0.4489
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -41.666075
Iteration 1:   log pseudolikelihood = -41.510199
Iteration 2:   log pseudolikelihood = -41.503287
Iteration 3:   log pseudolikelihood = -41.503272
Refining estimates:
Iteration 0:   log pseudolikelihood = -41.503272

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         701
No. of failures      =           22
Time at risk         =       318829
                                                Wald chi2(3)     =        0.32
Log pseudolikelihood =   -41.503272             Prob > chi2      =      0.9566

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.642345   1.618454     0.50   0.615     .2380376     11.3314
      age_tv |   .9960872   .0124098    -0.31   0.753     .9720589    1.020709
        male |   .8529586   .5548643    -0.24   0.807     .2383453    3.052455
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_oca_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_oca_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.36945         1.89        1         0.1696
      age_tv      |     -0.14592         0.20        1         0.6536
      male        |     -0.43171         2.78        1         0.0956
      ------------+---------------------------------------------------
      global test |                      3.28        3         0.3511
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -41.666075
Iteration 1:   log pseudolikelihood =  -37.78769
Iteration 2:   log pseudolikelihood = -34.238537
Iteration 3:   log pseudolikelihood = -33.853873
Iteration 4:   log pseudolikelihood = -33.738275
Iteration 5:   log pseudolikelihood = -33.696751
Iteration 6:   log pseudolikelihood = -33.681575
Iteration 7:   log pseudolikelihood = -33.676005
Iteration 8:   log pseudolikelihood = -33.673958
Iteration 9:   log pseudolikelihood = -33.673205
Iteration 10:  log pseudolikelihood = -33.672928
Iteration 11:  log pseudolikelihood = -33.672826
Iteration 12:  log pseudolikelihood = -33.672788
Iteration 13:  log pseudolikelihood = -33.672775
Iteration 14:  log pseudolikelihood =  -33.67277
Iteration 15:  log pseudolikelihood = -33.672768
Iteration 16:  log pseudolikelihood = -33.672767
Iteration 17:  log pseudolikelihood = -33.672767
Iteration 18:  log pseudolikelihood = -33.672767
Iteration 19:  log pseudolikelihood = -33.672767
Iteration 20:  log pseudolikelihood = -33.672767
Iteration 21:  log pseudolikelihood = -33.672767
Iteration 22:  log pseudolikelihood = -33.672767
Iteration 23:  log pseudolikelihood = -33.672767
Iteration 24:  log pseudolikelihood = -33.672767
Iteration 25:  log pseudolikelihood = -33.672767
Iteration 26:  log pseudolikelihood = -33.672767
Iteration 27:  log pseudolikelihood = -33.672767
Iteration 28:  log pseudolikelihood = -33.672767
Iteration 29:  log pseudolikelihood = -33.672767
Iteration 30:  log pseudolikelihood = -33.672767
Iteration 31:  log pseudolikelihood = -33.672767
Iteration 32:  log pseudolikelihood = -33.672767
Iteration 33:  log pseudolikelihood = -33.672767
Iteration 34:  log pseudolikelihood = -33.672767
Iteration 35:  log pseudolikelihood = -33.672767
Iteration 36:  log pseudolikelihood = -33.672767
Refining estimates:
Iteration 0:   log pseudolikelihood = -33.672767
Iteration 1:   log pseudolikelihood = -33.672767
Iteration 2:   log pseudolikelihood = -33.672767
Iteration 3:   log pseudolikelihood = -33.672767

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         701
No. of failures      =           22
Time at risk         =       318829
                                                Wald chi2(19)    =     9706.87
Log pseudolikelihood =   -33.672767             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7513893    .633823    -0.34   0.735     .1438291    3.925392
      age_tv |   .9881079   .0147502    -0.80   0.423     .9596167    1.017445
        male |   1.114489   .8497329     0.14   0.887     .2500833    4.966693
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .4102847   .3376357    -1.08   0.279     .0817722    2.058566
    Unknown  |   3.63e-18   3.22e-18   -45.29   0.000     6.39e-19    2.07e-17
             |
         imd |
          2  |   4.614924   5.356737     1.32   0.188     .4743939    44.89418
          3  |   1.914067   2.659516     0.47   0.640     .1256747    29.15186
          4  |   2.97e-17   3.60e-17   -31.44   0.000     2.77e-18    3.19e-16
          5  |   5.466191   5.722288     1.62   0.105     .7024309    42.53692
          6  |   2.03e-17   2.05e-17   -38.00   0.000     2.79e-18    1.47e-16
             |
     bmi_cat |
Underweight  |   1.881993   2.041042     0.58   0.560     .2246368    15.76722
 Overweight  |   .7659823   .8428436    -0.24   0.809     .0886349    6.619615
      Obese  |   2.016351   1.709286     0.83   0.408     .3828177    10.62038
Morbidly ..  |   1.290842   1.112215     0.30   0.767     .2384849    6.986911
             |
     smoking |
Current s..  |   5.072672   6.879815     1.20   0.231     .3554629    72.39014
  Ex-smoker  |   2.253994    3.35987     0.55   0.586     .1213743    41.85804
             |
severe_dis~e |   .4184084    .261941    -1.39   0.164     .1226628     1.42721
covid_vacc~t |   .2814214   .2595192    -1.37   0.169     .0461745     1.71519
 liver_trans |   17.38731    28.4121     1.75   0.081     .7068203    427.7164
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_oca_hosp_any.dta not found)
file ./output/tempdata/surv_adj_oca_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.37688         1.56        1         0.2119
      age_tv      |     -0.23735         2.55        1         0.1103
      male        |     -0.21100         2.43        1         0.1188
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.07581         0.34        1         0.5579
      2.eth_bin   |     -0.05604         0.08        1         0.7833
      1b.imd      |            .            .        1             .
      2.imd       |     -0.23571         2.49        1         0.1146
      3.imd       |     -0.44237         8.33        1         0.0039
      4.imd       |     -0.21586         1.43        1         0.2322
      5.imd       |     -0.36593         2.93        1         0.0871
      6.imd       |     -0.30380         1.97        1         0.1600
      1.bmi_cat   |     -0.13623         0.42        1         0.5155
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.26167         2.23        1         0.1356
      4.bmi_cat   |     -0.32666         5.78        1         0.0162
      5.bmi_cat   |      0.20490         1.29        1         0.2551
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.35382         4.54        1         0.0331
      2.smoking   |     -0.24681         2.15        1         0.1425
      severe_dis~e|     -0.07666         0.13        1         0.7225
      covid_vacc~t|     -0.11233         0.37        1         0.5439
      liver_trans |     -0.05665         0.08        1         0.7812
      ------------+---------------------------------------------------
      global test |                     16.32       19         0.6360
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_oca_hosp_any.svg not found)
(file ./output/graphs/schoenplot_oca_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -41.666075
Iteration 1:   log pseudolikelihood = -36.107351
Iteration 2:   log pseudolikelihood = -32.171341
Iteration 3:   log pseudolikelihood = -31.722818
Iteration 4:   log pseudolikelihood = -31.605478
Iteration 5:   log pseudolikelihood = -31.564752
Iteration 6:   log pseudolikelihood = -31.549875
Iteration 7:   log pseudolikelihood = -31.544415
Iteration 8:   log pseudolikelihood = -31.542408
Iteration 9:   log pseudolikelihood =  -31.54167
Iteration 10:  log pseudolikelihood = -31.541398
Iteration 11:  log pseudolikelihood = -31.541299
Iteration 12:  log pseudolikelihood = -31.541262
Iteration 13:  log pseudolikelihood = -31.541248
Iteration 14:  log pseudolikelihood = -31.541243
Iteration 15:  log pseudolikelihood = -31.541242
Iteration 16:  log pseudolikelihood = -31.541241
Iteration 17:  log pseudolikelihood = -31.541241
Iteration 18:  log pseudolikelihood =  -31.54124
Iteration 19:  log pseudolikelihood =  -31.54124
Iteration 20:  log pseudolikelihood =  -31.54124
Iteration 21:  log pseudolikelihood =  -31.54124
Iteration 22:  log pseudolikelihood =  -31.54124
Iteration 23:  log pseudolikelihood =  -31.54124
Iteration 24:  log pseudolikelihood =  -31.54124
Iteration 25:  log pseudolikelihood =  -31.54124
Iteration 26:  log pseudolikelihood =  -31.54124
Iteration 27:  log pseudolikelihood =  -31.54124
Iteration 28:  log pseudolikelihood =  -31.54124
Iteration 29:  log pseudolikelihood =  -31.54124
Iteration 30:  log pseudolikelihood =  -31.54124
Iteration 31:  log pseudolikelihood =  -31.54124
Iteration 32:  log pseudolikelihood =  -31.54124
Iteration 33:  log pseudolikelihood =  -31.54124
Iteration 34:  log pseudolikelihood =  -31.54124
Iteration 35:  log pseudolikelihood =  -31.54124
Iteration 36:  log pseudolikelihood =  -31.54124
Iteration 37:  log pseudolikelihood =  -31.54124
Iteration 38:  log pseudolikelihood =  -31.54124
Iteration 39:  log pseudolikelihood =  -31.54124
Iteration 40:  log pseudolikelihood =  -31.54124
Iteration 41:  log pseudolikelihood =  -31.54124
Iteration 42:  log pseudolikelihood =  -31.54124
Iteration 43:  log pseudolikelihood =  -31.54124
Iteration 44:  log pseudolikelihood =  -31.54124
Iteration 45:  log pseudolikelihood =  -31.54124
Refining estimates:
Iteration 0:   log pseudolikelihood =  -31.54124

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         701
No. of failures      =           22
Time at risk         =       318829
                                                Wald chi2(19)    =       43.88
Log pseudolikelihood =    -31.54124             Prob > chi2      =      0.0010

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.259362   1.525824     0.19   0.849     .1171782    13.53487
      age_tv |   .9906505   .0167527    -0.56   0.579      .958354    1.024035
        male |   1.155604   .7860926     0.21   0.832     .3046381    4.383628
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .4552923   .5168845    -0.69   0.488     .0491969    4.213499
      Asian  |   1.266964   1.413716     0.21   0.832     .1422224    11.28652
      Black  |   .1967195   .2508226    -1.28   0.202     .0161638    2.394153
      Other  |   .1149708   .1148803    -2.16   0.030     .0162202     .814928
    Unknown  |   2.35e-20          .        .       .            .           .
             |
         imd |
          2  |   5.461795   5.400697     1.72   0.086     .7864221    37.93281
          3  |   1.782695   2.959432     0.35   0.728     .0688664    46.14738
          4  |   6.30e-20          .        .       .            .           .
          5  |   5.373888   5.303854     1.70   0.088     .7765693     37.1875
          6  |   1.51e-19          .        .       .            .           .
             |
     bmi_cat |
Underweight  |   .9404721   1.169538    -0.05   0.961     .0821905    10.76144
 Overweight  |   .5343032   .6884088    -0.49   0.627     .0427641    6.675684
      Obese  |   1.524039   1.140936     0.56   0.574     .3513695    6.610408
Morbidly ..  |   .9482617   1.085122    -0.05   0.963     .1006642     8.93267
             |
     smoking |
Current s..  |   6.569593   11.06607     1.12   0.264     .2419594    178.3752
  Ex-smoker  |   2.775796   4.651794     0.61   0.542     .1039701    74.10824
             |
severe_dis~e |   .3536225   .2367794    -1.55   0.121     .0951898    1.313679
covid_vacc~t |   .2066222   .1735443    -1.88   0.060      .039833    1.071793
 liver_trans |   25.30856     49.904     1.64   0.101     .5306996    1206.941
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        953       65.59       65.59
          1 |        500       34.41      100.00
------------+-----------------------------------
      Total |      1,453      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  21
no udca events = 21
(953 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        458      291268           0     291268     291268
9708.9333
216.29565

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        458       91.60       91.60
          1 |         42        8.40      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = .

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,866                          
 vars:            22                          13 Oct 2023 13:56
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
died_liver_any  float   %9.0g                 
died_liver_un~g float   %9.0g                 
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1,413 observations deleted)

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,453  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,453  observations remaining, representing
        500  subjects
         94  failures in single-failure-per-subject data
    321,686  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  94

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_oca_composite_any.svg not found)
(file ./output/graphs/km_oca_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -187.75714
Iteration 1:   log pseudolikelihood = -187.37339
Iteration 2:   log pseudolikelihood = -187.35252
Iteration 3:   log pseudolikelihood = -187.35249
Refining estimates:
Iteration 0:   log pseudolikelihood = -187.35249

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         708
No. of failures      =           94
Time at risk         =       321686
                                                Wald chi2(1)     =        0.90
Log pseudolikelihood =   -187.35249             Prob > chi2      =      0.3429

                           (Std. Err. adjusted for 245 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.573811    .752581     0.95   0.343      .616476    4.017804
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_oca_composite_any.dta not found)
file ./output/tempdata/surv_crude_oca_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.09143         0.39        1         0.5306
      ------------+---------------------------------------------------
      global test |                      0.39        1         0.5306
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -187.19522
Iteration 1:   log pseudolikelihood = -185.88494
Iteration 2:   log pseudolikelihood = -185.86889
Iteration 3:   log pseudolikelihood = -185.86888
Refining estimates:
Iteration 0:   log pseudolikelihood = -185.86888

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         701
No. of failures      =           94
Time at risk         =       318829
                                                Wald chi2(3)     =        2.72
Log pseudolikelihood =   -185.86888             Prob > chi2      =      0.4362

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.471081   .7181513     0.79   0.429     .5650636    3.829795
      age_tv |    .992852   .0058967    -1.21   0.227     .9813617    1.004477
        male |   1.158624   .3430901     0.50   0.619     .6484642    2.070137
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_oca_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_oca_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.09383         0.45        1         0.5030
      age_tv      |     -0.25961         3.22        1         0.0726
      male        |     -0.00409         0.00        1         0.9776
      ------------+---------------------------------------------------
      global test |                      3.63        3         0.3044
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -187.19522
Iteration 1:   log pseudolikelihood = -181.28406
Iteration 2:   log pseudolikelihood = -180.85777
Iteration 3:   log pseudolikelihood = -180.84371
Iteration 4:   log pseudolikelihood = -180.84365
Refining estimates:
Iteration 0:   log pseudolikelihood = -180.84365

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         701
No. of failures      =           94
Time at risk         =       318829
                                                Wald chi2(19)    =       14.49
Log pseudolikelihood =   -180.84365             Prob > chi2      =      0.7543

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.554218   .8721815     0.79   0.432     .5174196    4.668542
      age_tv |   .9925108   .0061897    -1.21   0.228     .9804532    1.004717
        male |   1.236847   .3890256     0.68   0.499     .6677092    2.291102
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.221663   .5955796     0.41   0.681     .4698696    3.176328
    Unknown  |   1.104132    .721597     0.15   0.880     .3067077    3.974818
             |
         imd |
          2  |   1.391147   .6380714     0.72   0.472     .5661816    3.418141
          3  |   1.129884   .5365811     0.26   0.797     .4454496    2.865951
          4  |    .554408   .3146567    -1.04   0.299     .1822746    1.686292
          5  |   1.281866   .6847598     0.46   0.642     .4499241    3.652127
          6  |   1.851222   1.330514     0.86   0.392     .4525648    7.572443
             |
     bmi_cat |
Underweight  |   .7799761   .5183862    -0.37   0.708     .2120105    2.869493
 Overweight  |   .6317037   .3191961    -0.91   0.363     .2346423    1.700672
      Obese  |   1.152067   .4198147     0.39   0.698      .564026    2.353189
Morbidly ..  |    .913658   .4730651    -0.17   0.862     .3311743    2.520639
             |
     smoking |
Current s..  |   .8675696   .3398287    -0.36   0.717     .4026123    1.869483
  Ex-smoker  |   .5840014   .3524785    -0.89   0.373     .1789224    1.906177
             |
severe_dis~e |   1.486496   .5219676     1.13   0.259     .7469189    2.958383
covid_vacc~t |   .5210816   .2384465    -1.42   0.154     .2125185    1.277659
 liver_trans |   1.910515   1.968994     0.63   0.530     .2534511    14.40146
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_oca_composite_any.dta not found)
file ./output/tempdata/surv_adj_oca_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.01717         0.04        1         0.8513
      age_tv      |     -0.26692         5.77        1         0.0163
      male        |     -0.09922         0.74        1         0.3896
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.13047         1.43        1         0.2321
      2.eth_bin   |      0.34949         7.68        1         0.0056
      1b.imd      |            .            .        1             .
      2.imd       |      0.05025         0.15        1         0.6940
      3.imd       |     -0.11015         0.71        1         0.3988
      4.imd       |     -0.04001         0.15        1         0.7013
      5.imd       |     -0.09131         0.61        1         0.4352
      6.imd       |      0.04993         0.15        1         0.6950
      1.bmi_cat   |     -0.27866         8.79        1         0.0030
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.50291        17.55        1         0.0000
      4.bmi_cat   |     -0.29816         6.36        1         0.0117
      5.bmi_cat   |      0.13452         0.82        1         0.3666
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.23267         3.67        1         0.0555
      2.smoking   |     -0.14138         1.66        1         0.1978
      severe_dis~e|     -0.10233         0.94        1         0.3331
      covid_vacc~t|     -0.17784         2.19        1         0.1390
      liver_trans |      0.06184         0.20        1         0.6554
      ------------+---------------------------------------------------
      global test |                     36.54       19         0.0091
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_oca_composite_any.svg not found)
(file ./output/graphs/schoenplot_oca_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -187.19522
Iteration 1:   log pseudolikelihood = -179.20326
Iteration 2:   log pseudolikelihood = -178.58591
Iteration 3:   log pseudolikelihood = -178.56572
Iteration 4:   log pseudolikelihood =  -178.5656
Iteration 5:   log pseudolikelihood =  -178.5656
Refining estimates:
Iteration 0:   log pseudolikelihood =  -178.5656

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         701
No. of failures      =           94
Time at risk         =       318829
                                                Wald chi2(22)    =       26.86
Log pseudolikelihood =    -178.5656             Prob > chi2      =      0.2165

                           (Std. Err. adjusted for 242 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.475745   1.575465     1.42   0.154     .7112713    8.617405
      age_tv |   .9921269    .006355    -1.23   0.217     .9797491    1.004661
        male |   1.238282   .3886146     0.68   0.496     .6693974    2.290632
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.332255   .7522444     0.51   0.611     .4405191    4.029116
      Asian  |   1.827505    1.03517     1.06   0.287     .6021502    5.546411
      Black  |   .6025768   .3813039    -0.80   0.423     .1743338    2.082779
      Other  |   1.215816   .6916691     0.34   0.731     .3986805     3.70775
    Unknown  |   .9767254   .6231682    -0.04   0.971     .2796989    3.410784
             |
         imd |
          2  |   1.299727   .5859361     0.58   0.561     .5371777    3.144752
          3  |   1.028707   .5225454     0.06   0.956     .3801131     2.78401
          4  |   .4678185    .269775    -1.32   0.188      .151084     1.44856
          5  |   1.072007   .5797356     0.13   0.898     .3714262    3.094018
          6  |   1.503615   1.148867     0.53   0.593     .3363251    6.722243
             |
     bmi_cat |
Underweight  |   .6816538   .4920709    -0.53   0.595     .1656152    2.805612
 Overweight  |   .6569636   .3538466    -0.78   0.435     .2286001    1.888019
      Obese  |   1.177373   .4467771     0.43   0.667     .5596405     2.47696
Morbidly ..  |   .9730294    .537169    -0.05   0.961     .3297715    2.871037
             |
     smoking |
Current s..  |   .7922898    .308154    -0.60   0.549     .3696722    1.698053
  Ex-smoker  |   .5367064   .3193129    -1.05   0.296     .1672304    1.722496
             |
severe_dis~e |   1.506787   .5222985     1.18   0.237      .763835     2.97238
covid_vacc~t |   .5118085   .2306283    -1.49   0.137     .2116137    1.237859
 liver_trans |   1.381076   1.284457     0.35   0.728     .2231337    8.548106
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        953       65.59       65.59
          1 |        500       34.41      100.00
------------+-----------------------------------
      Total |      1,453      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  84
no udca events = 84
(953 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        458      291268           0     291268     291268
9708.9333
865.18258

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        458       91.60       91.60
          1 |         42        8.40      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 10

. 
. * sensitivity analysis - explore vaccinations  
. file write tablecontent _n ("vaccinations sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_wks") _tab ("Rate") _tab ("unadj_hr"
> ) _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome'_vacc, clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2021", "DMY")
  5.         * Flag records where outcome or end_date prior to 1st March 2021
.     bys patient_id: egen end_date = max(stop) 
  6.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  7.     count if `outcome'_flag==1
  8.     if r(N) > 10 {
  9.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
 10.         graph export ./output/graphs/km_vacc_`outcome'.svg, as(svg) replac
> e
 11.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 12.         estimates save "./output/tempdata/crude_`outcome'", replace 
 13.         eststo model7
 14.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_vacc_`outcome'", replace) idstr("crude_`outcome'") 
 15.         estat phtest, detail
 16.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_vacc_`outcome') ///
>                     note("")
 17.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 18.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 19.         eststo model8
 20.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_vacc_`outcome'", replace) idstr("adj_`outcome'") 
 21.         estat phtest, detail
 22.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease i.vacc_count_tv liver_trans ib5.time_vacc_cat,
>  strata(stp) vce(robust)
 23.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 24.         eststo model9
 25.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_vacc_`outcome'", replace) idstr("adj_`outcome'") 
 26.         estat phtest, detail
 27.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_vacc_`outcome') ///
>                     note("")
 28.         graph combine uni_plot_vacc_`outcome' adj_plot_vacc_`outcome'
 29.         graph export ./output/graphs/schoenplot_vacc_`outcome'.svg, as(svg
> ) replace 
 30.         * Cox model - fully adjusted with categorical ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease i.vacc_count_tv liver_trans ib5.time_vacc_ca
> t, strata(stp) vce(robust)
 31.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 32.         tab number 
 33.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 34.         tab unexposed_ever if number==1
 35.         safecount if unexposed_ever==0 & number==1
 36.         local denominator = r(N)
 37.         safecount if udca == 0 & `outcome'_flag == 1 
 38.         local event = r(N)
 39.         di "no udca events = " `event'
 40.         bysort udca: egen total_follow_up = total(_t) if number==1 
 41.         su total_follow_up if udca==0 & number==1 
 42.         local person_mth = r(mean)/30
 43.         di `person_mth'
 44.         local rate = 100000*(`event'/`person_mth')
 45.         di `rate'
 46.         if `event'>10 & `event'!=. {
 47.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 48.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 49.             }
 50.         else {
 51.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 52.             continue
 53.         }
 54.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 55.         tab exposed_ever if number==1
 56.         qui safecount if exposed_ever==1 & number==1
 57.         local denominator = r(N)
 58.         qui safecount if udca == 1 & `outcome'_flag == 1 
 59.         local event = r(N)
 60.         di "udca events = " `event'
 61.         qui su total_follow_up if udca==1 & number==1 
 62.         local person_mth = r(mean)/30
 63.         local rate = 100000*(`event'/`person_mth')
 64.         if `event'>10 & `event'!=. {
 65.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 66.             cap estimates use "./output/tempdata/crude_`outcome'" 
 67.             cap lincom udca, eform
 68.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 69.             cap estimates clear
 70.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 71.             cap lincom udca, eform
 72.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 73.             cap estimates clear
 74.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 75.             cap lincom udca, eform
 76.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 77.             cap estimates clear
 78.         }
 79.         else {
 80.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 81.             continue
 82.         }
 83.     
. drop total_follow_up
 84.     }
 85. else { 
 86.     file write tablecontent ("`outcome'") _tab ("redact") _n
 87.     continue
 88. }
 89. 
. }

Contains data from ./output/an_dataset_died_covid_any_vacc.dta
  obs:         2,651                          
 vars:            21                          13 Oct 2023 13:57
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
vacc_count_tv   float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,651  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,651  observations remaining, representing
      1,000  subjects
        118  failures in single-failure-per-subject data
    485,349  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       670
  118

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_vacc_died_covid_any.svg not found)
(file ./output/graphs/km_vacc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -294.60522
Iteration 1:   log pseudolikelihood = -294.58337
Iteration 2:   log pseudolikelihood = -294.58334
Refining estimates:
Iteration 0:   log pseudolikelihood = -294.58334

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,311
No. of failures      =          118
Time at risk         =       485349
                                                Wald chi2(1)     =        0.04
Log pseudolikelihood =   -294.58334             Prob > chi2      =      0.8354

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9080364   .4215351    -0.21   0.835     .3655548    2.255558
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_vacc_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_vacc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.11017         0.74        1         0.3893
      ------------+---------------------------------------------------
      global test |                      0.74        1         0.3893
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -289.98287
Iteration 1:   log pseudolikelihood = -289.55781
Iteration 2:   log pseudolikelihood = -289.55779
Refining estimates:
Iteration 0:   log pseudolikelihood = -289.55779

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,294
No. of failures      =          116
Time at risk         =       478236
                                                Wald chi2(3)     =        0.78
Log pseudolikelihood =   -289.55779             Prob > chi2      =      0.8544

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9096809   .4199647    -0.21   0.838     .3680629     2.24831
      age_tv |   1.004283   .0056083     0.77   0.444     .9933509    1.015335
        male |   .8896742   .2334378    -0.45   0.656     .5319709    1.487901
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_vacc_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_vacc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.11519         0.80        1         0.3719
      age_tv      |      0.06857         0.33        1         0.5641
      male        |      0.19960         2.54        1         0.1113
      ------------+---------------------------------------------------
      global test |                      3.97        3         0.2651
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -289.98287
Iteration 1:   log pseudolikelihood = -281.43869
Iteration 2:   log pseudolikelihood = -280.86122
Iteration 3:   log pseudolikelihood = -280.80328
Iteration 4:   log pseudolikelihood = -280.78836
Iteration 5:   log pseudolikelihood =  -280.7829
Iteration 6:   log pseudolikelihood = -280.78089
Iteration 7:   log pseudolikelihood = -280.78015
Iteration 8:   log pseudolikelihood = -280.77988
Iteration 9:   log pseudolikelihood = -280.77978
Iteration 10:  log pseudolikelihood = -280.77975
Iteration 11:  log pseudolikelihood = -280.77973
Iteration 12:  log pseudolikelihood = -280.77973
Iteration 13:  log pseudolikelihood = -280.77973
Iteration 14:  log pseudolikelihood = -280.77972
Iteration 15:  log pseudolikelihood = -280.77972
Iteration 16:  log pseudolikelihood = -280.77972
Iteration 17:  log pseudolikelihood = -280.77972
Iteration 18:  log pseudolikelihood = -280.77972
Iteration 19:  log pseudolikelihood = -280.77972
Iteration 20:  log pseudolikelihood = -280.77972
Iteration 21:  log pseudolikelihood = -280.77972
Iteration 22:  log pseudolikelihood = -280.77972
Iteration 23:  log pseudolikelihood = -280.77972
Iteration 24:  log pseudolikelihood = -280.77972
Iteration 25:  log pseudolikelihood = -280.77972
Iteration 26:  log pseudolikelihood = -280.77972
Iteration 27:  log pseudolikelihood = -280.77972
Iteration 28:  log pseudolikelihood = -280.77972
Iteration 29:  log pseudolikelihood = -280.77972
Iteration 30:  log pseudolikelihood = -280.77972
Iteration 31:  log pseudolikelihood = -280.77972
Iteration 32:  log pseudolikelihood = -280.77972
Iteration 33:  log pseudolikelihood = -280.77972
Iteration 34:  log pseudolikelihood = -280.77972
Iteration 35:  log pseudolikelihood = -280.77972
Iteration 36:  log pseudolikelihood = -280.77972
Iteration 37:  log pseudolikelihood = -280.77972
Refining estimates:
Iteration 0:   log pseudolikelihood = -280.77972
Iteration 1:   log pseudolikelihood = -280.77972

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,294
No. of failures      =          116
Time at risk         =       478236
                                                Wald chi2(25)    =     6179.39
Log pseudolikelihood =   -280.77972             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8175683   .3756913    -0.44   0.661     .3321831    2.012197
      age_tv |    1.00581   .0060669     0.96   0.337     .9939895    1.017772
        male |   .8306295   .2261176    -0.68   0.495     .4871802    1.416202
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.642363   .7615627     1.07   0.285     .6618618    4.075405
    Unknown  |   1.047154   .8979378     0.05   0.957     .1950307    5.622357
             |
         imd |
          2  |   .6798947   .3040169    -0.86   0.388     .2830247    1.633274
          3  |   .5333487   .2255133    -1.49   0.137     .2328637    1.221577
          4  |   .6940348   .2671347    -0.95   0.343     .3264021    1.475739
          5  |   .6598252   .2840915    -0.97   0.334     .2837522    1.534329
          6  |   .5935833   .5049156    -0.61   0.540     .1120547    3.144367
             |
     bmi_cat |
Underweight  |   1.416154   .6325866     0.78   0.436     .5900442    3.398886
 Overweight  |   .8176744   .2950044    -0.56   0.577     .4031624    1.658368
      Obese  |   .6699493   .2392274    -1.12   0.262     .3327304    1.348936
Morbidly ..  |   .2518307   .2653977    -1.31   0.191      .031919     1.98686
             |
     smoking |
Current s..  |   4.481507   4.582775     1.47   0.142     .6039319    33.25524
  Ex-smoker  |   6.289211   6.601992     1.75   0.080     .8036406    49.21874
             |
severe_dis~e |   .7558134   .2090125    -1.01   0.311     .4395654    1.299588
             |
vacc_count~v |
          1  |    .726846   .2633864    -0.88   0.379     .3572675    1.478738
          2  |   .7687038   .3581114    -0.56   0.572     .3084714    1.915593
          3  |   .7178756   .7704402    -0.31   0.757     .0876033    5.882714
             |
 liver_trans |   2.60e-17   1.43e-17   -69.41   0.000     8.83e-18    7.63e-17
             |
time_vacc_~t |
Q1 closes..  |   .9999903   .4512042    -0.00   1.000     .4129774    2.421393
         Q2  |   .6584894   .3171282    -0.87   0.386     .2562185    1.692338
         Q3  |   .9206516    .375628    -0.20   0.839      .413812    2.048272
Q4 furthe..  |   1.107659   .4914119     0.23   0.818     .4642707    2.642657
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_vacc_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_vacc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.05742         0.26        1         0.6109
      age_tv      |      0.12252         2.64        1         0.1041
      male        |      0.10428         1.24        1         0.2658
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.17921         5.89        1         0.0153
      2.eth_bin   |      0.02986         0.11        1         0.7425
      1b.imd      |            .            .        1             .
      2.imd       |     -0.15391         4.86        1         0.0275
      3.imd       |      0.00338         0.00        1         0.9698
      4.imd       |     -0.04005         0.17        1         0.6839
      5.imd       |      0.09645         0.82        1         0.3654
      6.imd       |     -0.09201         1.33        1         0.2496
      1.bmi_cat   |      0.12094         1.74        1         0.1870
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.10212         1.53        1         0.2158
      4.bmi_cat   |     -0.13049         1.84        1         0.1755
      5.bmi_cat   |     -0.06298         0.46        1         0.4997
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.03112         0.09        1         0.7608
      2.smoking   |      0.00031         0.00        1         0.9975
      severe_dis~e|      0.07784         0.90        1         0.3431
      0b.vacc_co~v|            .            .        1             .
      1.vacc_cou~v|      0.05149         0.44        1         0.5069
      2.vacc_cou~v|     -0.02638         0.09        1         0.7700
      3.vacc_cou~v|      0.06755         0.36        1         0.5462
      liver_trans |     -0.15285         0.44        1         0.5091
      1.time_vac~t|      0.04153         0.34        1         0.5586
      2.time_vac~t|      0.15398         2.86        1         0.0908
      3.time_vac~t|      0.12620         1.72        1         0.1900
      4.time_vac~t|      0.09339         1.10        1         0.2935
      5b.time_va~t|            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     20.94       25         0.6960
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_vacc_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_vacc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -289.98287
Iteration 1:   log pseudolikelihood =  -279.4163
Iteration 2:   log pseudolikelihood = -278.80242
Iteration 3:   log pseudolikelihood = -278.74584
Iteration 4:   log pseudolikelihood = -278.73117
Iteration 5:   log pseudolikelihood =  -278.7258
Iteration 6:   log pseudolikelihood = -278.72382
Iteration 7:   log pseudolikelihood =  -278.7231
Iteration 8:   log pseudolikelihood = -278.72283
Iteration 9:   log pseudolikelihood = -278.72273
Iteration 10:  log pseudolikelihood =  -278.7227
Iteration 11:  log pseudolikelihood = -278.72268
Iteration 12:  log pseudolikelihood = -278.72268
Iteration 13:  log pseudolikelihood = -278.72268
Iteration 14:  log pseudolikelihood = -278.72268
Iteration 15:  log pseudolikelihood = -278.72268
Iteration 16:  log pseudolikelihood = -278.72267
Iteration 17:  log pseudolikelihood = -278.72267
Iteration 18:  log pseudolikelihood = -278.72267
Iteration 19:  log pseudolikelihood = -278.72267
Iteration 20:  log pseudolikelihood = -278.72267
Iteration 21:  log pseudolikelihood = -278.72267
Iteration 22:  log pseudolikelihood = -278.72267
Iteration 23:  log pseudolikelihood = -278.72267
Iteration 24:  log pseudolikelihood = -278.72267
Iteration 25:  log pseudolikelihood = -278.72267
Iteration 26:  log pseudolikelihood = -278.72267
Iteration 27:  log pseudolikelihood = -278.72267
Iteration 28:  log pseudolikelihood = -278.72267
Iteration 29:  log pseudolikelihood = -278.72267
Iteration 30:  log pseudolikelihood = -278.72267
Iteration 31:  log pseudolikelihood = -278.72267
Iteration 32:  log pseudolikelihood = -278.72267
Iteration 33:  log pseudolikelihood = -278.72267
Iteration 34:  log pseudolikelihood = -278.72267
Iteration 35:  log pseudolikelihood = -278.72267
Iteration 36:  log pseudolikelihood = -278.72267
Iteration 37:  log pseudolikelihood = -278.72267
Iteration 38:  log pseudolikelihood = -278.72267
Refining estimates:
Iteration 0:   log pseudolikelihood = -278.72267
Iteration 1:   log pseudolikelihood = -278.72267
Iteration 2:   log pseudolikelihood = -278.72267
Iteration 3:   log pseudolikelihood = -278.72267

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,294
No. of failures      =          116
Time at risk         =       478236
                                                Wald chi2(28)    =     6919.96
Log pseudolikelihood =   -278.72267             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8374866   .3820056    -0.39   0.697      .342544    2.047573
      age_tv |   1.006855   .0061887     1.11   0.266      .994798    1.019058
        male |   .8395937   .2363465    -0.62   0.535     .4835652    1.457751
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   1.058202    .588148     0.10   0.919     .3560175    3.145327
      Asian  |   1.627816   .8790121     0.90   0.367     .5648864     4.69083
      Black  |   2.388937   1.202423     1.73   0.084     .8907784    6.406779
      Other  |   1.450077   .7685396     0.70   0.483     .5131628    4.097577
    Unknown  |   1.031893   .8867242     0.04   0.971     .1915058    5.560162
             |
         imd |
          2  |   .6865253   .3168309    -0.81   0.415     .2778611    1.696232
          3  |   .4896051   .2107729    -1.66   0.097     .2105753    1.138373
          4  |   .6903974   .2746871    -0.93   0.352     .3165434    1.505792
          5  |   .6465173    .281186    -1.00   0.316     .2756589    1.516311
          6  |   .6052567   .5222331    -0.58   0.561     .1115573    3.283833
             |
     bmi_cat |
Underweight  |   1.565348   .7165852     0.98   0.328      .638187    3.839495
 Overweight  |    .816807   .2977034    -0.56   0.579     .3998344    1.668625
      Obese  |   .6845443    .248619    -1.04   0.297     .3359345    1.394918
Morbidly ..  |   .2324328   .2437945    -1.39   0.164     .0297501    1.815963
             |
     smoking |
Current s..  |   4.202899    4.34328     1.39   0.165     .5545188    31.85529
  Ex-smoker  |   5.844558   6.193668     1.67   0.096     .7323281    46.64419
             |
severe_dis~e |   .7449774   .2067007    -1.06   0.289     .4324835    1.283266
             |
vacc_count~v |
          1  |   .7300927   .2628401    -0.87   0.382     .3605269     1.47849
          2  |   .7466617   .3422918    -0.64   0.524      .304024    1.833749
          3  |   .7347764   .8200423    -0.28   0.782     .0824475    6.548368
             |
 liver_trans |   1.58e-18   8.83e-19   -73.21   0.000     5.27e-19    4.73e-18
             |
time_vacc_~t |
Q1 closes..  |   1.030918   .4702482     0.07   0.947     .4216507    2.520552
         Q2  |   .6052548   .3038051    -1.00   0.317     .2262983    1.618808
         Q3  |   .9059343   .3770548    -0.24   0.812     .4007025    2.048195
Q4 furthe..  |   1.069615   .5044836     0.14   0.887     .4243836    2.695855
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,651       62.28       62.28
          1 |      1,000       37.72      100.00
------------+-----------------------------------
      Total |      2,651      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        910       91.00       91.00
          1 |         90        9.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  910
  111
no udca events = 111
(1651 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        910      441509           0     441509     441509
14716.967
754.23151

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        910       91.00       91.00
          1 |         90        9.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 7

Contains data from ./output/an_dataset_hosp_any_vacc.dta
  obs:         2,611                          
 vars:            22                          13 Oct 2023 13:57
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
vacc_count_tv   float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,611  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,611  observations remaining, representing
      1,000  subjects
         35  failures in single-failure-per-subject data
    475,603  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       670
  35

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_vacc_hosp_any.svg not found)
(file ./output/graphs/km_vacc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -88.106827
Iteration 1:   log pseudolikelihood = -87.635154
Iteration 2:   log pseudolikelihood = -87.559361
Iteration 3:   log pseudolikelihood = -87.559005
Iteration 4:   log pseudolikelihood = -87.559005
Refining estimates:
Iteration 0:   log pseudolikelihood = -87.559005

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,292
No. of failures      =           35
Time at risk         =       475603
                                                Wald chi2(1)     =        1.28
Log pseudolikelihood =   -87.559005             Prob > chi2      =      0.2584

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.054468   1.308878     1.13   0.258     .5893982    7.161272
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_vacc_hosp_any.dta not found)
file ./output/tempdata/surv_crude_vacc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.11018         0.23        1         0.6337
      ------------+---------------------------------------------------
      global test |                      0.23        1         0.6337
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -87.882293
Iteration 1:   log pseudolikelihood = -87.145295
Iteration 2:   log pseudolikelihood = -87.077803
Iteration 3:   log pseudolikelihood = -87.077516
Iteration 4:   log pseudolikelihood = -87.077516
Refining estimates:
Iteration 0:   log pseudolikelihood = -87.077516

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,275
No. of failures      =           35
Time at risk         =       468490
                                                Wald chi2(3)     =        2.27
Log pseudolikelihood =   -87.077516             Prob > chi2      =      0.5178

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   2.038371   1.289817     1.13   0.260     .5897523    7.045256
      age_tv |   .9930929   .0074477    -0.92   0.355     .9786025    1.007798
        male |   1.145518   .5427714     0.29   0.774      .452568    2.899477
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_vacc_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_vacc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.10209         0.20        1         0.6586
      age_tv      |      0.13707         0.17        1         0.6803
      male        |      0.04357         0.04        1         0.8445
      ------------+---------------------------------------------------
      global test |                      0.53        3         0.9130
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -87.882293
Iteration 1:   log pseudolikelihood = -74.194945
Iteration 2:   log pseudolikelihood = -71.241938
Iteration 3:   log pseudolikelihood = -70.620225
Iteration 4:   log pseudolikelihood = -70.416953
Iteration 5:   log pseudolikelihood = -70.344782
Iteration 6:   log pseudolikelihood = -70.318556
Iteration 7:   log pseudolikelihood = -70.308951
Iteration 8:   log pseudolikelihood = -70.305423
Iteration 9:   log pseudolikelihood = -70.304126
Iteration 10:  log pseudolikelihood = -70.303649
Iteration 11:  log pseudolikelihood = -70.303474
Iteration 12:  log pseudolikelihood = -70.303409
Iteration 13:  log pseudolikelihood = -70.303385
Iteration 14:  log pseudolikelihood = -70.303377
Iteration 15:  log pseudolikelihood = -70.303373
Iteration 16:  log pseudolikelihood = -70.303372
Iteration 17:  log pseudolikelihood = -70.303372
Iteration 18:  log pseudolikelihood = -70.303372
Iteration 19:  log pseudolikelihood = -70.303372
Iteration 20:  log pseudolikelihood = -70.303372
Iteration 21:  log pseudolikelihood = -70.303372
Iteration 22:  log pseudolikelihood = -70.303371
Iteration 23:  log pseudolikelihood = -70.303371
Iteration 24:  log pseudolikelihood = -70.303371
Iteration 25:  log pseudolikelihood = -70.303371
Iteration 26:  log pseudolikelihood = -70.303371
Iteration 27:  log pseudolikelihood = -70.303371
Iteration 28:  log pseudolikelihood = -70.303371
Iteration 29:  log pseudolikelihood = -70.303371
Iteration 30:  log pseudolikelihood = -70.303371
Iteration 31:  log pseudolikelihood = -70.303371
Iteration 32:  log pseudolikelihood = -70.303371
Iteration 33:  log pseudolikelihood = -70.303371
Iteration 34:  log pseudolikelihood = -70.303371
Refining estimates:
Iteration 0:   log pseudolikelihood = -70.303371
Iteration 1:   log pseudolikelihood = -70.303371

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,275
No. of failures      =           35
Time at risk         =       468490
                                                Wald chi2(24)    =    23499.45
Log pseudolikelihood =   -70.303371             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.605046   1.402459     0.54   0.588     .2895501    8.897163
      age_tv |    .991358   .0105355    -0.82   0.414     .9709225    1.012224
        male |   1.408469   .7627497     0.63   0.527     .4872848    4.071097
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .5881136   .4753394    -0.66   0.511     .1206376    2.867081
    Unknown  |   1.36e-16   2.21e-16   -22.48   0.000     5.62e-18    3.29e-15
             |
         imd |
          2  |   2.18e-16   1.63e-16   -48.16   0.000     5.02e-17    9.45e-16
          3  |   1.768335   1.151817     0.88   0.381     .4933202    6.338702
          4  |   .3158535   .2633946    -1.38   0.167     .0616108    1.619252
          5  |   .6612889   .5322573    -0.51   0.607     .1365454    3.202618
          6  |   1.573809   1.567444     0.46   0.649     .2234568    11.08436
             |
     bmi_cat |
Underweight  |   3.009341   2.232854     1.48   0.138     .7029128    12.88372
 Overweight  |   .3316965   .2766707    -1.32   0.186     .0646765     1.70112
      Obese  |   .7403269   .4382678    -0.51   0.612     .2320165    2.362263
Morbidly ..  |   2.07e-16   1.45e-16   -51.42   0.000     5.22e-17    8.19e-16
             |
     smoking |
Current s..  |   8.57e+08   6.28e+08    28.05   0.000     2.04e+08    3.61e+09
  Ex-smoker  |   2.27e+09          .        .       .            .           .
             |
severe_dis~e |   1.024609   .5296556     0.05   0.962         .372    2.822107
             |
vacc_count~v |
          1  |   .6486851   .4049993    -0.69   0.488     .1908076    2.205323
          2  |   .2614662   .2517878    -1.39   0.164     .0396024    1.726272
          3  |   5.984325   6.173084     1.73   0.083      .792437    45.19241
             |
 liver_trans |   3.02e-16   3.69e-16   -29.30   0.000     2.77e-17    3.30e-15
             |
time_vacc_~t |
Q1 closes..  |   .2970584   .4237048    -0.85   0.395     .0181444    4.863403
         Q2  |    .447191   .5031153    -0.72   0.474     .0492995    4.056423
         Q3  |   1.310162   1.054299     0.34   0.737     .2706171       6.343
Q4 furthe..  |   2.880353    2.07736     1.47   0.142     .7007202    11.83987
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_vacc_hosp_any.dta not found)
file ./output/tempdata/surv_adj_vacc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.00157         0.00        1         0.9850
      age_tv      |      0.13826         2.28        1         0.1307
      male        |      0.06234         0.34        1         0.5570
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.12687         1.95        1         0.1626
      2.eth_bin   |      0.03976         0.12        1         0.7246
      1b.imd      |            .            .        1             .
      2.imd       |     -0.05546         0.18        1         0.6717
      3.imd       |     -0.07468         0.39        1         0.5321
      4.imd       |      0.00972         0.00        1         0.9550
      5.imd       |      0.13751         1.13        1         0.2883
      6.imd       |      0.00198         0.00        1         0.9885
      1.bmi_cat   |      0.14233         1.36        1         0.2432
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.03206         0.10        1         0.7473
      4.bmi_cat   |     -0.01095         0.01        1         0.9352
      5.bmi_cat   |     -0.06040         0.13        1         0.7138
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.11896         2.20        1         0.1377
      2.smoking   |            .            .        1             .
      severe_dis~e|      0.03771         0.14        1         0.7079
      0b.vacc_co~v|            .            .        1             .
      1.vacc_cou~v|      0.01395         0.01        1         0.9042
      2.vacc_cou~v|      0.13660         1.06        1         0.3029
      3.vacc_cou~v|      0.05453         0.15        1         0.6999
      liver_trans |     -0.37107         3.81        1         0.0510
      1.time_vac~t|     -0.01964         0.06        1         0.8044
      2.time_vac~t|      0.17307         2.90        1         0.0887
      3.time_vac~t|      0.12217         1.18        1         0.2781
      4.time_vac~t|      0.07070         0.35        1         0.5550
      5b.time_va~t|            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     12.39       24         0.9751
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_vacc_hosp_any.svg not found)
(file ./output/graphs/schoenplot_vacc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -87.882293
Iteration 1:   log pseudolikelihood = -72.650763
Iteration 2:   log pseudolikelihood = -69.511932
Iteration 3:   log pseudolikelihood =  -68.90504
Iteration 4:   log pseudolikelihood = -68.718756
Iteration 5:   log pseudolikelihood = -68.651919
Iteration 6:   log pseudolikelihood =  -68.62754
Iteration 7:   log pseudolikelihood =   -68.6186
Iteration 8:   log pseudolikelihood = -68.615314
Iteration 9:   log pseudolikelihood = -68.614106
Iteration 10:  log pseudolikelihood = -68.613662
Iteration 11:  log pseudolikelihood = -68.613499
Iteration 12:  log pseudolikelihood = -68.613439
Iteration 13:  log pseudolikelihood = -68.613416
Iteration 14:  log pseudolikelihood = -68.613408
Iteration 15:  log pseudolikelihood = -68.613405
Iteration 16:  log pseudolikelihood = -68.613404
Iteration 17:  log pseudolikelihood = -68.613404
Iteration 18:  log pseudolikelihood = -68.613404
Iteration 19:  log pseudolikelihood = -68.613404
Iteration 20:  log pseudolikelihood = -68.613404
Iteration 21:  log pseudolikelihood = -68.613404
Iteration 22:  log pseudolikelihood = -68.613404
Iteration 23:  log pseudolikelihood = -68.613404
Iteration 24:  log pseudolikelihood = -68.613404
Iteration 25:  log pseudolikelihood = -68.613404
Iteration 26:  log pseudolikelihood = -68.613404
Iteration 27:  log pseudolikelihood = -68.613404
Iteration 28:  log pseudolikelihood = -68.613404
Iteration 29:  log pseudolikelihood = -68.613404
Iteration 30:  log pseudolikelihood = -68.613404
Iteration 31:  log pseudolikelihood = -68.613404
Iteration 32:  log pseudolikelihood = -68.613404
Iteration 33:  log pseudolikelihood = -68.613404
Iteration 34:  log pseudolikelihood = -68.613404
Iteration 35:  log pseudolikelihood = -68.613404
Iteration 36:  log pseudolikelihood = -68.613404
Iteration 37:  log pseudolikelihood = -68.613404
Iteration 38:  log pseudolikelihood = -68.613404
Iteration 39:  log pseudolikelihood = -68.613404
Iteration 40:  log pseudolikelihood = -68.613404
Refining estimates:
Iteration 0:   log pseudolikelihood = -68.613404
Iteration 1:   log pseudolikelihood = -68.613404
Iteration 2:   log pseudolikelihood = -68.613404
Iteration 3:   log pseudolikelihood = -68.613404

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,275
No. of failures      =           35
Time at risk         =       468490
                                                Wald chi2(26)    =    30784.84
Log pseudolikelihood =   -68.613404             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.491079    1.39648     0.43   0.670     .2378494    9.347583
      age_tv |   .9918937   .0111006    -0.73   0.467     .9703737    1.013891
        male |   1.378064   .8064231     0.55   0.584     .4376818    4.338906
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .8100094   .6883426    -0.25   0.804     .1531591    4.283882
      Asian  |   .4859054   .5114183    -0.69   0.493     .0617529     3.82337
      Black  |   .9011738   .7604841    -0.12   0.902     .1723833    4.711097
      Other  |   .1682657   .2141738    -1.40   0.161     .0138855    2.039065
    Unknown  |   4.39e-20   7.02e-20   -27.88   0.000     1.91e-21    1.01e-18
             |
         imd |
          2  |   7.26e-20   6.01e-20   -53.26   0.000     1.43e-20    3.68e-19
          3  |   1.767698   1.282272     0.79   0.432     .4265345    7.325916
          4  |   .3836596   .3514096    -1.05   0.296     .0637229    2.309919
          5  |   .7520742   .6593228    -0.33   0.745     .1349074    4.192622
          6  |   1.620584   1.771997     0.44   0.659     .1900821    13.81662
             |
     bmi_cat |
Underweight  |      3.347   2.674844     1.51   0.131     .6988683    16.02935
 Overweight  |   .3479529   .3110735    -1.18   0.238     .0603306    2.006797
      Obese  |   .9120229   .6341957    -0.13   0.895     .2334014    3.563756
Morbidly ..  |   5.60e-20   4.45e-20   -55.75   0.000     1.18e-20    2.66e-19
             |
     smoking |
Current s..  |   5.15e+08   3.96e+08    26.14   0.000     1.15e+08    2.32e+09
  Ex-smoker  |   1.50e+09          .        .       .            .           .
             |
severe_dis~e |   .8555334   .4167971    -0.32   0.749     .3292686    2.222919
             |
vacc_count~v |
          1  |   .7042981   .4402373    -0.56   0.575     .2068683    2.397834
          2  |   .2806572    .278214    -1.28   0.200     .0402147      1.9587
          3  |   6.228626   6.539915     1.74   0.081     .7955182    48.76794
             |
 liver_trans |   2.06e-19          .        .       .            .           .
             |
time_vacc_~t |
Q1 closes..  |   .2696559   .3935232    -0.90   0.369     .0154385     4.70992
         Q2  |   .4009275    .499456    -0.73   0.463     .0348883    4.607352
         Q3  |   1.480792    1.33139     0.44   0.662     .2541989    8.626105
Q4 furthe..  |   3.334785   2.411933     1.67   0.096     .8080228    13.76297
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,611       61.70       61.70
          1 |      1,000       38.30      100.00
------------+-----------------------------------
      Total |      2,611      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        910       91.00       91.00
          1 |         90        9.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  910
  30
no udca events = 30
(1611 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        910      433617           0     433617     433617
14453.9
207.55644

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        910       91.00       91.00
          1 |         90        9.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = .

Contains data from ./output/an_dataset_composite_any_vacc.dta
  obs:         2,611                          
 vars:            21                          13 Oct 2023 13:57
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
vacc_count_tv   float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,611  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,611  observations remaining, representing
      1,000  subjects
        149  failures in single-failure-per-subject data
    475,603  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       670
  149

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_vacc_composite_any.svg not found)
(file ./output/graphs/km_vacc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -372.38311
Iteration 1:   log pseudolikelihood = -372.24362
Iteration 2:   log pseudolikelihood = -372.24249
Iteration 3:   log pseudolikelihood = -372.24249
Refining estimates:
Iteration 0:   log pseudolikelihood = -372.24249

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,292
No. of failures      =          149
Time at risk         =       475603
                                                Wald chi2(1)     =        0.30
Log pseudolikelihood =   -372.24249             Prob > chi2      =      0.5833

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    1.22615    .455676     0.55   0.583     .5918477    2.540253
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_vacc_composite_any.dta not found)
file ./output/tempdata/surv_crude_vacc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.04952         0.19        1         0.6641
      ------------+---------------------------------------------------
      global test |                      0.19        1         0.6641
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -367.60343
Iteration 1:   log pseudolikelihood = -367.36077
Iteration 2:   log pseudolikelihood = -367.35982
Iteration 3:   log pseudolikelihood = -367.35982
Refining estimates:
Iteration 0:   log pseudolikelihood = -367.35982

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,275
No. of failures      =          147
Time at risk         =       468490
                                                Wald chi2(3)     =        0.48
Log pseudolikelihood =   -367.35982             Prob > chi2      =      0.9235

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.222132   .4527937     0.54   0.588     .5912245    2.526295
      age_tv |    1.00183   .0047129     0.39   0.697     .9926356     1.01111
        male |   .9348625   .2168118    -0.29   0.771     .5933876    1.472845
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_vacc_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_vacc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.05337         0.22        1         0.6429
      age_tv      |      0.08667         0.57        1         0.4508
      male        |      0.14705         1.79        1         0.1805
      ------------+---------------------------------------------------
      global test |                      3.05        3         0.3833
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -367.60343
Iteration 1:   log pseudolikelihood = -355.33552
Iteration 2:   log pseudolikelihood = -354.23454
Iteration 3:   log pseudolikelihood = -354.13411
Iteration 4:   log pseudolikelihood = -354.11557
Iteration 5:   log pseudolikelihood = -354.10895
Iteration 6:   log pseudolikelihood = -354.10652
Iteration 7:   log pseudolikelihood = -354.10563
Iteration 8:   log pseudolikelihood =  -354.1053
Iteration 9:   log pseudolikelihood = -354.10518
Iteration 10:  log pseudolikelihood = -354.10513
Iteration 11:  log pseudolikelihood = -354.10512
Iteration 12:  log pseudolikelihood = -354.10511
Iteration 13:  log pseudolikelihood = -354.10511
Iteration 14:  log pseudolikelihood = -354.10511
Iteration 15:  log pseudolikelihood = -354.10511
Iteration 16:  log pseudolikelihood = -354.10511
Iteration 17:  log pseudolikelihood = -354.10511
Iteration 18:  log pseudolikelihood = -354.10511
Iteration 19:  log pseudolikelihood = -354.10511
Iteration 20:  log pseudolikelihood = -354.10511
Iteration 21:  log pseudolikelihood = -354.10511
Iteration 22:  log pseudolikelihood = -354.10511
Iteration 23:  log pseudolikelihood = -354.10511
Iteration 24:  log pseudolikelihood = -354.10511
Iteration 25:  log pseudolikelihood = -354.10511
Iteration 26:  log pseudolikelihood = -354.10511
Iteration 27:  log pseudolikelihood = -354.10511
Iteration 28:  log pseudolikelihood = -354.10511
Iteration 29:  log pseudolikelihood = -354.10511
Iteration 30:  log pseudolikelihood = -354.10511
Refining estimates:
Iteration 0:   log pseudolikelihood = -354.10511
Iteration 1:   log pseudolikelihood = -354.10511
Iteration 2:   log pseudolikelihood = -354.10511
Iteration 3:   log pseudolikelihood = -354.10511
Iteration 4:   log pseudolikelihood = -354.10511
Iteration 5:   log pseudolikelihood = -354.10511
Iteration 6:   log pseudolikelihood = -354.10511
Iteration 7:   log pseudolikelihood = -354.10511

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,275
No. of failures      =          147
Time at risk         =       468490
                                                Wald chi2(25)    =     5477.17
Log pseudolikelihood =   -354.10511             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.078723   .4082594     0.20   0.841     .5137593    2.264959
      age_tv |   1.002516   .0051627     0.49   0.626     .9924485    1.012686
        male |    .914453   .2203004    -0.37   0.710      .570294    1.466304
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.237864   .5027399     0.53   0.599      .558432    2.743947
    Unknown  |   .5438117   .4474149    -0.74   0.459     .1084256    2.727502
             |
         imd |
          2  |   .5307826   .2256375    -1.49   0.136     .2307108     1.22114
          3  |   .8552634   .2949395    -0.45   0.650      .435072    1.681275
          4  |   .6612584   .2283579    -1.20   0.231     .3360614    1.301139
          5  |   .6798383   .2660809    -0.99   0.324     .3156858    1.464051
          6  |   .8218906   .5602476    -0.29   0.774      .216066    3.126379
             |
     bmi_cat |
Underweight  |   1.720922   .6240521     1.50   0.134     .8454596    3.502914
 Overweight  |   .7385939   .2492625    -0.90   0.369     .3811887    1.431104
      Obese  |   .7190882   .2225898    -1.07   0.287     .3920102    1.319067
Morbidly ..  |    .183622   .1915608    -1.62   0.104     .0237641    1.418822
             |
     smoking |
Current s..  |    5.71743   5.948797     1.68   0.094     .7439672    43.93878
  Ex-smoker  |   9.086815   9.625272     2.08   0.037     1.139648     72.4524
             |
severe_dis~e |   .8154675   .1984113    -0.84   0.402     .5061752    1.313749
             |
vacc_count~v |
          1  |   .7519621   .2329206    -0.92   0.357     .4097659    1.379927
          2  |   .6361135   .2728013    -1.05   0.291     .2744678    1.474272
          3  |   1.420029   1.086686     0.46   0.647     .3168913    6.363328
             |
 liver_trans |   6.84e-17   4.01e-17   -63.44   0.000     2.17e-17    2.16e-16
             |
time_vacc_~t |
Q1 closes..  |   .8084316   .3385354    -0.51   0.612     .3557933    1.836914
         Q2  |   .6559598   .2874389    -0.96   0.336     .2778972    1.548354
         Q3  |   .8699626   .3251668    -0.37   0.709     .4181635    1.809902
Q4 furthe..  |   1.384612   .5270128     0.85   0.393     .6566633    2.919534
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_vacc_composite_any.dta not found)
file ./output/tempdata/surv_adj_vacc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.04502         0.21        1         0.6488
      age_tv      |      0.13579         3.07        1         0.0799
      male        |      0.08066         0.89        1         0.3454
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.17928         7.77        1         0.0053
      2.eth_bin   |      0.01873         0.04        1         0.8324
      1b.imd      |            .            .        1             .
      2.imd       |     -0.14556         4.75        1         0.0293
      3.imd       |     -0.03943         0.21        1         0.6480
      4.imd       |      0.00241         0.00        1         0.9807
      5.imd       |      0.14680         2.52        1         0.1126
      6.imd       |     -0.06142         0.64        1         0.4227
      1.bmi_cat   |      0.14667         2.50        1         0.1139
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.08605         1.30        1         0.2549
      4.bmi_cat   |     -0.08486         0.87        1         0.3515
      5.bmi_cat   |     -0.04440         0.25        1         0.6146
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.03205         0.13        1         0.7223
      2.smoking   |      0.01080         0.02        1         0.9022
      severe_dis~e|      0.09637         1.71        1         0.1909
      0b.vacc_co~v|            .            .        1             .
      1.vacc_cou~v|      0.03044         0.13        1         0.7161
      2.vacc_cou~v|     -0.04615         0.26        1         0.6079
      3.vacc_cou~v|      0.03954         0.13        1         0.7216
      liver_trans |     -0.16072         0.78        1         0.3785
      1.time_vac~t|      0.04561         0.49        1         0.4852
      2.time_vac~t|      0.19611         6.45        1         0.0111
      3.time_vac~t|      0.12695         1.82        1         0.1778
      4.time_vac~t|      0.12465         2.57        1         0.1087
      5b.time_va~t|            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     24.93       25         0.4663
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_vacc_composite_any.svg not found)
(file ./output/graphs/schoenplot_vacc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -367.60343
Iteration 1:   log pseudolikelihood = -352.78966
Iteration 2:   log pseudolikelihood = -351.64644
Iteration 3:   log pseudolikelihood = -351.54956
Iteration 4:   log pseudolikelihood = -351.53178
Iteration 5:   log pseudolikelihood = -351.52543
Iteration 6:   log pseudolikelihood = -351.52309
Iteration 7:   log pseudolikelihood = -351.52223
Iteration 8:   log pseudolikelihood = -351.52191
Iteration 9:   log pseudolikelihood =  -351.5218
Iteration 10:  log pseudolikelihood = -351.52176
Iteration 11:  log pseudolikelihood = -351.52174
Iteration 12:  log pseudolikelihood = -351.52173
Iteration 13:  log pseudolikelihood = -351.52173
Iteration 14:  log pseudolikelihood = -351.52173
Iteration 15:  log pseudolikelihood = -351.52173
Iteration 16:  log pseudolikelihood = -351.52173
Iteration 17:  log pseudolikelihood = -351.52173
Iteration 18:  log pseudolikelihood = -351.52173
Iteration 19:  log pseudolikelihood = -351.52173
Iteration 20:  log pseudolikelihood = -351.52173
Iteration 21:  log pseudolikelihood = -351.52173
Iteration 22:  log pseudolikelihood = -351.52173
Iteration 23:  log pseudolikelihood = -351.52173
Iteration 24:  log pseudolikelihood = -351.52173
Iteration 25:  log pseudolikelihood = -351.52173
Iteration 26:  log pseudolikelihood = -351.52173
Iteration 27:  log pseudolikelihood = -351.52173
Iteration 28:  log pseudolikelihood = -351.52173
Iteration 29:  log pseudolikelihood = -351.52173
Iteration 30:  log pseudolikelihood = -351.52173
Iteration 31:  log pseudolikelihood = -351.52173
Iteration 32:  log pseudolikelihood = -351.52173
Iteration 33:  log pseudolikelihood = -351.52173
Iteration 34:  log pseudolikelihood = -351.52173
Iteration 35:  log pseudolikelihood = -351.52173
Iteration 36:  log pseudolikelihood = -351.52173
Iteration 37:  log pseudolikelihood = -351.52173
Iteration 38:  log pseudolikelihood = -351.52173
Iteration 39:  log pseudolikelihood = -351.52173
Iteration 40:  log pseudolikelihood = -351.52173
Refining estimates:
Iteration 0:   log pseudolikelihood = -351.52173
Iteration 1:   log pseudolikelihood = -351.52173

Stratified Cox regr. -- no ties

No. of subjects      =          987             Number of obs    =       1,275
No. of failures      =          147
Time at risk         =       468490
                                                Wald chi2(28)    =     6965.99
Log pseudolikelihood =   -351.52173             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.083254   .4157248     0.21   0.835      .510577    2.298261
      age_tv |   1.003502   .0052868     0.66   0.507     .9931936    1.013918
        male |   .9148181   .2282763    -0.36   0.721     .5609611     1.49189
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .9897785   .4711011    -0.02   0.983     .3893991    2.515829
      Asian  |   1.241072   .5875292     0.46   0.648     .4907207    3.138771
      Black  |   1.802387   .7808639     1.36   0.174     .7710359    4.213292
      Other  |   .8577963   .4130151    -0.32   0.750     .3338446    2.204063
    Unknown  |   .5293524   .4372202    -0.77   0.441     .1048799    2.671759
             |
         imd |
          2  |   .5416591   .2355511    -1.41   0.159     .2309747    1.270246
          3  |   .7904857   .2787987    -0.67   0.505     .3959873    1.577999
          4  |   .6864852   .2422269    -1.07   0.286     .3437827    1.370813
          5  |   .6715173   .2648273    -1.01   0.313     .3100043    1.454611
          6  |   .8513938   .5919494    -0.23   0.817     .2179288    3.326184
             |
     bmi_cat |
Underweight  |   1.824296   .6754915     1.62   0.104     .8829098    3.769416
 Overweight  |   .7384638   .2550366    -0.88   0.380     .3752817    1.453118
      Obese  |   .7275013   .2288445    -1.01   0.312     .3927153    1.347689
Morbidly ..  |   .1618177   .1676232    -1.76   0.079     .0212464     1.23244
             |
     smoking |
Current s..  |   5.133961   5.375267     1.56   0.118     .6595428    39.96338
  Ex-smoker  |   8.119022   8.648993     1.97   0.049     1.006328    65.50398
             |
severe_dis~e |   .7744882   .1872697    -1.06   0.291     .4821652    1.244038
             |
vacc_count~v |
          1  |   .7572925   .2346406    -0.90   0.370     .4125971    1.389956
          2  |   .6200851   .2639598    -1.12   0.262     .2692212    1.428214
          3  |   1.431221   1.107726     0.46   0.643     .3139786    6.523989
             |
 liver_trans |   1.46e-18   8.71e-19   -68.69   0.000     4.51e-19    4.70e-18
             |
time_vacc_~t |
Q1 closes..  |   .7990866   .3382588    -0.53   0.596     .3485575    1.831948
         Q2  |   .6147442   .2759219    -1.08   0.278     .2550593    1.481658
         Q3  |   .8864798   .3426218    -0.31   0.755     .4156061    1.890844
Q4 furthe..  |   1.377249   .5474685     0.81   0.421     .6319061    3.001736
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,611       61.70       61.70
          1 |      1,000       38.30      100.00
------------+-----------------------------------
      Total |      2,611      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        910       91.00       91.00
          1 |         90        9.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  910
  137
no udca events = 137
(1611 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        910      433617           0     433617     433617
14453.9
947.84107

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        910       91.00       91.00
          1 |         90        9.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 12

. 
. file close tablecontent

. 
end of do-file

. . file open output using "/tmp/106_analysis_models.do.m4yw.out", write text r
> eplace

. . file write output "success" 

. . file close output

. 
end of do-file


