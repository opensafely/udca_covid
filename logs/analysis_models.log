
. 
. * Open file to write results to 
. file open tablecontent using ./output/tables/cox_models.txt, write text repla
> ce
(note: file ./output/tables/cox_models.txt not found)

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_`outcome'.svg, as(svg) replace
 10.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model1
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model2
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model3
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_`outcome' adj_plot_`outcome'
 28.         graph export ./output/graphs/schoenplot_`outcome'.svg, as(svg) rep
> lace 
 29.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1
 34.         safecount if unexposed_ever==0 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1
 55.         qui safecount if exposed_ever==1 & number==1
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. }

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         3,012                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      3,012  total observations
          0  exclusions
------------------------------------------------------------------------------
      3,012  observations remaining, representing
      1,000  subjects
        165  failures in single-failure-per-subject data
    676,087  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  165

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_died_covid_any.svg not found)
(file ./output/graphs/km_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -368.5049
Iteration 1:   log pseudolikelihood = -368.18864
Iteration 2:   log pseudolikelihood = -368.18435
Iteration 3:   log pseudolikelihood = -368.18435
Refining estimates:
Iteration 0:   log pseudolikelihood = -368.18435

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,512
No. of failures      =          165
Time at risk         =       676087
                                                Wald chi2(1)     =        0.60
Log pseudolikelihood =   -368.18435             Prob > chi2      =      0.4398

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7222328    .304197    -0.77   0.440     .3163442    1.648901
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
file ./output/tempdata/surv_crude_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.00691         0.00        1         0.9524
      ------------+---------------------------------------------------
      global test |                      0.00        1         0.9524
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood = -362.98723
Iteration 2:   log pseudolikelihood = -362.98313
Iteration 3:   log pseudolikelihood = -362.98313
Refining estimates:
Iteration 0:   log pseudolikelihood = -362.98313

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(3)     =        0.75
Log pseudolikelihood =   -362.98313             Prob > chi2      =      0.8603

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7228625   .3051761    -0.77   0.442     .3160078    1.653536
      age_tv |    1.00006   .0048906     0.01   0.990     .9905209    1.009692
        male |   .9094817   .2088509    -0.41   0.679     .5798643    1.426467
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/p_adj_model_died_covid_any.ster not found)
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.00333         0.00        1         0.9763
      age_tv      |      0.06000         0.30        1         0.5825
      male        |     -0.04413         0.15        1         0.7028
      ------------+---------------------------------------------------
      global test |                      0.44        3         0.9309
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood = -358.59279
Iteration 2:   log pseudolikelihood = -358.36403
Iteration 3:   log pseudolikelihood = -358.33385
Iteration 4:   log pseudolikelihood = -358.32286
Iteration 5:   log pseudolikelihood = -358.31881
Iteration 6:   log pseudolikelihood = -358.31733
Iteration 7:   log pseudolikelihood = -358.31678
Iteration 8:   log pseudolikelihood = -358.31658
Iteration 9:   log pseudolikelihood =  -358.3165
Iteration 10:  log pseudolikelihood = -358.31648
Iteration 11:  log pseudolikelihood = -358.31647
Iteration 12:  log pseudolikelihood = -358.31646
Iteration 13:  log pseudolikelihood = -358.31646
Iteration 14:  log pseudolikelihood = -358.31646
Iteration 15:  log pseudolikelihood = -358.31646
Iteration 16:  log pseudolikelihood = -358.31646
Iteration 17:  log pseudolikelihood = -358.31646
Iteration 18:  log pseudolikelihood = -358.31646
Iteration 19:  log pseudolikelihood = -358.31646
Iteration 20:  log pseudolikelihood = -358.31646
Iteration 21:  log pseudolikelihood = -358.31646
Iteration 22:  log pseudolikelihood = -358.31646
Iteration 23:  log pseudolikelihood = -358.31646
Iteration 24:  log pseudolikelihood = -358.31646
Iteration 25:  log pseudolikelihood = -358.31646
Iteration 26:  log pseudolikelihood = -358.31646
Iteration 27:  log pseudolikelihood = -358.31646
Iteration 28:  log pseudolikelihood = -358.31646
Iteration 29:  log pseudolikelihood = -358.31646
Iteration 30:  log pseudolikelihood = -358.31646
Iteration 31:  log pseudolikelihood = -358.31646
Refining estimates:
Iteration 0:   log pseudolikelihood = -358.31646
Iteration 1:   log pseudolikelihood = -358.31646

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(19)    =     1786.61
Log pseudolikelihood =   -358.31646             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6881514    .296081    -0.87   0.385     .2961077    1.599257
      age_tv |   .9996801   .0047782    -0.07   0.947     .9903587    1.009089
        male |    .925549   .2215708    -0.32   0.747     .5789312    1.479694
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .8109154   .2559539    -0.66   0.507     .4368234    1.505377
    Unknown  |    .471873   .3827058    -0.93   0.354     .0962654    2.313023
             |
         imd |
          2  |   .9743507   .3588186    -0.07   0.944     .4734217    2.005314
          3  |   .5708025   .2489017    -1.29   0.198     .2428368    1.341706
          4  |    1.06023   .3724103     0.17   0.868     .5326136    2.110514
          5  |    1.13625    .402084     0.36   0.718     .5678844    2.273463
          6  |   1.178361   .6503393     0.30   0.766     .3994833    3.475825
             |
     bmi_cat |
Underweight  |   1.625412   .5656774     1.40   0.163     .8217269    3.215137
 Overweight  |   .9649102   .3058579    -0.11   0.910     .5184089    1.795979
      Obese  |   .8253337   .2606117    -0.61   0.543     .4444774    1.532532
Morbidly ..  |   1.109724   .5626724     0.21   0.837     .4107934    2.997828
             |
     smoking |
Current s..  |   .9738044   .3783693    -0.07   0.946     .4547152     2.08547
  Ex-smoker  |   1.001982    .491756     0.00   0.997     .3829171    2.621896
             |
severe_dis~e |    .851022   .2111129    -0.65   0.516     .5233393    1.383879
covid_vacc~t |   .9056232    .293203    -0.31   0.759     .4801356     1.70817
 liver_trans |   1.25e-14   1.02e-14   -39.24   0.000     2.52e-15    6.17e-14
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/adj_model_died_covid_any.ster not found)
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03003         0.11        1         0.7359
      age_tv      |      0.22466         5.28        1         0.0216
      male        |     -0.03675         0.20        1         0.6550
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.03580         0.13        1         0.7144
      2.eth_bin   |     -0.01626         0.03        1         0.8577
      1b.imd      |            .            .        1             .
      2.imd       |      0.12346         1.48        1         0.2241
      3.imd       |     -0.15162         2.33        1         0.1266
      4.imd       |      0.32627        10.72        1         0.0011
      5.imd       |      0.18301         3.62        1         0.0570
      6.imd       |      0.23901         5.10        1         0.0239
      1.bmi_cat   |      0.13149         1.93        1         0.1645
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.25677         6.55        1         0.0105
      4.bmi_cat   |      0.27759         9.32        1         0.0023
      5.bmi_cat   |      0.16502         3.80        1         0.0514
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.26308         8.92        1         0.0028
      2.smoking   |      0.10270         1.73        1         0.1886
      severe_dis~e|      0.02099         0.05        1         0.8169
      covid_vacc~t|      0.06966         0.44        1         0.5089
      liver_trans |      0.09131         0.10        1         0.7476
      ------------+---------------------------------------------------
      global test |                     38.45       19         0.0052
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood =   -356.829
Iteration 2:   log pseudolikelihood = -356.59375
Iteration 3:   log pseudolikelihood =  -356.5632
Iteration 4:   log pseudolikelihood = -356.55204
Iteration 5:   log pseudolikelihood = -356.54793
Iteration 6:   log pseudolikelihood = -356.54642
Iteration 7:   log pseudolikelihood = -356.54587
Iteration 8:   log pseudolikelihood = -356.54566
Iteration 9:   log pseudolikelihood = -356.54559
Iteration 10:  log pseudolikelihood = -356.54556
Iteration 11:  log pseudolikelihood = -356.54555
Iteration 12:  log pseudolikelihood = -356.54555
Iteration 13:  log pseudolikelihood = -356.54555
Iteration 14:  log pseudolikelihood = -356.54555
Iteration 15:  log pseudolikelihood = -356.54555
Iteration 16:  log pseudolikelihood = -356.54555
Iteration 17:  log pseudolikelihood = -356.54555
Iteration 18:  log pseudolikelihood = -356.54555
Iteration 19:  log pseudolikelihood = -356.54555
Iteration 20:  log pseudolikelihood = -356.54555
Iteration 21:  log pseudolikelihood = -356.54555
Iteration 22:  log pseudolikelihood = -356.54555
Iteration 23:  log pseudolikelihood = -356.54555
Iteration 24:  log pseudolikelihood = -356.54555
Iteration 25:  log pseudolikelihood = -356.54555
Iteration 26:  log pseudolikelihood = -356.54555
Iteration 27:  log pseudolikelihood = -356.54555
Iteration 28:  log pseudolikelihood = -356.54555
Iteration 29:  log pseudolikelihood = -356.54555
Iteration 30:  log pseudolikelihood = -356.54555
Iteration 31:  log pseudolikelihood = -356.54555
Refining estimates:
Iteration 0:   log pseudolikelihood = -356.54555
Iteration 1:   log pseudolikelihood = -356.54555

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(22)    =     1514.39
Log pseudolikelihood =   -356.54555             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6946805   .3025613    -0.84   0.403     .2958371    1.631239
      age_tv |   1.000153   .0047998     0.03   0.975     .9907898    1.009605
        male |   .9534143   .2354275    -0.19   0.847     .5876161    1.546926
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .5884633   .2488396    -1.25   0.210     .2569079    1.347912
      Asian  |    .956933   .3530997    -0.12   0.905     .4642969    1.972274
      Black  |    .645843   .2791964    -1.01   0.312     .2767927    1.506952
      Other  |   1.066098   .3987501     0.17   0.864     .5121816    2.219065
    Unknown  |   .4802401   .3893939    -0.90   0.366     .0980115    2.353096
             |
         imd |
          2  |    1.02659    .380599     0.07   0.944     .4963888    2.123109
          3  |   .5872642    .254163    -1.23   0.219     .2514436    1.371597
          4  |   1.056761   .3685125     0.16   0.874     .5335151    2.093181
          5  |   1.203537   .4246951     0.53   0.600     .6026896    2.403394
          6  |   1.203514   .6518704     0.34   0.732     .4163007    3.479327
             |
     bmi_cat |
Underweight  |   1.549968   .5288372     1.28   0.199     .7941442    3.025145
 Overweight  |    .963259   .3025332    -0.12   0.905       .52048    1.782716
      Obese  |   .7813588   .2547593    -0.76   0.449     .4124006    1.480409
Morbidly ..  |   1.165445   .5868384     0.30   0.761      .434395    3.126789
             |
     smoking |
Current s..  |   .9945141   .3903851    -0.01   0.989     .4607672    2.146547
  Ex-smoker  |   1.088157   .5515482     0.17   0.868     .4029468    2.938566
             |
severe_dis~e |   .8526731   .2131665    -0.64   0.524     .5223769    1.391814
covid_vacc~t |    .897104   .2894663    -0.34   0.736      .476637    1.688488
 liver_trans |   1.04e-14   9.31e-15   -35.87   0.000     1.79e-15    6.03e-14
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,012       66.80       66.80
          1 |      1,000       33.20      100.00
------------+-----------------------------------
      Total |      3,012      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  148
no udca events = 148
(2012 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      606518           0     606518     606518
20217.267
732.04752

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 17

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,933                          
 vars:            21                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
         57  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  57

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_hosp_any.svg not found)
(file ./output/graphs/km_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =   -136.627
Iteration 1:   log pseudolikelihood = -136.62181
Iteration 2:   log pseudolikelihood = -136.62181
Refining estimates:
Iteration 0:   log pseudolikelihood = -136.62181

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,470
No. of failures      =           57
Time at risk         =       652131
                                                Wald chi2(1)     =        0.01
Log pseudolikelihood =   -136.62181             Prob > chi2      =      0.9186

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9401447   .5674727    -0.10   0.919     .2880104    3.068889
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/crude_hosp_any.ster not found)
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_hosp_any.dta not found)
file ./output/tempdata/surv_crude_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17371         0.86        1         0.3550
      ------------+---------------------------------------------------
      global test |                      0.86        1         0.3550
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -130.20759
Iteration 2:   log pseudolikelihood = -130.20712
Iteration 3:   log pseudolikelihood = -130.20712
Refining estimates:
Iteration 0:   log pseudolikelihood = -130.20712

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(3)     =        2.79
Log pseudolikelihood =   -130.20712             Prob > chi2      =      0.4252

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9939013   .6026663    -0.01   0.992     .3028343    3.261982
      age_tv |   1.007445   .0080114     0.93   0.351     .9918646     1.02327
        male |   1.661434   .6425731     1.31   0.189     .7785275     3.54562
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/p_adj_model_hosp_any.ster not found)
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.12910         0.63        1         0.4282
      age_tv      |      0.10787         0.34        1         0.5610
      male        |      0.05033         0.09        1         0.7652
      ------------+---------------------------------------------------
      global test |                      1.12        3         0.7714
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -121.21653
Iteration 2:   log pseudolikelihood = -119.83842
Iteration 3:   log pseudolikelihood = -119.57978
Iteration 4:   log pseudolikelihood = -119.48811
Iteration 5:   log pseudolikelihood = -119.45456
Iteration 6:   log pseudolikelihood = -119.44224
Iteration 7:   log pseudolikelihood = -119.43771
Iteration 8:   log pseudolikelihood = -119.43605
Iteration 9:   log pseudolikelihood = -119.43544
Iteration 10:  log pseudolikelihood = -119.43521
Iteration 11:  log pseudolikelihood = -119.43513
Iteration 12:  log pseudolikelihood =  -119.4351
Iteration 13:  log pseudolikelihood = -119.43509
Iteration 14:  log pseudolikelihood = -119.43508
Iteration 15:  log pseudolikelihood = -119.43508
Iteration 16:  log pseudolikelihood = -119.43508
Iteration 17:  log pseudolikelihood = -119.43508
Iteration 18:  log pseudolikelihood = -119.43508
Iteration 19:  log pseudolikelihood = -119.43508
Iteration 20:  log pseudolikelihood = -119.43508
Iteration 21:  log pseudolikelihood = -119.43508
Iteration 22:  log pseudolikelihood = -119.43508
Iteration 23:  log pseudolikelihood = -119.43508
Iteration 24:  log pseudolikelihood = -119.43508
Iteration 25:  log pseudolikelihood = -119.43508
Iteration 26:  log pseudolikelihood = -119.43508
Iteration 27:  log pseudolikelihood = -119.43508
Iteration 28:  log pseudolikelihood = -119.43508
Iteration 29:  log pseudolikelihood = -119.43508
Iteration 30:  log pseudolikelihood = -119.43508
Iteration 31:  log pseudolikelihood = -119.43508
Iteration 32:  log pseudolikelihood = -119.43508
Iteration 33:  log pseudolikelihood = -119.43508
Iteration 34:  log pseudolikelihood = -119.43508
Iteration 35:  log pseudolikelihood = -119.43508
Iteration 36:  log pseudolikelihood = -119.43508
Iteration 37:  log pseudolikelihood = -119.43508
Iteration 38:  log pseudolikelihood = -119.43508
Iteration 39:  log pseudolikelihood = -119.43508
Iteration 40:  log pseudolikelihood = -119.43508
Iteration 41:  log pseudolikelihood = -119.43508
Iteration 42:  log pseudolikelihood = -119.43508
Iteration 43:  log pseudolikelihood = -119.43508
Iteration 44:  log pseudolikelihood = -119.43508
Iteration 45:  log pseudolikelihood = -119.43508
Refining estimates:
Iteration 0:   log pseudolikelihood = -119.43508

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(17)    =       25.27
Log pseudolikelihood =   -119.43508             Prob > chi2      =      0.0888

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.000572   .6238069     0.00   0.999     .2948265    3.395707
      age_tv |   1.007529     .00876     0.86   0.388     .9905056    1.024846
        male |    1.63195   .6681176     1.20   0.232     .7315207    3.640721
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .7255643   .3504021    -0.66   0.507     .2815781    1.869618
    Unknown  |   1.151006   .9455321     0.17   0.864     .2300543     5.75871
             |
         imd |
          2  |   .7167915   .6550641    -0.36   0.716     .1195346    4.298255
          3  |   3.069491    2.20892     1.56   0.119     .7490491    12.57832
          4  |   2.877135   2.060902     1.48   0.140     .7067106    11.71329
          5  |   1.482383   1.183281     0.49   0.622     .3101038    7.086209
          6  |   4.363748   3.787924     1.70   0.090     .7961222    23.91882
             |
     bmi_cat |
Underweight  |   1.65e-20          .        .       .            .           .
 Overweight  |   .4488828   .2449465    -1.47   0.142     .1540455    1.308027
      Obese  |   .6640864    .296442    -0.92   0.359     .2768574    1.592917
Morbidly ..  |   .3687616   .3939487    -0.93   0.350     .0454366    2.992856
             |
     smoking |
Current s..  |   .7327329   .3294168    -0.69   0.489     .3035768    1.768572
  Ex-smoker  |   .4219229   .3450214    -1.06   0.291     .0849523    2.095516
             |
severe_dis~e |   .8232348   .3216538    -0.50   0.619     .3827743    1.770536
covid_vacc~t |   1.238093   1.001088     0.26   0.792     .2538018    6.039649
 liver_trans |   6.75e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/adj_model_hosp_any.ster not found)
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_hosp_any.dta not found)
file ./output/tempdata/surv_adj_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.24881         4.25        1         0.0392
      age_tv      |      0.15144         1.83        1         0.1762
      male        |     -0.12331         0.99        1         0.3205
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.18251         2.10        1         0.1469
      2.eth_bin   |     -0.05291         0.16        1         0.6932
      1b.imd      |            .            .        1             .
      2.imd       |      0.04371         0.10        1         0.7538
      3.imd       |     -0.19652         2.66        1         0.1030
      4.imd       |     -0.11737         0.90        1         0.3436
      5.imd       |     -0.33639         7.06        1         0.0079
      6.imd       |     -0.20120         2.69        1         0.1009
      1.bmi_cat   |            .            .        1             .
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.02230         0.04        1         0.8510
      4.bmi_cat   |     -0.08963         0.37        1         0.5448
      5.bmi_cat   |     -0.00857         0.00        1         0.9446
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.56918        20.30        1         0.0000
      2.smoking   |     -0.19604         2.67        1         0.1026
      severe_dis~e|      0.18338         1.83        1         0.1758
      covid_vacc~t|     -0.26812         6.77        1         0.0093
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     32.44       17         0.0132
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_hosp_any.svg not found)
(file ./output/graphs/schoenplot_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -120.45992
Iteration 2:   log pseudolikelihood = -119.08244
Iteration 3:   log pseudolikelihood = -118.80856
Iteration 4:   log pseudolikelihood = -118.71129
Iteration 5:   log pseudolikelihood = -118.67571
Iteration 6:   log pseudolikelihood = -118.66264
Iteration 7:   log pseudolikelihood = -118.65784
Iteration 8:   log pseudolikelihood = -118.65607
Iteration 9:   log pseudolikelihood = -118.65543
Iteration 10:  log pseudolikelihood = -118.65519
Iteration 11:  log pseudolikelihood =  -118.6551
Iteration 12:  log pseudolikelihood = -118.65507
Iteration 13:  log pseudolikelihood = -118.65505
Iteration 14:  log pseudolikelihood = -118.65505
Iteration 15:  log pseudolikelihood = -118.65505
Iteration 16:  log pseudolikelihood = -118.65505
Iteration 17:  log pseudolikelihood = -118.65505
Iteration 18:  log pseudolikelihood = -118.65505
Iteration 19:  log pseudolikelihood = -118.65505
Iteration 20:  log pseudolikelihood = -118.65505
Iteration 21:  log pseudolikelihood = -118.65505
Iteration 22:  log pseudolikelihood = -118.65505
Iteration 23:  log pseudolikelihood = -118.65505
Iteration 24:  log pseudolikelihood = -118.65505
Iteration 25:  log pseudolikelihood = -118.65505
Iteration 26:  log pseudolikelihood = -118.65505
Iteration 27:  log pseudolikelihood = -118.65505
Iteration 28:  log pseudolikelihood = -118.65505
Iteration 29:  log pseudolikelihood = -118.65505
Iteration 30:  log pseudolikelihood = -118.65505
Iteration 31:  log pseudolikelihood = -118.65505
Iteration 32:  log pseudolikelihood = -118.65505
Iteration 33:  log pseudolikelihood = -118.65505
Iteration 34:  log pseudolikelihood = -118.65505
Iteration 35:  log pseudolikelihood = -118.65505
Refining estimates:
Iteration 0:   log pseudolikelihood = -118.65505
Iteration 1:   log pseudolikelihood = -118.65505

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(22)    =    17163.19
Log pseudolikelihood =   -118.65505             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9876841   .6006865    -0.02   0.984     .2998728    3.253112
      age_tv |   1.006807   .0087576     0.78   0.435     .9897875    1.024118
        male |   1.632711   .6641371     1.21   0.228     .7356416    3.623699
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6516351   .4362824    -0.64   0.522     .1754319    2.420474
      Asian  |   .9825718   .4948221    -0.03   0.972     .3661846    2.636504
      Black  |   .6075175   .4432585    -0.68   0.495     .1453794    2.538719
      Other  |   .4767897   .3573699    -0.99   0.323     .1097293     2.07172
    Unknown  |   1.162992   .9605629     0.18   0.855     .2304273    5.869744
             |
         imd |
          2  |   .7469669   .6912673    -0.32   0.753     .1217789    4.581743
          3  |   3.076964   2.186536     1.58   0.114     .7642687    12.38793
          4  |    2.84908   2.030441     1.47   0.142     .7048271    11.51666
          5  |   1.491545   1.235593     0.48   0.629     .2941053     7.56432
          6  |   4.486919   4.006552     1.68   0.093     .7796073    25.82382
             |
     bmi_cat |
Underweight  |   1.39e-16   4.82e-17  -105.02   0.000     7.01e-17    2.74e-16
 Overweight  |   .4599002   .2568861    -1.39   0.164     .1538894    1.374417
      Obese  |    .648709   .2766724    -1.01   0.310     .2811998    1.496528
Morbidly ..  |   .3687501   .3980992    -0.92   0.355     .0444409    3.059719
             |
     smoking |
Current s..  |   .7116886   .3105669    -0.78   0.436     .3025816    1.673931
  Ex-smoker  |    .447328   .3685129    -0.98   0.329     .0890017    2.248297
             |
severe_dis~e |   .8291129     .32414    -0.48   0.632     .3853348    1.783977
covid_vacc~t |    1.25724     1.0014     0.29   0.774     .2638947    5.989713
 liver_trans |   3.08e-16   2.92e-16   -37.64   0.000     4.79e-17    1.98e-15
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  51
no udca events = 51
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      583882           0     583882     583882
19462.733
262.03925

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 6

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,933                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
        214  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  214

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_composite_any.svg not found)
(file ./output/graphs/km_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -479.38698
Iteration 1:   log pseudolikelihood = -479.18954
Iteration 2:   log pseudolikelihood = -479.18833
Iteration 3:   log pseudolikelihood = -479.18833
Refining estimates:
Iteration 0:   log pseudolikelihood = -479.18833

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,470
No. of failures      =          214
Time at risk         =       652131
                                                Wald chi2(1)     =        0.39
Log pseudolikelihood =   -479.18833             Prob > chi2      =      0.5308

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8073394    .275669    -0.63   0.531     .4134379    1.576529
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/crude_composite_any.ster not found)
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_composite_any.dta not found)
file ./output/tempdata/surv_crude_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.06123         0.36        1         0.5495
      ------------+---------------------------------------------------
      global test |                      0.36        1         0.5495
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood = -473.48299
Iteration 2:   log pseudolikelihood = -473.48188
Iteration 3:   log pseudolikelihood = -473.48188
Refining estimates:
Iteration 0:   log pseudolikelihood = -473.48188

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(3)     =        0.58
Log pseudolikelihood =   -473.48188             Prob > chi2      =      0.8999

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8118702    .278129    -0.61   0.543     .4148428    1.588875
      age_tv |   1.000628   .0042815     0.15   0.883     .9922712    1.009055
        male |   1.082704   .2159606     0.40   0.690     .7323617    1.600641
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/p_adj_model_composite_any.ster not found)
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.04027         0.17        1         0.6798
      age_tv      |      0.04662         0.24        1         0.6261
      male        |     -0.07042         0.50        1         0.4811
      ------------+---------------------------------------------------
      global test |                      1.04        3         0.7908
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood = -469.64886
Iteration 2:   log pseudolikelihood = -469.50982
Iteration 3:   log pseudolikelihood = -469.46963
Iteration 4:   log pseudolikelihood = -469.45487
Iteration 5:   log pseudolikelihood = -469.44944
Iteration 6:   log pseudolikelihood = -469.44745
Iteration 7:   log pseudolikelihood = -469.44671
Iteration 8:   log pseudolikelihood = -469.44644
Iteration 9:   log pseudolikelihood = -469.44634
Iteration 10:  log pseudolikelihood = -469.44631
Iteration 11:  log pseudolikelihood = -469.44629
Iteration 12:  log pseudolikelihood = -469.44629
Iteration 13:  log pseudolikelihood = -469.44629
Iteration 14:  log pseudolikelihood = -469.44629
Iteration 15:  log pseudolikelihood = -469.44629
Iteration 16:  log pseudolikelihood = -469.44629
Iteration 17:  log pseudolikelihood = -469.44629
Iteration 18:  log pseudolikelihood = -469.44629
Iteration 19:  log pseudolikelihood = -469.44629
Iteration 20:  log pseudolikelihood = -469.44629
Iteration 21:  log pseudolikelihood = -469.44629
Iteration 22:  log pseudolikelihood = -469.44629
Iteration 23:  log pseudolikelihood = -469.44629
Iteration 24:  log pseudolikelihood = -469.44629
Iteration 25:  log pseudolikelihood = -469.44629
Iteration 26:  log pseudolikelihood = -469.44629
Iteration 27:  log pseudolikelihood = -469.44629
Iteration 28:  log pseudolikelihood = -469.44629
Iteration 29:  log pseudolikelihood = -469.44629
Iteration 30:  log pseudolikelihood = -469.44629
Iteration 31:  log pseudolikelihood = -469.44629
Iteration 32:  log pseudolikelihood = -469.44629
Refining estimates:
Iteration 0:   log pseudolikelihood = -469.44629
Iteration 1:   log pseudolikelihood = -469.44629
Iteration 2:   log pseudolikelihood = -469.44629

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(19)    =     2556.37
Log pseudolikelihood =   -469.44629             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7628878   .2672964    -0.77   0.440     .3839028    1.516003
      age_tv |   .9995636   .0043103    -0.10   0.919     .9911511    1.008047
        male |   1.046985   .2149927     0.22   0.823      .700085    1.565777
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .8066551   .2223432    -0.78   0.436     .4699656    1.384553
    Unknown  |   .7075908   .4091339    -0.60   0.550     .2278303    2.197621
             |
         imd |
          2  |    .893164   .2999467    -0.34   0.737     .4624625    1.724987
          3  |   .9086956   .3286111    -0.26   0.791        .4473    1.846027
          4  |   1.270959   .4002557     0.76   0.446     .6855947    2.356109
          5  |   1.150778   .3769742     0.43   0.668     .6055546    2.186905
          6  |   1.544149   .7445274     0.90   0.368     .6001691    3.972874
             |
     bmi_cat |
Underweight  |   .9874007   .3232803    -0.04   0.969     .5197632    1.875778
 Overweight  |    .727926   .2078227    -1.11   0.266      .415977    1.273811
      Obese  |   .7283344   .1899886    -1.22   0.224     .4368093    1.214422
Morbidly ..  |   .6931594   .3391256    -0.75   0.454     .2656966    1.808341
             |
     smoking |
Current s..  |   .8023008   .2389594    -0.74   0.460     .4475207    1.438339
  Ex-smoker  |   .8003303   .3167807    -0.56   0.574     .3684284    1.738543
             |
severe_dis~e |   .8480555   .1843958    -0.76   0.448     .5537891    1.298686
covid_vacc~t |   .8760408   .2909802    -0.40   0.690      .456872    1.679787
 liver_trans |   1.71e-15   1.22e-15   -47.48   0.000     4.20e-16    6.96e-15
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/adj_model_composite_any.ster not found)
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_composite_any.dta not found)
file ./output/tempdata/surv_adj_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.03180         0.15        1         0.7014
      age_tv      |      0.11231         1.73        1         0.1878
      male        |     -0.07729         0.90        1         0.3431
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.01567         0.03        1         0.8578
      2.eth_bin   |     -0.05579         0.46        1         0.4996
      1b.imd      |            .            .        1             .
      2.imd       |      0.08026         0.78        1         0.3762
      3.imd       |     -0.14633         3.14        1         0.0766
      4.imd       |      0.19434         4.65        1         0.0310
      5.imd       |      0.09953         1.41        1         0.2354
      6.imd       |      0.11514         1.67        1         0.1961
      1.bmi_cat   |      0.12890         2.02        1         0.1548
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.18503         4.16        1         0.0414
      4.bmi_cat   |      0.22542         6.16        1         0.0130
      5.bmi_cat   |      0.06452         0.65        1         0.4219
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.00473         0.00        1         0.9556
      2.smoking   |     -0.02962         0.13        1         0.7185
      severe_dis~e|      0.07031         0.77        1         0.3814
      covid_vacc~t|     -0.01038         0.01        1         0.9036
      liver_trans |      0.03497         0.02        1         0.8977
      ------------+---------------------------------------------------
      global test |                     24.98       19         0.1613
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_composite_any.svg not found)
(file ./output/graphs/schoenplot_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood =  -468.2695
Iteration 2:   log pseudolikelihood = -468.11716
Iteration 3:   log pseudolikelihood = -468.07695
Iteration 4:   log pseudolikelihood = -468.06219
Iteration 5:   log pseudolikelihood = -468.05676
Iteration 6:   log pseudolikelihood = -468.05477
Iteration 7:   log pseudolikelihood = -468.05403
Iteration 8:   log pseudolikelihood = -468.05376
Iteration 9:   log pseudolikelihood = -468.05366
Iteration 10:  log pseudolikelihood = -468.05363
Iteration 11:  log pseudolikelihood = -468.05361
Iteration 12:  log pseudolikelihood = -468.05361
Iteration 13:  log pseudolikelihood = -468.05361
Iteration 14:  log pseudolikelihood =  -468.0536
Iteration 15:  log pseudolikelihood =  -468.0536
Iteration 16:  log pseudolikelihood =  -468.0536
Iteration 17:  log pseudolikelihood =  -468.0536
Iteration 18:  log pseudolikelihood =  -468.0536
Iteration 19:  log pseudolikelihood =  -468.0536
Iteration 20:  log pseudolikelihood =  -468.0536
Iteration 21:  log pseudolikelihood =  -468.0536
Iteration 22:  log pseudolikelihood =  -468.0536
Iteration 23:  log pseudolikelihood =  -468.0536
Iteration 24:  log pseudolikelihood =  -468.0536
Iteration 25:  log pseudolikelihood =  -468.0536
Iteration 26:  log pseudolikelihood =  -468.0536
Iteration 27:  log pseudolikelihood =  -468.0536
Iteration 28:  log pseudolikelihood =  -468.0536
Iteration 29:  log pseudolikelihood =  -468.0536
Iteration 30:  log pseudolikelihood =  -468.0536
Iteration 31:  log pseudolikelihood =  -468.0536
Iteration 32:  log pseudolikelihood =  -468.0536
Iteration 33:  log pseudolikelihood =  -468.0536
Iteration 34:  log pseudolikelihood =  -468.0536
Iteration 35:  log pseudolikelihood =  -468.0536
Iteration 36:  log pseudolikelihood =  -468.0536
Refining estimates:
Iteration 0:   log pseudolikelihood =  -468.0536
Iteration 1:   log pseudolikelihood =  -468.0536

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(22)    =     2655.05
Log pseudolikelihood =    -468.0536             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    .777457   .2735535    -0.72   0.474     .3900995    1.549449
      age_tv |   .9996103   .0042992    -0.09   0.928     .9912194    1.008072
        male |   1.063057   .2225318     0.29   0.770     .7052984    1.602287
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6360155   .2312636    -1.24   0.213       .31186    1.297107
      Asian  |    .936229   .2985346    -0.21   0.836     .5011412    1.749057
      Black  |   .6638628   .2511392    -1.08   0.279      .316278    1.393438
      Other  |   .9786273   .3268054    -0.06   0.948     .5085865    1.883085
    Unknown  |   .7167215   .4150121    -0.58   0.565     .2303927    2.229627
             |
         imd |
          2  |    .943248   .3186806    -0.17   0.863     .4864561    1.828977
          3  |   .9252776   .3316472    -0.22   0.828     .4583275    1.867963
          4  |   1.279872   .3983845     0.79   0.428     .6953663    2.355696
          5  |   1.199026   .3956413     0.55   0.582     .6279981    2.289278
          6  |    1.57589   .7648139     0.94   0.349     .6087223    4.079741
             |
     bmi_cat |
Underweight  |   .9571532   .3079722    -0.14   0.892     .5094482    1.798303
 Overweight  |   .7308494   .2092787    -1.09   0.274     .4169523     1.28106
      Obese  |   .7019085   .1859679    -1.34   0.182     .4175977    1.179785
Morbidly ..  |   .7215158   .3499336    -0.67   0.501     .2788784     1.86671
             |
     smoking |
Current s..  |    .813356   .2442996    -0.69   0.492     .4514544    1.465371
  Ex-smoker  |   .8480037   .3427491    -0.41   0.683      .384022    1.872575
             |
severe_dis~e |   .8546775    .187336    -0.72   0.474     .5561964    1.313338
covid_vacc~t |   .8707133   .2875122    -0.42   0.675     .4558331      1.6632
 liver_trans |   7.63e-17   5.91e-17   -47.93   0.000     1.67e-17    3.48e-16
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  191
no udca events = 191
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      583882           0     583882     583882
19462.733
981.36267

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 23

. 
. * sensitivity analysis - 90 day exposure 
. file write tablecontent _n ("90 day exposure sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_90_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_90_`outcome'.svg, as(svg) replace
 10.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model4
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_90_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_90_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model5
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_90_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model6
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_90_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_90_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_90_`outcome' adj_plot_90_`outcome'
 28.         graph export ./output/graphs/schoenplot_90_`outcome'.svg, as(svg) 
> replace 
 29.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1
 34.         safecount if unexposed_ever==0 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1
 55.         qui safecount if exposed_ever==1 & number==1
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. }

Contains data from ./output/an_dataset_90_died_covid_any.dta
  obs:         3,012                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      3,012  total observations
          0  exclusions
------------------------------------------------------------------------------
      3,012  observations remaining, representing
      1,000  subjects
        165  failures in single-failure-per-subject data
    676,087  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  165

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_90_died_covid_any.svg not found)
(file ./output/graphs/km_90_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -368.5049
Iteration 1:   log pseudolikelihood = -368.18864
Iteration 2:   log pseudolikelihood = -368.18435
Iteration 3:   log pseudolikelihood = -368.18435
Refining estimates:
Iteration 0:   log pseudolikelihood = -368.18435

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,512
No. of failures      =          165
Time at risk         =       676087
                                                Wald chi2(1)     =        0.60
Log pseudolikelihood =   -368.18435             Prob > chi2      =      0.4398

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7222328    .304197    -0.77   0.440     .3163442    1.648901
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_90_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_90_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.00691         0.00        1         0.9524
      ------------+---------------------------------------------------
      global test |                      0.00        1         0.9524
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood = -362.98723
Iteration 2:   log pseudolikelihood = -362.98313
Iteration 3:   log pseudolikelihood = -362.98313
Refining estimates:
Iteration 0:   log pseudolikelihood = -362.98313

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(3)     =        0.75
Log pseudolikelihood =   -362.98313             Prob > chi2      =      0.8603

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7228625   .3051761    -0.77   0.442     .3160078    1.653536
      age_tv |    1.00006   .0048906     0.01   0.990     .9905209    1.009692
        male |   .9094817   .2088509    -0.41   0.679     .5798643    1.426467
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_90_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_90_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.00333         0.00        1         0.9763
      age_tv      |      0.06000         0.30        1         0.5825
      male        |     -0.04413         0.15        1         0.7028
      ------------+---------------------------------------------------
      global test |                      0.44        3         0.9309
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood = -358.59279
Iteration 2:   log pseudolikelihood = -358.36403
Iteration 3:   log pseudolikelihood = -358.33385
Iteration 4:   log pseudolikelihood = -358.32286
Iteration 5:   log pseudolikelihood = -358.31881
Iteration 6:   log pseudolikelihood = -358.31733
Iteration 7:   log pseudolikelihood = -358.31678
Iteration 8:   log pseudolikelihood = -358.31658
Iteration 9:   log pseudolikelihood =  -358.3165
Iteration 10:  log pseudolikelihood = -358.31648
Iteration 11:  log pseudolikelihood = -358.31647
Iteration 12:  log pseudolikelihood = -358.31646
Iteration 13:  log pseudolikelihood = -358.31646
Iteration 14:  log pseudolikelihood = -358.31646
Iteration 15:  log pseudolikelihood = -358.31646
Iteration 16:  log pseudolikelihood = -358.31646
Iteration 17:  log pseudolikelihood = -358.31646
Iteration 18:  log pseudolikelihood = -358.31646
Iteration 19:  log pseudolikelihood = -358.31646
Iteration 20:  log pseudolikelihood = -358.31646
Iteration 21:  log pseudolikelihood = -358.31646
Iteration 22:  log pseudolikelihood = -358.31646
Iteration 23:  log pseudolikelihood = -358.31646
Iteration 24:  log pseudolikelihood = -358.31646
Iteration 25:  log pseudolikelihood = -358.31646
Iteration 26:  log pseudolikelihood = -358.31646
Iteration 27:  log pseudolikelihood = -358.31646
Iteration 28:  log pseudolikelihood = -358.31646
Iteration 29:  log pseudolikelihood = -358.31646
Iteration 30:  log pseudolikelihood = -358.31646
Iteration 31:  log pseudolikelihood = -358.31646
Refining estimates:
Iteration 0:   log pseudolikelihood = -358.31646
Iteration 1:   log pseudolikelihood = -358.31646

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(19)    =     1786.61
Log pseudolikelihood =   -358.31646             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6881514    .296081    -0.87   0.385     .2961077    1.599257
      age_tv |   .9996801   .0047782    -0.07   0.947     .9903587    1.009089
        male |    .925549   .2215708    -0.32   0.747     .5789312    1.479694
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .8109154   .2559539    -0.66   0.507     .4368234    1.505377
    Unknown  |    .471873   .3827058    -0.93   0.354     .0962654    2.313023
             |
         imd |
          2  |   .9743507   .3588186    -0.07   0.944     .4734217    2.005314
          3  |   .5708025   .2489017    -1.29   0.198     .2428368    1.341706
          4  |    1.06023   .3724103     0.17   0.868     .5326136    2.110514
          5  |    1.13625    .402084     0.36   0.718     .5678844    2.273463
          6  |   1.178361   .6503393     0.30   0.766     .3994833    3.475825
             |
     bmi_cat |
Underweight  |   1.625412   .5656774     1.40   0.163     .8217269    3.215137
 Overweight  |   .9649102   .3058579    -0.11   0.910     .5184089    1.795979
      Obese  |   .8253337   .2606117    -0.61   0.543     .4444774    1.532532
Morbidly ..  |   1.109724   .5626724     0.21   0.837     .4107934    2.997828
             |
     smoking |
Current s..  |   .9738044   .3783693    -0.07   0.946     .4547152     2.08547
  Ex-smoker  |   1.001982    .491756     0.00   0.997     .3829171    2.621896
             |
severe_dis~e |    .851022   .2111129    -0.65   0.516     .5233393    1.383879
covid_vacc~t |   .9056232    .293203    -0.31   0.759     .4801356     1.70817
 liver_trans |   1.25e-14   1.02e-14   -39.24   0.000     2.52e-15    6.17e-14
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_90_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_90_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03003         0.11        1         0.7359
      age_tv      |      0.22466         5.28        1         0.0216
      male        |     -0.03675         0.20        1         0.6550
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.03580         0.13        1         0.7144
      2.eth_bin   |     -0.01626         0.03        1         0.8577
      1b.imd      |            .            .        1             .
      2.imd       |      0.12346         1.48        1         0.2241
      3.imd       |     -0.15162         2.33        1         0.1266
      4.imd       |      0.32627        10.72        1         0.0011
      5.imd       |      0.18301         3.62        1         0.0570
      6.imd       |      0.23901         5.10        1         0.0239
      1.bmi_cat   |      0.13149         1.93        1         0.1645
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.25677         6.55        1         0.0105
      4.bmi_cat   |      0.27759         9.32        1         0.0023
      5.bmi_cat   |      0.16502         3.80        1         0.0514
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.26308         8.92        1         0.0028
      2.smoking   |      0.10270         1.73        1         0.1886
      severe_dis~e|      0.02099         0.05        1         0.8169
      covid_vacc~t|      0.06966         0.44        1         0.5089
      liver_trans |      0.09131         0.10        1         0.7476
      ------------+---------------------------------------------------
      global test |                     38.45       19         0.0052
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_90_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_90_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood =   -356.829
Iteration 2:   log pseudolikelihood = -356.59375
Iteration 3:   log pseudolikelihood =  -356.5632
Iteration 4:   log pseudolikelihood = -356.55204
Iteration 5:   log pseudolikelihood = -356.54793
Iteration 6:   log pseudolikelihood = -356.54642
Iteration 7:   log pseudolikelihood = -356.54587
Iteration 8:   log pseudolikelihood = -356.54566
Iteration 9:   log pseudolikelihood = -356.54559
Iteration 10:  log pseudolikelihood = -356.54556
Iteration 11:  log pseudolikelihood = -356.54555
Iteration 12:  log pseudolikelihood = -356.54555
Iteration 13:  log pseudolikelihood = -356.54555
Iteration 14:  log pseudolikelihood = -356.54555
Iteration 15:  log pseudolikelihood = -356.54555
Iteration 16:  log pseudolikelihood = -356.54555
Iteration 17:  log pseudolikelihood = -356.54555
Iteration 18:  log pseudolikelihood = -356.54555
Iteration 19:  log pseudolikelihood = -356.54555
Iteration 20:  log pseudolikelihood = -356.54555
Iteration 21:  log pseudolikelihood = -356.54555
Iteration 22:  log pseudolikelihood = -356.54555
Iteration 23:  log pseudolikelihood = -356.54555
Iteration 24:  log pseudolikelihood = -356.54555
Iteration 25:  log pseudolikelihood = -356.54555
Iteration 26:  log pseudolikelihood = -356.54555
Iteration 27:  log pseudolikelihood = -356.54555
Iteration 28:  log pseudolikelihood = -356.54555
Iteration 29:  log pseudolikelihood = -356.54555
Iteration 30:  log pseudolikelihood = -356.54555
Iteration 31:  log pseudolikelihood = -356.54555
Refining estimates:
Iteration 0:   log pseudolikelihood = -356.54555
Iteration 1:   log pseudolikelihood = -356.54555

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(22)    =     1514.39
Log pseudolikelihood =   -356.54555             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6946805   .3025613    -0.84   0.403     .2958371    1.631239
      age_tv |   1.000153   .0047998     0.03   0.975     .9907898    1.009605
        male |   .9534143   .2354275    -0.19   0.847     .5876161    1.546926
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .5884633   .2488396    -1.25   0.210     .2569079    1.347912
      Asian  |    .956933   .3530997    -0.12   0.905     .4642969    1.972274
      Black  |    .645843   .2791964    -1.01   0.312     .2767927    1.506952
      Other  |   1.066098   .3987501     0.17   0.864     .5121816    2.219065
    Unknown  |   .4802401   .3893939    -0.90   0.366     .0980115    2.353096
             |
         imd |
          2  |    1.02659    .380599     0.07   0.944     .4963888    2.123109
          3  |   .5872642    .254163    -1.23   0.219     .2514436    1.371597
          4  |   1.056761   .3685125     0.16   0.874     .5335151    2.093181
          5  |   1.203537   .4246951     0.53   0.600     .6026896    2.403394
          6  |   1.203514   .6518704     0.34   0.732     .4163007    3.479327
             |
     bmi_cat |
Underweight  |   1.549968   .5288372     1.28   0.199     .7941442    3.025145
 Overweight  |    .963259   .3025332    -0.12   0.905       .52048    1.782716
      Obese  |   .7813588   .2547593    -0.76   0.449     .4124006    1.480409
Morbidly ..  |   1.165445   .5868384     0.30   0.761      .434395    3.126789
             |
     smoking |
Current s..  |   .9945141   .3903851    -0.01   0.989     .4607672    2.146547
  Ex-smoker  |   1.088157   .5515482     0.17   0.868     .4029468    2.938566
             |
severe_dis~e |   .8526731   .2131665    -0.64   0.524     .5223769    1.391814
covid_vacc~t |    .897104   .2894663    -0.34   0.736      .476637    1.688488
 liver_trans |   1.04e-14   9.31e-15   -35.87   0.000     1.79e-15    6.03e-14
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,012       66.80       66.80
          1 |      1,000       33.20      100.00
------------+-----------------------------------
      Total |      3,012      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  148
no udca events = 148
(2012 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      606518           0     606518     606518
20217.267
732.04752

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 17

Contains data from ./output/an_dataset_90_hosp_any.dta
  obs:         2,933                          
 vars:            21                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
         57  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  57

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_90_hosp_any.svg not found)
(file ./output/graphs/km_90_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =   -136.627
Iteration 1:   log pseudolikelihood = -136.62181
Iteration 2:   log pseudolikelihood = -136.62181
Refining estimates:
Iteration 0:   log pseudolikelihood = -136.62181

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,470
No. of failures      =           57
Time at risk         =       652131
                                                Wald chi2(1)     =        0.01
Log pseudolikelihood =   -136.62181             Prob > chi2      =      0.9186

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9401447   .5674727    -0.10   0.919     .2880104    3.068889
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_90_hosp_any.dta not found)
file ./output/tempdata/surv_crude_90_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17371         0.86        1         0.3550
      ------------+---------------------------------------------------
      global test |                      0.86        1         0.3550
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -130.20759
Iteration 2:   log pseudolikelihood = -130.20712
Iteration 3:   log pseudolikelihood = -130.20712
Refining estimates:
Iteration 0:   log pseudolikelihood = -130.20712

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(3)     =        2.79
Log pseudolikelihood =   -130.20712             Prob > chi2      =      0.4252

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9939013   .6026663    -0.01   0.992     .3028343    3.261982
      age_tv |   1.007445   .0080114     0.93   0.351     .9918646     1.02327
        male |   1.661434   .6425731     1.31   0.189     .7785275     3.54562
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_90_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_90_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.12910         0.63        1         0.4282
      age_tv      |      0.10787         0.34        1         0.5610
      male        |      0.05033         0.09        1         0.7652
      ------------+---------------------------------------------------
      global test |                      1.12        3         0.7714
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -121.21653
Iteration 2:   log pseudolikelihood = -119.83842
Iteration 3:   log pseudolikelihood = -119.57978
Iteration 4:   log pseudolikelihood = -119.48811
Iteration 5:   log pseudolikelihood = -119.45456
Iteration 6:   log pseudolikelihood = -119.44224
Iteration 7:   log pseudolikelihood = -119.43771
Iteration 8:   log pseudolikelihood = -119.43605
Iteration 9:   log pseudolikelihood = -119.43544
Iteration 10:  log pseudolikelihood = -119.43521
Iteration 11:  log pseudolikelihood = -119.43513
Iteration 12:  log pseudolikelihood =  -119.4351
Iteration 13:  log pseudolikelihood = -119.43509
Iteration 14:  log pseudolikelihood = -119.43508
Iteration 15:  log pseudolikelihood = -119.43508
Iteration 16:  log pseudolikelihood = -119.43508
Iteration 17:  log pseudolikelihood = -119.43508
Iteration 18:  log pseudolikelihood = -119.43508
Iteration 19:  log pseudolikelihood = -119.43508
Iteration 20:  log pseudolikelihood = -119.43508
Iteration 21:  log pseudolikelihood = -119.43508
Iteration 22:  log pseudolikelihood = -119.43508
Iteration 23:  log pseudolikelihood = -119.43508
Iteration 24:  log pseudolikelihood = -119.43508
Iteration 25:  log pseudolikelihood = -119.43508
Iteration 26:  log pseudolikelihood = -119.43508
Iteration 27:  log pseudolikelihood = -119.43508
Iteration 28:  log pseudolikelihood = -119.43508
Iteration 29:  log pseudolikelihood = -119.43508
Iteration 30:  log pseudolikelihood = -119.43508
Iteration 31:  log pseudolikelihood = -119.43508
Iteration 32:  log pseudolikelihood = -119.43508
Iteration 33:  log pseudolikelihood = -119.43508
Iteration 34:  log pseudolikelihood = -119.43508
Iteration 35:  log pseudolikelihood = -119.43508
Iteration 36:  log pseudolikelihood = -119.43508
Iteration 37:  log pseudolikelihood = -119.43508
Iteration 38:  log pseudolikelihood = -119.43508
Iteration 39:  log pseudolikelihood = -119.43508
Iteration 40:  log pseudolikelihood = -119.43508
Iteration 41:  log pseudolikelihood = -119.43508
Iteration 42:  log pseudolikelihood = -119.43508
Iteration 43:  log pseudolikelihood = -119.43508
Iteration 44:  log pseudolikelihood = -119.43508
Iteration 45:  log pseudolikelihood = -119.43508
Refining estimates:
Iteration 0:   log pseudolikelihood = -119.43508

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(17)    =       25.27
Log pseudolikelihood =   -119.43508             Prob > chi2      =      0.0888

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.000572   .6238069     0.00   0.999     .2948265    3.395707
      age_tv |   1.007529     .00876     0.86   0.388     .9905056    1.024846
        male |    1.63195   .6681176     1.20   0.232     .7315207    3.640721
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .7255643   .3504021    -0.66   0.507     .2815781    1.869618
    Unknown  |   1.151006   .9455321     0.17   0.864     .2300543     5.75871
             |
         imd |
          2  |   .7167915   .6550641    -0.36   0.716     .1195346    4.298255
          3  |   3.069491    2.20892     1.56   0.119     .7490491    12.57832
          4  |   2.877135   2.060902     1.48   0.140     .7067106    11.71329
          5  |   1.482383   1.183281     0.49   0.622     .3101038    7.086209
          6  |   4.363748   3.787924     1.70   0.090     .7961222    23.91882
             |
     bmi_cat |
Underweight  |   1.65e-20          .        .       .            .           .
 Overweight  |   .4488828   .2449465    -1.47   0.142     .1540455    1.308027
      Obese  |   .6640864    .296442    -0.92   0.359     .2768574    1.592917
Morbidly ..  |   .3687616   .3939487    -0.93   0.350     .0454366    2.992856
             |
     smoking |
Current s..  |   .7327329   .3294168    -0.69   0.489     .3035768    1.768572
  Ex-smoker  |   .4219229   .3450214    -1.06   0.291     .0849523    2.095516
             |
severe_dis~e |   .8232348   .3216538    -0.50   0.619     .3827743    1.770536
covid_vacc~t |   1.238093   1.001088     0.26   0.792     .2538018    6.039649
 liver_trans |   6.75e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_90_hosp_any.dta not found)
file ./output/tempdata/surv_adj_90_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.24881         4.25        1         0.0392
      age_tv      |      0.15144         1.83        1         0.1762
      male        |     -0.12331         0.99        1         0.3205
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.18251         2.10        1         0.1469
      2.eth_bin   |     -0.05291         0.16        1         0.6932
      1b.imd      |            .            .        1             .
      2.imd       |      0.04371         0.10        1         0.7538
      3.imd       |     -0.19652         2.66        1         0.1030
      4.imd       |     -0.11737         0.90        1         0.3436
      5.imd       |     -0.33639         7.06        1         0.0079
      6.imd       |     -0.20120         2.69        1         0.1009
      1.bmi_cat   |            .            .        1             .
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.02230         0.04        1         0.8510
      4.bmi_cat   |     -0.08963         0.37        1         0.5448
      5.bmi_cat   |     -0.00857         0.00        1         0.9446
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.56918        20.30        1         0.0000
      2.smoking   |     -0.19604         2.67        1         0.1026
      severe_dis~e|      0.18338         1.83        1         0.1758
      covid_vacc~t|     -0.26812         6.77        1         0.0093
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     32.44       17         0.0132
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_90_hosp_any.svg not found)
(file ./output/graphs/schoenplot_90_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -120.45992
Iteration 2:   log pseudolikelihood = -119.08244
Iteration 3:   log pseudolikelihood = -118.80856
Iteration 4:   log pseudolikelihood = -118.71129
Iteration 5:   log pseudolikelihood = -118.67571
Iteration 6:   log pseudolikelihood = -118.66264
Iteration 7:   log pseudolikelihood = -118.65784
Iteration 8:   log pseudolikelihood = -118.65607
Iteration 9:   log pseudolikelihood = -118.65543
Iteration 10:  log pseudolikelihood = -118.65519
Iteration 11:  log pseudolikelihood =  -118.6551
Iteration 12:  log pseudolikelihood = -118.65507
Iteration 13:  log pseudolikelihood = -118.65505
Iteration 14:  log pseudolikelihood = -118.65505
Iteration 15:  log pseudolikelihood = -118.65505
Iteration 16:  log pseudolikelihood = -118.65505
Iteration 17:  log pseudolikelihood = -118.65505
Iteration 18:  log pseudolikelihood = -118.65505
Iteration 19:  log pseudolikelihood = -118.65505
Iteration 20:  log pseudolikelihood = -118.65505
Iteration 21:  log pseudolikelihood = -118.65505
Iteration 22:  log pseudolikelihood = -118.65505
Iteration 23:  log pseudolikelihood = -118.65505
Iteration 24:  log pseudolikelihood = -118.65505
Iteration 25:  log pseudolikelihood = -118.65505
Iteration 26:  log pseudolikelihood = -118.65505
Iteration 27:  log pseudolikelihood = -118.65505
Iteration 28:  log pseudolikelihood = -118.65505
Iteration 29:  log pseudolikelihood = -118.65505
Iteration 30:  log pseudolikelihood = -118.65505
Iteration 31:  log pseudolikelihood = -118.65505
Iteration 32:  log pseudolikelihood = -118.65505
Iteration 33:  log pseudolikelihood = -118.65505
Iteration 34:  log pseudolikelihood = -118.65505
Iteration 35:  log pseudolikelihood = -118.65505
Refining estimates:
Iteration 0:   log pseudolikelihood = -118.65505
Iteration 1:   log pseudolikelihood = -118.65505

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(22)    =    17163.19
Log pseudolikelihood =   -118.65505             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9876841   .6006865    -0.02   0.984     .2998728    3.253112
      age_tv |   1.006807   .0087576     0.78   0.435     .9897875    1.024118
        male |   1.632711   .6641371     1.21   0.228     .7356416    3.623699
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6516351   .4362824    -0.64   0.522     .1754319    2.420474
      Asian  |   .9825718   .4948221    -0.03   0.972     .3661846    2.636504
      Black  |   .6075175   .4432585    -0.68   0.495     .1453794    2.538719
      Other  |   .4767897   .3573699    -0.99   0.323     .1097293     2.07172
    Unknown  |   1.162992   .9605629     0.18   0.855     .2304273    5.869744
             |
         imd |
          2  |   .7469669   .6912673    -0.32   0.753     .1217789    4.581743
          3  |   3.076964   2.186536     1.58   0.114     .7642687    12.38793
          4  |    2.84908   2.030441     1.47   0.142     .7048271    11.51666
          5  |   1.491545   1.235593     0.48   0.629     .2941053     7.56432
          6  |   4.486919   4.006552     1.68   0.093     .7796073    25.82382
             |
     bmi_cat |
Underweight  |   1.39e-16   4.82e-17  -105.02   0.000     7.01e-17    2.74e-16
 Overweight  |   .4599002   .2568861    -1.39   0.164     .1538894    1.374417
      Obese  |    .648709   .2766724    -1.01   0.310     .2811998    1.496528
Morbidly ..  |   .3687501   .3980992    -0.92   0.355     .0444409    3.059719
             |
     smoking |
Current s..  |   .7116886   .3105669    -0.78   0.436     .3025816    1.673931
  Ex-smoker  |    .447328   .3685129    -0.98   0.329     .0890017    2.248297
             |
severe_dis~e |   .8291129     .32414    -0.48   0.632     .3853348    1.783977
covid_vacc~t |    1.25724     1.0014     0.29   0.774     .2638947    5.989713
 liver_trans |   3.08e-16   2.92e-16   -37.64   0.000     4.79e-17    1.98e-15
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  51
no udca events = 51
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      583882           0     583882     583882
19462.733
262.03925

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 6

Contains data from ./output/an_dataset_90_composite_any.dta
  obs:         2,933                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
        214  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  214

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_90_composite_any.svg not found)
(file ./output/graphs/km_90_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -479.38698
Iteration 1:   log pseudolikelihood = -479.18954
Iteration 2:   log pseudolikelihood = -479.18833
Iteration 3:   log pseudolikelihood = -479.18833
Refining estimates:
Iteration 0:   log pseudolikelihood = -479.18833

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,470
No. of failures      =          214
Time at risk         =       652131
                                                Wald chi2(1)     =        0.39
Log pseudolikelihood =   -479.18833             Prob > chi2      =      0.5308

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8073394    .275669    -0.63   0.531     .4134379    1.576529
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_90_composite_any.dta not found)
file ./output/tempdata/surv_crude_90_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.06123         0.36        1         0.5495
      ------------+---------------------------------------------------
      global test |                      0.36        1         0.5495
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood = -473.48299
Iteration 2:   log pseudolikelihood = -473.48188
Iteration 3:   log pseudolikelihood = -473.48188
Refining estimates:
Iteration 0:   log pseudolikelihood = -473.48188

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(3)     =        0.58
Log pseudolikelihood =   -473.48188             Prob > chi2      =      0.8999

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8118702    .278129    -0.61   0.543     .4148428    1.588875
      age_tv |   1.000628   .0042815     0.15   0.883     .9922712    1.009055
        male |   1.082704   .2159606     0.40   0.690     .7323617    1.600641
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_90_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_90_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.04027         0.17        1         0.6798
      age_tv      |      0.04662         0.24        1         0.6261
      male        |     -0.07042         0.50        1         0.4811
      ------------+---------------------------------------------------
      global test |                      1.04        3         0.7908
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood = -469.64886
Iteration 2:   log pseudolikelihood = -469.50982
Iteration 3:   log pseudolikelihood = -469.46963
Iteration 4:   log pseudolikelihood = -469.45487
Iteration 5:   log pseudolikelihood = -469.44944
Iteration 6:   log pseudolikelihood = -469.44745
Iteration 7:   log pseudolikelihood = -469.44671
Iteration 8:   log pseudolikelihood = -469.44644
Iteration 9:   log pseudolikelihood = -469.44634
Iteration 10:  log pseudolikelihood = -469.44631
Iteration 11:  log pseudolikelihood = -469.44629
Iteration 12:  log pseudolikelihood = -469.44629
Iteration 13:  log pseudolikelihood = -469.44629
Iteration 14:  log pseudolikelihood = -469.44629
Iteration 15:  log pseudolikelihood = -469.44629
Iteration 16:  log pseudolikelihood = -469.44629
Iteration 17:  log pseudolikelihood = -469.44629
Iteration 18:  log pseudolikelihood = -469.44629
Iteration 19:  log pseudolikelihood = -469.44629
Iteration 20:  log pseudolikelihood = -469.44629
Iteration 21:  log pseudolikelihood = -469.44629
Iteration 22:  log pseudolikelihood = -469.44629
Iteration 23:  log pseudolikelihood = -469.44629
Iteration 24:  log pseudolikelihood = -469.44629
Iteration 25:  log pseudolikelihood = -469.44629
Iteration 26:  log pseudolikelihood = -469.44629
Iteration 27:  log pseudolikelihood = -469.44629
Iteration 28:  log pseudolikelihood = -469.44629
Iteration 29:  log pseudolikelihood = -469.44629
Iteration 30:  log pseudolikelihood = -469.44629
Iteration 31:  log pseudolikelihood = -469.44629
Iteration 32:  log pseudolikelihood = -469.44629
Refining estimates:
Iteration 0:   log pseudolikelihood = -469.44629
Iteration 1:   log pseudolikelihood = -469.44629
Iteration 2:   log pseudolikelihood = -469.44629

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(19)    =     2556.37
Log pseudolikelihood =   -469.44629             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7628878   .2672964    -0.77   0.440     .3839028    1.516003
      age_tv |   .9995636   .0043103    -0.10   0.919     .9911511    1.008047
        male |   1.046985   .2149927     0.22   0.823      .700085    1.565777
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .8066551   .2223432    -0.78   0.436     .4699656    1.384553
    Unknown  |   .7075908   .4091339    -0.60   0.550     .2278303    2.197621
             |
         imd |
          2  |    .893164   .2999467    -0.34   0.737     .4624625    1.724987
          3  |   .9086956   .3286111    -0.26   0.791        .4473    1.846027
          4  |   1.270959   .4002557     0.76   0.446     .6855947    2.356109
          5  |   1.150778   .3769742     0.43   0.668     .6055546    2.186905
          6  |   1.544149   .7445274     0.90   0.368     .6001691    3.972874
             |
     bmi_cat |
Underweight  |   .9874007   .3232803    -0.04   0.969     .5197632    1.875778
 Overweight  |    .727926   .2078227    -1.11   0.266      .415977    1.273811
      Obese  |   .7283344   .1899886    -1.22   0.224     .4368093    1.214422
Morbidly ..  |   .6931594   .3391256    -0.75   0.454     .2656966    1.808341
             |
     smoking |
Current s..  |   .8023008   .2389594    -0.74   0.460     .4475207    1.438339
  Ex-smoker  |   .8003303   .3167807    -0.56   0.574     .3684284    1.738543
             |
severe_dis~e |   .8480555   .1843958    -0.76   0.448     .5537891    1.298686
covid_vacc~t |   .8760408   .2909802    -0.40   0.690      .456872    1.679787
 liver_trans |   1.71e-15   1.22e-15   -47.48   0.000     4.20e-16    6.96e-15
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_90_composite_any.dta not found)
file ./output/tempdata/surv_adj_90_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.03180         0.15        1         0.7014
      age_tv      |      0.11231         1.73        1         0.1878
      male        |     -0.07729         0.90        1         0.3431
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.01567         0.03        1         0.8578
      2.eth_bin   |     -0.05579         0.46        1         0.4996
      1b.imd      |            .            .        1             .
      2.imd       |      0.08026         0.78        1         0.3762
      3.imd       |     -0.14633         3.14        1         0.0766
      4.imd       |      0.19434         4.65        1         0.0310
      5.imd       |      0.09953         1.41        1         0.2354
      6.imd       |      0.11514         1.67        1         0.1961
      1.bmi_cat   |      0.12890         2.02        1         0.1548
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.18503         4.16        1         0.0414
      4.bmi_cat   |      0.22542         6.16        1         0.0130
      5.bmi_cat   |      0.06452         0.65        1         0.4219
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.00473         0.00        1         0.9556
      2.smoking   |     -0.02962         0.13        1         0.7185
      severe_dis~e|      0.07031         0.77        1         0.3814
      covid_vacc~t|     -0.01038         0.01        1         0.9036
      liver_trans |      0.03497         0.02        1         0.8977
      ------------+---------------------------------------------------
      global test |                     24.98       19         0.1613
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_90_composite_any.svg not found)
(file ./output/graphs/schoenplot_90_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood =  -468.2695
Iteration 2:   log pseudolikelihood = -468.11716
Iteration 3:   log pseudolikelihood = -468.07695
Iteration 4:   log pseudolikelihood = -468.06219
Iteration 5:   log pseudolikelihood = -468.05676
Iteration 6:   log pseudolikelihood = -468.05477
Iteration 7:   log pseudolikelihood = -468.05403
Iteration 8:   log pseudolikelihood = -468.05376
Iteration 9:   log pseudolikelihood = -468.05366
Iteration 10:  log pseudolikelihood = -468.05363
Iteration 11:  log pseudolikelihood = -468.05361
Iteration 12:  log pseudolikelihood = -468.05361
Iteration 13:  log pseudolikelihood = -468.05361
Iteration 14:  log pseudolikelihood =  -468.0536
Iteration 15:  log pseudolikelihood =  -468.0536
Iteration 16:  log pseudolikelihood =  -468.0536
Iteration 17:  log pseudolikelihood =  -468.0536
Iteration 18:  log pseudolikelihood =  -468.0536
Iteration 19:  log pseudolikelihood =  -468.0536
Iteration 20:  log pseudolikelihood =  -468.0536
Iteration 21:  log pseudolikelihood =  -468.0536
Iteration 22:  log pseudolikelihood =  -468.0536
Iteration 23:  log pseudolikelihood =  -468.0536
Iteration 24:  log pseudolikelihood =  -468.0536
Iteration 25:  log pseudolikelihood =  -468.0536
Iteration 26:  log pseudolikelihood =  -468.0536
Iteration 27:  log pseudolikelihood =  -468.0536
Iteration 28:  log pseudolikelihood =  -468.0536
Iteration 29:  log pseudolikelihood =  -468.0536
Iteration 30:  log pseudolikelihood =  -468.0536
Iteration 31:  log pseudolikelihood =  -468.0536
Iteration 32:  log pseudolikelihood =  -468.0536
Iteration 33:  log pseudolikelihood =  -468.0536
Iteration 34:  log pseudolikelihood =  -468.0536
Iteration 35:  log pseudolikelihood =  -468.0536
Iteration 36:  log pseudolikelihood =  -468.0536
Refining estimates:
Iteration 0:   log pseudolikelihood =  -468.0536
Iteration 1:   log pseudolikelihood =  -468.0536

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(22)    =     2655.05
Log pseudolikelihood =    -468.0536             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    .777457   .2735535    -0.72   0.474     .3900995    1.549449
      age_tv |   .9996103   .0042992    -0.09   0.928     .9912194    1.008072
        male |   1.063057   .2225318     0.29   0.770     .7052984    1.602287
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6360155   .2312636    -1.24   0.213       .31186    1.297107
      Asian  |    .936229   .2985346    -0.21   0.836     .5011412    1.749057
      Black  |   .6638628   .2511392    -1.08   0.279      .316278    1.393438
      Other  |   .9786273   .3268054    -0.06   0.948     .5085865    1.883085
    Unknown  |   .7167215   .4150121    -0.58   0.565     .2303927    2.229627
             |
         imd |
          2  |    .943248   .3186806    -0.17   0.863     .4864561    1.828977
          3  |   .9252776   .3316472    -0.22   0.828     .4583275    1.867963
          4  |   1.279872   .3983845     0.79   0.428     .6953663    2.355696
          5  |   1.199026   .3956413     0.55   0.582     .6279981    2.289278
          6  |    1.57589   .7648139     0.94   0.349     .6087223    4.079741
             |
     bmi_cat |
Underweight  |   .9571532   .3079722    -0.14   0.892     .5094482    1.798303
 Overweight  |   .7308494   .2092787    -1.09   0.274     .4169523     1.28106
      Obese  |   .7019085   .1859679    -1.34   0.182     .4175977    1.179785
Morbidly ..  |   .7215158   .3499336    -0.67   0.501     .2788784     1.86671
             |
     smoking |
Current s..  |    .813356   .2442996    -0.69   0.492     .4514544    1.465371
  Ex-smoker  |   .8480037   .3427491    -0.41   0.683      .384022    1.872575
             |
severe_dis~e |   .8546775    .187336    -0.72   0.474     .5561964    1.313338
covid_vacc~t |   .8707133   .2875122    -0.42   0.675     .4558331      1.6632
 liver_trans |   7.63e-17   5.91e-17   -47.93   0.000     1.67e-17    3.48e-16
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  191
no udca events = 191
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      583882           0     583882     583882
19462.733
981.36267

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 23

. 
. * sensitivity analysis - 120 day overlap exposure 
. file write tablecontent _n ("120 day overlap exposure sensitivity analysis") 
> _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_overlap_120_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_o_120_`outcome'.svg, as(svg) repla
> ce
 10.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model7
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_o_120_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_o_120_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model8
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_o_120_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model9
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_o_120_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_o_120_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_o_120_`outcome' adj_plot_o_120_`outcome'
 28.         graph export ./output/graphs/schoenplot_o_120_`outcome'.svg, as(sv
> g) replace 
 29.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1
 34.         safecount if unexposed_ever==0 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1
 55.         qui safecount if exposed_ever==1 & number==1
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. 
. }

Contains data from ./output/an_dataset_overlap_120_died_covid_any.dta
  obs:         3,012                          
 vars:            20                          25 Sep 2023 12:28
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      3,012  total observations
          0  exclusions
------------------------------------------------------------------------------
      3,012  observations remaining, representing
      1,000  subjects
        165  failures in single-failure-per-subject data
    676,087  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  165

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_o_120_died_covid_any.svg not found)
(file ./output/graphs/km_o_120_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -368.5049
Iteration 1:   log pseudolikelihood = -368.18864
Iteration 2:   log pseudolikelihood = -368.18435
Iteration 3:   log pseudolikelihood = -368.18435
Refining estimates:
Iteration 0:   log pseudolikelihood = -368.18435

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,512
No. of failures      =          165
Time at risk         =       676087
                                                Wald chi2(1)     =        0.60
Log pseudolikelihood =   -368.18435             Prob > chi2      =      0.4398

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7222328    .304197    -0.77   0.440     .3163442    1.648901
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_o_120_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_o_120_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.00691         0.00        1         0.9524
      ------------+---------------------------------------------------
      global test |                      0.00        1         0.9524
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood = -362.98723
Iteration 2:   log pseudolikelihood = -362.98313
Iteration 3:   log pseudolikelihood = -362.98313
Refining estimates:
Iteration 0:   log pseudolikelihood = -362.98313

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(3)     =        0.75
Log pseudolikelihood =   -362.98313             Prob > chi2      =      0.8603

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7228625   .3051761    -0.77   0.442     .3160078    1.653536
      age_tv |    1.00006   .0048906     0.01   0.990     .9905209    1.009692
        male |   .9094817   .2088509    -0.41   0.679     .5798643    1.426467
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_o_120_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_o_120_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.00333         0.00        1         0.9763
      age_tv      |      0.06000         0.30        1         0.5825
      male        |     -0.04413         0.15        1         0.7028
      ------------+---------------------------------------------------
      global test |                      0.44        3         0.9309
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood = -358.59279
Iteration 2:   log pseudolikelihood = -358.36403
Iteration 3:   log pseudolikelihood = -358.33385
Iteration 4:   log pseudolikelihood = -358.32286
Iteration 5:   log pseudolikelihood = -358.31881
Iteration 6:   log pseudolikelihood = -358.31733
Iteration 7:   log pseudolikelihood = -358.31678
Iteration 8:   log pseudolikelihood = -358.31658
Iteration 9:   log pseudolikelihood =  -358.3165
Iteration 10:  log pseudolikelihood = -358.31648
Iteration 11:  log pseudolikelihood = -358.31647
Iteration 12:  log pseudolikelihood = -358.31646
Iteration 13:  log pseudolikelihood = -358.31646
Iteration 14:  log pseudolikelihood = -358.31646
Iteration 15:  log pseudolikelihood = -358.31646
Iteration 16:  log pseudolikelihood = -358.31646
Iteration 17:  log pseudolikelihood = -358.31646
Iteration 18:  log pseudolikelihood = -358.31646
Iteration 19:  log pseudolikelihood = -358.31646
Iteration 20:  log pseudolikelihood = -358.31646
Iteration 21:  log pseudolikelihood = -358.31646
Iteration 22:  log pseudolikelihood = -358.31646
Iteration 23:  log pseudolikelihood = -358.31646
Iteration 24:  log pseudolikelihood = -358.31646
Iteration 25:  log pseudolikelihood = -358.31646
Iteration 26:  log pseudolikelihood = -358.31646
Iteration 27:  log pseudolikelihood = -358.31646
Iteration 28:  log pseudolikelihood = -358.31646
Iteration 29:  log pseudolikelihood = -358.31646
Iteration 30:  log pseudolikelihood = -358.31646
Iteration 31:  log pseudolikelihood = -358.31646
Refining estimates:
Iteration 0:   log pseudolikelihood = -358.31646
Iteration 1:   log pseudolikelihood = -358.31646

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(19)    =     1786.61
Log pseudolikelihood =   -358.31646             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6881514    .296081    -0.87   0.385     .2961077    1.599257
      age_tv |   .9996801   .0047782    -0.07   0.947     .9903587    1.009089
        male |    .925549   .2215708    -0.32   0.747     .5789312    1.479694
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .8109154   .2559539    -0.66   0.507     .4368234    1.505377
    Unknown  |    .471873   .3827058    -0.93   0.354     .0962654    2.313023
             |
         imd |
          2  |   .9743507   .3588186    -0.07   0.944     .4734217    2.005314
          3  |   .5708025   .2489017    -1.29   0.198     .2428368    1.341706
          4  |    1.06023   .3724103     0.17   0.868     .5326136    2.110514
          5  |    1.13625    .402084     0.36   0.718     .5678844    2.273463
          6  |   1.178361   .6503393     0.30   0.766     .3994833    3.475825
             |
     bmi_cat |
Underweight  |   1.625412   .5656774     1.40   0.163     .8217269    3.215137
 Overweight  |   .9649102   .3058579    -0.11   0.910     .5184089    1.795979
      Obese  |   .8253337   .2606117    -0.61   0.543     .4444774    1.532532
Morbidly ..  |   1.109724   .5626724     0.21   0.837     .4107934    2.997828
             |
     smoking |
Current s..  |   .9738044   .3783693    -0.07   0.946     .4547152     2.08547
  Ex-smoker  |   1.001982    .491756     0.00   0.997     .3829171    2.621896
             |
severe_dis~e |    .851022   .2111129    -0.65   0.516     .5233393    1.383879
covid_vacc~t |   .9056232    .293203    -0.31   0.759     .4801356     1.70817
 liver_trans |   1.25e-14   1.02e-14   -39.24   0.000     2.52e-15    6.17e-14
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_o_120_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_o_120_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.03003         0.11        1         0.7359
      age_tv      |      0.22466         5.28        1         0.0216
      male        |     -0.03675         0.20        1         0.6550
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.03580         0.13        1         0.7144
      2.eth_bin   |     -0.01626         0.03        1         0.8577
      1b.imd      |            .            .        1             .
      2.imd       |      0.12346         1.48        1         0.2241
      3.imd       |     -0.15162         2.33        1         0.1266
      4.imd       |      0.32627        10.72        1         0.0011
      5.imd       |      0.18301         3.62        1         0.0570
      6.imd       |      0.23901         5.10        1         0.0239
      1.bmi_cat   |      0.13149         1.93        1         0.1645
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.25677         6.55        1         0.0105
      4.bmi_cat   |      0.27759         9.32        1         0.0023
      5.bmi_cat   |      0.16502         3.80        1         0.0514
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.26308         8.92        1         0.0028
      2.smoking   |      0.10270         1.73        1         0.1886
      severe_dis~e|      0.02099         0.05        1         0.8169
      covid_vacc~t|      0.06966         0.44        1         0.5089
      liver_trans |      0.09131         0.10        1         0.7476
      ------------+---------------------------------------------------
      global test |                     38.45       19         0.0052
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_o_120_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_o_120_died_covid_any.svg written in SVG format
> )

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -363.38139
Iteration 1:   log pseudolikelihood =   -356.829
Iteration 2:   log pseudolikelihood = -356.59375
Iteration 3:   log pseudolikelihood =  -356.5632
Iteration 4:   log pseudolikelihood = -356.55204
Iteration 5:   log pseudolikelihood = -356.54793
Iteration 6:   log pseudolikelihood = -356.54642
Iteration 7:   log pseudolikelihood = -356.54587
Iteration 8:   log pseudolikelihood = -356.54566
Iteration 9:   log pseudolikelihood = -356.54559
Iteration 10:  log pseudolikelihood = -356.54556
Iteration 11:  log pseudolikelihood = -356.54555
Iteration 12:  log pseudolikelihood = -356.54555
Iteration 13:  log pseudolikelihood = -356.54555
Iteration 14:  log pseudolikelihood = -356.54555
Iteration 15:  log pseudolikelihood = -356.54555
Iteration 16:  log pseudolikelihood = -356.54555
Iteration 17:  log pseudolikelihood = -356.54555
Iteration 18:  log pseudolikelihood = -356.54555
Iteration 19:  log pseudolikelihood = -356.54555
Iteration 20:  log pseudolikelihood = -356.54555
Iteration 21:  log pseudolikelihood = -356.54555
Iteration 22:  log pseudolikelihood = -356.54555
Iteration 23:  log pseudolikelihood = -356.54555
Iteration 24:  log pseudolikelihood = -356.54555
Iteration 25:  log pseudolikelihood = -356.54555
Iteration 26:  log pseudolikelihood = -356.54555
Iteration 27:  log pseudolikelihood = -356.54555
Iteration 28:  log pseudolikelihood = -356.54555
Iteration 29:  log pseudolikelihood = -356.54555
Iteration 30:  log pseudolikelihood = -356.54555
Iteration 31:  log pseudolikelihood = -356.54555
Refining estimates:
Iteration 0:   log pseudolikelihood = -356.54555
Iteration 1:   log pseudolikelihood = -356.54555

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,498
No. of failures      =          162
Time at risk         =       671219
                                                Wald chi2(22)    =     1514.39
Log pseudolikelihood =   -356.54555             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6946805   .3025613    -0.84   0.403     .2958371    1.631239
      age_tv |   1.000153   .0047998     0.03   0.975     .9907898    1.009605
        male |   .9534143   .2354275    -0.19   0.847     .5876161    1.546926
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .5884633   .2488396    -1.25   0.210     .2569079    1.347912
      Asian  |    .956933   .3530997    -0.12   0.905     .4642969    1.972274
      Black  |    .645843   .2791964    -1.01   0.312     .2767927    1.506952
      Other  |   1.066098   .3987501     0.17   0.864     .5121816    2.219065
    Unknown  |   .4802401   .3893939    -0.90   0.366     .0980115    2.353096
             |
         imd |
          2  |    1.02659    .380599     0.07   0.944     .4963888    2.123109
          3  |   .5872642    .254163    -1.23   0.219     .2514436    1.371597
          4  |   1.056761   .3685125     0.16   0.874     .5335151    2.093181
          5  |   1.203537   .4246951     0.53   0.600     .6026896    2.403394
          6  |   1.203514   .6518704     0.34   0.732     .4163007    3.479327
             |
     bmi_cat |
Underweight  |   1.549968   .5288372     1.28   0.199     .7941442    3.025145
 Overweight  |    .963259   .3025332    -0.12   0.905       .52048    1.782716
      Obese  |   .7813588   .2547593    -0.76   0.449     .4124006    1.480409
Morbidly ..  |   1.165445   .5868384     0.30   0.761      .434395    3.126789
             |
     smoking |
Current s..  |   .9945141   .3903851    -0.01   0.989     .4607672    2.146547
  Ex-smoker  |   1.088157   .5515482     0.17   0.868     .4029468    2.938566
             |
severe_dis~e |   .8526731   .2131665    -0.64   0.524     .5223769    1.391814
covid_vacc~t |    .897104   .2894663    -0.34   0.736      .476637    1.688488
 liver_trans |   1.04e-14   9.31e-15   -35.87   0.000     1.79e-15    6.03e-14
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,012       66.80       66.80
          1 |      1,000       33.20      100.00
------------+-----------------------------------
      Total |      3,012      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  148
no udca events = 148
(2012 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      606518           0     606518     606518
20217.267
732.04752

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 17

Contains data from ./output/an_dataset_overlap_120_hosp_any.dta
  obs:         2,933                          
 vars:            21                          25 Sep 2023 12:28
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
         57  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  57

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_o_120_hosp_any.svg not found)
(file ./output/graphs/km_o_120_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =   -136.627
Iteration 1:   log pseudolikelihood = -136.62181
Iteration 2:   log pseudolikelihood = -136.62181
Refining estimates:
Iteration 0:   log pseudolikelihood = -136.62181

Stratified Cox regr. -- no ties

No. of subjects      =        1,000             Number of obs    =       1,470
No. of failures      =           57
Time at risk         =       652131
                                                Wald chi2(1)     =        0.01
Log pseudolikelihood =   -136.62181             Prob > chi2      =      0.9186

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9401447   .5674727    -0.10   0.919     .2880104    3.068889
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_o_120_hosp_any.dta not found)
file ./output/tempdata/surv_crude_o_120_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17371         0.86        1         0.3550
      ------------+---------------------------------------------------
      global test |                      0.86        1         0.3550
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -130.20759
Iteration 2:   log pseudolikelihood = -130.20712
Iteration 3:   log pseudolikelihood = -130.20712
Refining estimates:
Iteration 0:   log pseudolikelihood = -130.20712

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(3)     =        2.79
Log pseudolikelihood =   -130.20712             Prob > chi2      =      0.4252

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9939013   .6026663    -0.01   0.992     .3028343    3.261982
      age_tv |   1.007445   .0080114     0.93   0.351     .9918646     1.02327
        male |   1.661434   .6425731     1.31   0.189     .7785275     3.54562
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_o_120_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_o_120_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.12910         0.63        1         0.4282
      age_tv      |      0.10787         0.34        1         0.5610
      male        |      0.05033         0.09        1         0.7652
      ------------+---------------------------------------------------
      global test |                      1.12        3         0.7714
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -121.21653
Iteration 2:   log pseudolikelihood = -119.83842
Iteration 3:   log pseudolikelihood = -119.57978
Iteration 4:   log pseudolikelihood = -119.48811
Iteration 5:   log pseudolikelihood = -119.45456
Iteration 6:   log pseudolikelihood = -119.44224
Iteration 7:   log pseudolikelihood = -119.43771
Iteration 8:   log pseudolikelihood = -119.43605
Iteration 9:   log pseudolikelihood = -119.43544
Iteration 10:  log pseudolikelihood = -119.43521
Iteration 11:  log pseudolikelihood = -119.43513
Iteration 12:  log pseudolikelihood =  -119.4351
Iteration 13:  log pseudolikelihood = -119.43509
Iteration 14:  log pseudolikelihood = -119.43508
Iteration 15:  log pseudolikelihood = -119.43508
Iteration 16:  log pseudolikelihood = -119.43508
Iteration 17:  log pseudolikelihood = -119.43508
Iteration 18:  log pseudolikelihood = -119.43508
Iteration 19:  log pseudolikelihood = -119.43508
Iteration 20:  log pseudolikelihood = -119.43508
Iteration 21:  log pseudolikelihood = -119.43508
Iteration 22:  log pseudolikelihood = -119.43508
Iteration 23:  log pseudolikelihood = -119.43508
Iteration 24:  log pseudolikelihood = -119.43508
Iteration 25:  log pseudolikelihood = -119.43508
Iteration 26:  log pseudolikelihood = -119.43508
Iteration 27:  log pseudolikelihood = -119.43508
Iteration 28:  log pseudolikelihood = -119.43508
Iteration 29:  log pseudolikelihood = -119.43508
Iteration 30:  log pseudolikelihood = -119.43508
Iteration 31:  log pseudolikelihood = -119.43508
Iteration 32:  log pseudolikelihood = -119.43508
Iteration 33:  log pseudolikelihood = -119.43508
Iteration 34:  log pseudolikelihood = -119.43508
Iteration 35:  log pseudolikelihood = -119.43508
Iteration 36:  log pseudolikelihood = -119.43508
Iteration 37:  log pseudolikelihood = -119.43508
Iteration 38:  log pseudolikelihood = -119.43508
Iteration 39:  log pseudolikelihood = -119.43508
Iteration 40:  log pseudolikelihood = -119.43508
Iteration 41:  log pseudolikelihood = -119.43508
Iteration 42:  log pseudolikelihood = -119.43508
Iteration 43:  log pseudolikelihood = -119.43508
Iteration 44:  log pseudolikelihood = -119.43508
Iteration 45:  log pseudolikelihood = -119.43508
Refining estimates:
Iteration 0:   log pseudolikelihood = -119.43508

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(17)    =       25.27
Log pseudolikelihood =   -119.43508             Prob > chi2      =      0.0888

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.000572   .6238069     0.00   0.999     .2948265    3.395707
      age_tv |   1.007529     .00876     0.86   0.388     .9905056    1.024846
        male |    1.63195   .6681176     1.20   0.232     .7315207    3.640721
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .7255643   .3504021    -0.66   0.507     .2815781    1.869618
    Unknown  |   1.151006   .9455321     0.17   0.864     .2300543     5.75871
             |
         imd |
          2  |   .7167915   .6550641    -0.36   0.716     .1195346    4.298255
          3  |   3.069491    2.20892     1.56   0.119     .7490491    12.57832
          4  |   2.877135   2.060902     1.48   0.140     .7067106    11.71329
          5  |   1.482383   1.183281     0.49   0.622     .3101038    7.086209
          6  |   4.363748   3.787924     1.70   0.090     .7961222    23.91882
             |
     bmi_cat |
Underweight  |   1.65e-20          .        .       .            .           .
 Overweight  |   .4488828   .2449465    -1.47   0.142     .1540455    1.308027
      Obese  |   .6640864    .296442    -0.92   0.359     .2768574    1.592917
Morbidly ..  |   .3687616   .3939487    -0.93   0.350     .0454366    2.992856
             |
     smoking |
Current s..  |   .7327329   .3294168    -0.69   0.489     .3035768    1.768572
  Ex-smoker  |   .4219229   .3450214    -1.06   0.291     .0849523    2.095516
             |
severe_dis~e |   .8232348   .3216538    -0.50   0.619     .3827743    1.770536
covid_vacc~t |   1.238093   1.001088     0.26   0.792     .2538018    6.039649
 liver_trans |   6.75e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_o_120_hosp_any.dta not found)
file ./output/tempdata/surv_adj_o_120_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.24881         4.25        1         0.0392
      age_tv      |      0.15144         1.83        1         0.1762
      male        |     -0.12331         0.99        1         0.3205
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.18251         2.10        1         0.1469
      2.eth_bin   |     -0.05291         0.16        1         0.6932
      1b.imd      |            .            .        1             .
      2.imd       |      0.04371         0.10        1         0.7538
      3.imd       |     -0.19652         2.66        1         0.1030
      4.imd       |     -0.11737         0.90        1         0.3436
      5.imd       |     -0.33639         7.06        1         0.0079
      6.imd       |     -0.20120         2.69        1         0.1009
      1.bmi_cat   |            .            .        1             .
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.02230         0.04        1         0.8510
      4.bmi_cat   |     -0.08963         0.37        1         0.5448
      5.bmi_cat   |     -0.00857         0.00        1         0.9446
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.56918        20.30        1         0.0000
      2.smoking   |     -0.19604         2.67        1         0.1026
      severe_dis~e|      0.18338         1.83        1         0.1758
      covid_vacc~t|     -0.26812         6.77        1         0.0093
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     32.44       17         0.0132
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_o_120_hosp_any.svg not found)
(file ./output/graphs/schoenplot_o_120_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -131.4611
Iteration 1:   log pseudolikelihood = -120.45992
Iteration 2:   log pseudolikelihood = -119.08244
Iteration 3:   log pseudolikelihood = -118.80856
Iteration 4:   log pseudolikelihood = -118.71129
Iteration 5:   log pseudolikelihood = -118.67571
Iteration 6:   log pseudolikelihood = -118.66264
Iteration 7:   log pseudolikelihood = -118.65784
Iteration 8:   log pseudolikelihood = -118.65607
Iteration 9:   log pseudolikelihood = -118.65543
Iteration 10:  log pseudolikelihood = -118.65519
Iteration 11:  log pseudolikelihood =  -118.6551
Iteration 12:  log pseudolikelihood = -118.65507
Iteration 13:  log pseudolikelihood = -118.65505
Iteration 14:  log pseudolikelihood = -118.65505
Iteration 15:  log pseudolikelihood = -118.65505
Iteration 16:  log pseudolikelihood = -118.65505
Iteration 17:  log pseudolikelihood = -118.65505
Iteration 18:  log pseudolikelihood = -118.65505
Iteration 19:  log pseudolikelihood = -118.65505
Iteration 20:  log pseudolikelihood = -118.65505
Iteration 21:  log pseudolikelihood = -118.65505
Iteration 22:  log pseudolikelihood = -118.65505
Iteration 23:  log pseudolikelihood = -118.65505
Iteration 24:  log pseudolikelihood = -118.65505
Iteration 25:  log pseudolikelihood = -118.65505
Iteration 26:  log pseudolikelihood = -118.65505
Iteration 27:  log pseudolikelihood = -118.65505
Iteration 28:  log pseudolikelihood = -118.65505
Iteration 29:  log pseudolikelihood = -118.65505
Iteration 30:  log pseudolikelihood = -118.65505
Iteration 31:  log pseudolikelihood = -118.65505
Iteration 32:  log pseudolikelihood = -118.65505
Iteration 33:  log pseudolikelihood = -118.65505
Iteration 34:  log pseudolikelihood = -118.65505
Iteration 35:  log pseudolikelihood = -118.65505
Refining estimates:
Iteration 0:   log pseudolikelihood = -118.65505
Iteration 1:   log pseudolikelihood = -118.65505

Stratified Cox regr. -- no ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =           56
Time at risk         =       647847
                                                Wald chi2(22)    =    17163.19
Log pseudolikelihood =   -118.65505             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9876841   .6006865    -0.02   0.984     .2998728    3.253112
      age_tv |   1.006807   .0087576     0.78   0.435     .9897875    1.024118
        male |   1.632711   .6641371     1.21   0.228     .7356416    3.623699
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6516351   .4362824    -0.64   0.522     .1754319    2.420474
      Asian  |   .9825718   .4948221    -0.03   0.972     .3661846    2.636504
      Black  |   .6075175   .4432585    -0.68   0.495     .1453794    2.538719
      Other  |   .4767897   .3573699    -0.99   0.323     .1097293     2.07172
    Unknown  |   1.162992   .9605629     0.18   0.855     .2304273    5.869744
             |
         imd |
          2  |   .7469669   .6912673    -0.32   0.753     .1217789    4.581743
          3  |   3.076964   2.186536     1.58   0.114     .7642687    12.38793
          4  |    2.84908   2.030441     1.47   0.142     .7048271    11.51666
          5  |   1.491545   1.235593     0.48   0.629     .2941053     7.56432
          6  |   4.486919   4.006552     1.68   0.093     .7796073    25.82382
             |
     bmi_cat |
Underweight  |   1.39e-16   4.82e-17  -105.02   0.000     7.01e-17    2.74e-16
 Overweight  |   .4599002   .2568861    -1.39   0.164     .1538894    1.374417
      Obese  |    .648709   .2766724    -1.01   0.310     .2811998    1.496528
Morbidly ..  |   .3687501   .3980992    -0.92   0.355     .0444409    3.059719
             |
     smoking |
Current s..  |   .7116886   .3105669    -0.78   0.436     .3025816    1.673931
  Ex-smoker  |    .447328   .3685129    -0.98   0.329     .0890017    2.248297
             |
severe_dis~e |   .8291129     .32414    -0.48   0.632     .3853348    1.783977
covid_vacc~t |    1.25724     1.0014     0.29   0.774     .2638947    5.989713
 liver_trans |   3.08e-16   2.92e-16   -37.64   0.000     4.79e-17    1.98e-15
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  51
no udca events = 51
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      583882           0     583882     583882
19462.733
262.03925

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 6

Contains data from ./output/an_dataset_overlap_120_composite_any.dta
  obs:         2,933                          
 vars:            20                          25 Sep 2023 12:28
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
        214  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  214

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_o_120_composite_any.svg not found)
(file ./output/graphs/km_o_120_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -479.38698
Iteration 1:   log pseudolikelihood = -479.18954
Iteration 2:   log pseudolikelihood = -479.18833
Iteration 3:   log pseudolikelihood = -479.18833
Refining estimates:
Iteration 0:   log pseudolikelihood = -479.18833

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        1,000             Number of obs    =       1,470
No. of failures      =          214
Time at risk         =       652131
                                                Wald chi2(1)     =        0.39
Log pseudolikelihood =   -479.18833             Prob > chi2      =      0.5308

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8073394    .275669    -0.63   0.531     .4134379    1.576529
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_o_120_composite_any.dta not found)
file ./output/tempdata/surv_crude_o_120_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.06123         0.36        1         0.5495
      ------------+---------------------------------------------------
      global test |                      0.36        1         0.5495
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood = -473.48299
Iteration 2:   log pseudolikelihood = -473.48188
Iteration 3:   log pseudolikelihood = -473.48188
Refining estimates:
Iteration 0:   log pseudolikelihood = -473.48188

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(3)     =        0.58
Log pseudolikelihood =   -473.48188             Prob > chi2      =      0.8999

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8118702    .278129    -0.61   0.543     .4148428    1.588875
      age_tv |   1.000628   .0042815     0.15   0.883     .9922712    1.009055
        male |   1.082704   .2159606     0.40   0.690     .7323617    1.600641
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_o_120_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_o_120_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.04027         0.17        1         0.6798
      age_tv      |      0.04662         0.24        1         0.6261
      male        |     -0.07042         0.50        1         0.4811
      ------------+---------------------------------------------------
      global test |                      1.04        3         0.7908
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood = -469.64886
Iteration 2:   log pseudolikelihood = -469.50982
Iteration 3:   log pseudolikelihood = -469.46963
Iteration 4:   log pseudolikelihood = -469.45487
Iteration 5:   log pseudolikelihood = -469.44944
Iteration 6:   log pseudolikelihood = -469.44745
Iteration 7:   log pseudolikelihood = -469.44671
Iteration 8:   log pseudolikelihood = -469.44644
Iteration 9:   log pseudolikelihood = -469.44634
Iteration 10:  log pseudolikelihood = -469.44631
Iteration 11:  log pseudolikelihood = -469.44629
Iteration 12:  log pseudolikelihood = -469.44629
Iteration 13:  log pseudolikelihood = -469.44629
Iteration 14:  log pseudolikelihood = -469.44629
Iteration 15:  log pseudolikelihood = -469.44629
Iteration 16:  log pseudolikelihood = -469.44629
Iteration 17:  log pseudolikelihood = -469.44629
Iteration 18:  log pseudolikelihood = -469.44629
Iteration 19:  log pseudolikelihood = -469.44629
Iteration 20:  log pseudolikelihood = -469.44629
Iteration 21:  log pseudolikelihood = -469.44629
Iteration 22:  log pseudolikelihood = -469.44629
Iteration 23:  log pseudolikelihood = -469.44629
Iteration 24:  log pseudolikelihood = -469.44629
Iteration 25:  log pseudolikelihood = -469.44629
Iteration 26:  log pseudolikelihood = -469.44629
Iteration 27:  log pseudolikelihood = -469.44629
Iteration 28:  log pseudolikelihood = -469.44629
Iteration 29:  log pseudolikelihood = -469.44629
Iteration 30:  log pseudolikelihood = -469.44629
Iteration 31:  log pseudolikelihood = -469.44629
Iteration 32:  log pseudolikelihood = -469.44629
Refining estimates:
Iteration 0:   log pseudolikelihood = -469.44629
Iteration 1:   log pseudolikelihood = -469.44629
Iteration 2:   log pseudolikelihood = -469.44629

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(19)    =     2556.37
Log pseudolikelihood =   -469.44629             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7628878   .2672964    -0.77   0.440     .3839028    1.516003
      age_tv |   .9995636   .0043103    -0.10   0.919     .9911511    1.008047
        male |   1.046985   .2149927     0.22   0.823      .700085    1.565777
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .8066551   .2223432    -0.78   0.436     .4699656    1.384553
    Unknown  |   .7075908   .4091339    -0.60   0.550     .2278303    2.197621
             |
         imd |
          2  |    .893164   .2999467    -0.34   0.737     .4624625    1.724987
          3  |   .9086956   .3286111    -0.26   0.791        .4473    1.846027
          4  |   1.270959   .4002557     0.76   0.446     .6855947    2.356109
          5  |   1.150778   .3769742     0.43   0.668     .6055546    2.186905
          6  |   1.544149   .7445274     0.90   0.368     .6001691    3.972874
             |
     bmi_cat |
Underweight  |   .9874007   .3232803    -0.04   0.969     .5197632    1.875778
 Overweight  |    .727926   .2078227    -1.11   0.266      .415977    1.273811
      Obese  |   .7283344   .1899886    -1.22   0.224     .4368093    1.214422
Morbidly ..  |   .6931594   .3391256    -0.75   0.454     .2656966    1.808341
             |
     smoking |
Current s..  |   .8023008   .2389594    -0.74   0.460     .4475207    1.438339
  Ex-smoker  |   .8003303   .3167807    -0.56   0.574     .3684284    1.738543
             |
severe_dis~e |   .8480555   .1843958    -0.76   0.448     .5537891    1.298686
covid_vacc~t |   .8760408   .2909802    -0.40   0.690      .456872    1.679787
 liver_trans |   1.71e-15   1.22e-15   -47.48   0.000     4.20e-16    6.96e-15
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_o_120_composite_any.dta not found)
file ./output/tempdata/surv_adj_o_120_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.03180         0.15        1         0.7014
      age_tv      |      0.11231         1.73        1         0.1878
      male        |     -0.07729         0.90        1         0.3431
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.01567         0.03        1         0.8578
      2.eth_bin   |     -0.05579         0.46        1         0.4996
      1b.imd      |            .            .        1             .
      2.imd       |      0.08026         0.78        1         0.3762
      3.imd       |     -0.14633         3.14        1         0.0766
      4.imd       |      0.19434         4.65        1         0.0310
      5.imd       |      0.09953         1.41        1         0.2354
      6.imd       |      0.11514         1.67        1         0.1961
      1.bmi_cat   |      0.12890         2.02        1         0.1548
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.18503         4.16        1         0.0414
      4.bmi_cat   |      0.22542         6.16        1         0.0130
      5.bmi_cat   |      0.06452         0.65        1         0.4219
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.00473         0.00        1         0.9556
      2.smoking   |     -0.02962         0.13        1         0.7185
      severe_dis~e|      0.07031         0.77        1         0.3814
      covid_vacc~t|     -0.01038         0.01        1         0.9036
      liver_trans |      0.03497         0.02        1         0.8977
      ------------+---------------------------------------------------
      global test |                     24.98       19         0.1613
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_o_120_composite_any.svg not found)
(file ./output/graphs/schoenplot_o_120_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -473.76264
Iteration 1:   log pseudolikelihood =  -468.2695
Iteration 2:   log pseudolikelihood = -468.11716
Iteration 3:   log pseudolikelihood = -468.07695
Iteration 4:   log pseudolikelihood = -468.06219
Iteration 5:   log pseudolikelihood = -468.05676
Iteration 6:   log pseudolikelihood = -468.05477
Iteration 7:   log pseudolikelihood = -468.05403
Iteration 8:   log pseudolikelihood = -468.05376
Iteration 9:   log pseudolikelihood = -468.05366
Iteration 10:  log pseudolikelihood = -468.05363
Iteration 11:  log pseudolikelihood = -468.05361
Iteration 12:  log pseudolikelihood = -468.05361
Iteration 13:  log pseudolikelihood = -468.05361
Iteration 14:  log pseudolikelihood =  -468.0536
Iteration 15:  log pseudolikelihood =  -468.0536
Iteration 16:  log pseudolikelihood =  -468.0536
Iteration 17:  log pseudolikelihood =  -468.0536
Iteration 18:  log pseudolikelihood =  -468.0536
Iteration 19:  log pseudolikelihood =  -468.0536
Iteration 20:  log pseudolikelihood =  -468.0536
Iteration 21:  log pseudolikelihood =  -468.0536
Iteration 22:  log pseudolikelihood =  -468.0536
Iteration 23:  log pseudolikelihood =  -468.0536
Iteration 24:  log pseudolikelihood =  -468.0536
Iteration 25:  log pseudolikelihood =  -468.0536
Iteration 26:  log pseudolikelihood =  -468.0536
Iteration 27:  log pseudolikelihood =  -468.0536
Iteration 28:  log pseudolikelihood =  -468.0536
Iteration 29:  log pseudolikelihood =  -468.0536
Iteration 30:  log pseudolikelihood =  -468.0536
Iteration 31:  log pseudolikelihood =  -468.0536
Iteration 32:  log pseudolikelihood =  -468.0536
Iteration 33:  log pseudolikelihood =  -468.0536
Iteration 34:  log pseudolikelihood =  -468.0536
Iteration 35:  log pseudolikelihood =  -468.0536
Iteration 36:  log pseudolikelihood =  -468.0536
Refining estimates:
Iteration 0:   log pseudolikelihood =  -468.0536
Iteration 1:   log pseudolikelihood =  -468.0536

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          991             Number of obs    =       1,459
No. of failures      =          211
Time at risk         =       647847
                                                Wald chi2(22)    =     2655.05
Log pseudolikelihood =    -468.0536             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 495 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    .777457   .2735535    -0.72   0.474     .3900995    1.549449
      age_tv |   .9996103   .0042992    -0.09   0.928     .9912194    1.008072
        male |   1.063057   .2225318     0.29   0.770     .7052984    1.602287
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6360155   .2312636    -1.24   0.213       .31186    1.297107
      Asian  |    .936229   .2985346    -0.21   0.836     .5011412    1.749057
      Black  |   .6638628   .2511392    -1.08   0.279      .316278    1.393438
      Other  |   .9786273   .3268054    -0.06   0.948     .5085865    1.883085
    Unknown  |   .7167215   .4150121    -0.58   0.565     .2303927    2.229627
             |
         imd |
          2  |    .943248   .3186806    -0.17   0.863     .4864561    1.828977
          3  |   .9252776   .3316472    -0.22   0.828     .4583275    1.867963
          4  |   1.279872   .3983845     0.79   0.428     .6953663    2.355696
          5  |   1.199026   .3956413     0.55   0.582     .6279981    2.289278
          6  |    1.57589   .7648139     0.94   0.349     .6087223    4.079741
             |
     bmi_cat |
Underweight  |   .9571532   .3079722    -0.14   0.892     .5094482    1.798303
 Overweight  |   .7308494   .2092787    -1.09   0.274     .4169523     1.28106
      Obese  |   .7019085   .1859679    -1.34   0.182     .4175977    1.179785
Morbidly ..  |   .7215158   .3499336    -0.67   0.501     .2788784     1.86671
             |
     smoking |
Current s..  |    .813356   .2442996    -0.69   0.492     .4514544    1.465371
  Ex-smoker  |   .8480037   .3427491    -0.41   0.683      .384022    1.872575
             |
severe_dis~e |   .8546775    .187336    -0.72   0.474     .5561964    1.313338
covid_vacc~t |   .8707133   .2875122    -0.42   0.675     .4558331      1.6632
 liver_trans |   7.63e-17   5.91e-17   -47.93   0.000     1.67e-17    3.48e-16
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,000      100.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  1,000
  191
no udca events = 191
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        900      583882           0     583882     583882
19462.733
981.36267

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        900       90.00       90.00
          1 |        100       10.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
udca events = 23

. 
. * sensitivity analysis - stratify by PBC vs PSC
. file write tablecontent _n ("PBC only sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1 & has_pbc==1
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_pbc_`outcome'.svg, as(svg) replace
 10.         * Cox model - crude
.         stcox udca if has_pbc==1, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model10
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_pbc_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_pbc_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male if has_pbc==1, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model11
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_pbc_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==1, st
> rata(stp) vce(robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model12
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_pbc_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_pbc_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_pbc_`outcome' adj_plot_pbc_`outcome'
 28.         graph export ./output/graphs/schoenplot_pbc_`outcome'.svg, as(svg)
>  replace 
 29.         * Cox model - fully adjusted with categorical ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==1, 
> strata(stp) vce(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1 & has_pbc==1
 34.         safecount if unexposed_ever==0 & has_pbc==1 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1 & has_pbc==1
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1 & has_pbc==1
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1 & has_pbc==1
 55.         qui safecount if exposed_ever==1 & number==1 & has_pbc==1
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1 & has_pbc==1
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1 & has_pbc==1
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. 
. }

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         3,012                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      3,012  total observations
          0  exclusions
------------------------------------------------------------------------------
      3,012  observations remaining, representing
      1,000  subjects
        165  failures in single-failure-per-subject data
    676,087  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  83

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_pbc_died_covid_any.svg not found)
(file ./output/graphs/km_pbc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -159.78011
Iteration 1:   log pseudolikelihood = -158.64747
Iteration 2:   log pseudolikelihood = -158.55633
Iteration 3:   log pseudolikelihood = -158.55512
Iteration 4:   log pseudolikelihood = -158.55512
Refining estimates:
Iteration 0:   log pseudolikelihood = -158.55512

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         780
No. of failures      =           83
Time at risk         =       340264
                                                Wald chi2(1)     =        1.80
Log pseudolikelihood =   -158.55512             Prob > chi2      =      0.1792

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .3755028   .2738301    -1.34   0.179     .0899263    1.567977
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_pbc_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_pbc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.12269         0.57        1         0.4495
      ------------+---------------------------------------------------
      global test |                      0.57        1         0.4495
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -155.53963
Iteration 1:   log pseudolikelihood = -154.41218
Iteration 2:   log pseudolikelihood = -154.32641
Iteration 3:   log pseudolikelihood = -154.32534
Iteration 4:   log pseudolikelihood = -154.32534
Refining estimates:
Iteration 0:   log pseudolikelihood = -154.32534

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         771
No. of failures      =           82
Time at risk         =       337400
                                                Wald chi2(3)     =        1.90
Log pseudolikelihood =   -154.32534             Prob > chi2      =      0.5937

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .3790857   .2769661    -1.33   0.184      .090539    1.587226
      age_tv |   1.001784    .007007     0.25   0.799     .9881443    1.015612
        male |   1.015387   .3345955     0.05   0.963     .5322792    1.936974
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_pbc_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_pbc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.13899         0.97        1         0.3237
      age_tv      |      0.08457         0.31        1         0.5807
      male        |     -0.16286         1.28        1         0.2572
      ------------+---------------------------------------------------
      global test |                      1.86        3         0.6026
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -155.53963
Iteration 1:   log pseudolikelihood = -147.02482
Iteration 2:   log pseudolikelihood = -146.33734
Iteration 3:   log pseudolikelihood = -146.31746
Iteration 4:   log pseudolikelihood = -146.31071
Iteration 5:   log pseudolikelihood = -146.30823
Iteration 6:   log pseudolikelihood = -146.30732
Iteration 7:   log pseudolikelihood = -146.30699
Iteration 8:   log pseudolikelihood = -146.30686
Iteration 9:   log pseudolikelihood = -146.30682
Iteration 10:  log pseudolikelihood =  -146.3068
Iteration 11:  log pseudolikelihood =  -146.3068
Iteration 12:  log pseudolikelihood = -146.30679
Iteration 13:  log pseudolikelihood = -146.30679
Iteration 14:  log pseudolikelihood = -146.30679
Iteration 15:  log pseudolikelihood = -146.30679
Iteration 16:  log pseudolikelihood = -146.30679
Iteration 17:  log pseudolikelihood = -146.30679
Iteration 18:  log pseudolikelihood = -146.30679
Iteration 19:  log pseudolikelihood = -146.30679
Iteration 20:  log pseudolikelihood = -146.30679
Iteration 21:  log pseudolikelihood = -146.30679
Iteration 22:  log pseudolikelihood = -146.30679
Iteration 23:  log pseudolikelihood = -146.30679
Iteration 24:  log pseudolikelihood = -146.30679
Iteration 25:  log pseudolikelihood = -146.30679
Iteration 26:  log pseudolikelihood = -146.30679
Iteration 27:  log pseudolikelihood = -146.30679
Iteration 28:  log pseudolikelihood = -146.30679
Iteration 29:  log pseudolikelihood = -146.30679
Iteration 30:  log pseudolikelihood = -146.30679
Refining estimates:
Iteration 0:   log pseudolikelihood = -146.30679
Iteration 1:   log pseudolikelihood = -146.30679
Iteration 2:   log pseudolikelihood = -146.30679

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         771
No. of failures      =           82
Time at risk         =       337400
                                                Wald chi2(19)    =     1807.88
Log pseudolikelihood =   -146.30679             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .4345214   .3384671    -1.07   0.285     .0944005    2.000083
      age_tv |   .9990677   .0060436    -0.15   0.877     .9872925    1.010983
        male |   1.018441   .3531634     0.05   0.958     .5161377    2.009583
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .9255261   .4837023    -0.15   0.882     .3322999    2.577788
    Unknown  |   1.379105   1.298331     0.34   0.733     .2178966    8.728589
             |
         imd |
          2  |   .6557922    .435764    -0.63   0.525     .1783018    2.411997
          3  |    .654743     .38625    -0.72   0.473     .2060273    2.080736
          4  |   1.138379   .5404783     0.27   0.785      .448905    2.886818
          5  |   .9851222   .5296318    -0.03   0.978     .3434457    2.825674
          6  |   1.823252   1.161199     0.94   0.346     .5232758    6.352766
             |
     bmi_cat |
Underweight  |   2.729849   1.297602     2.11   0.035       1.0753    6.930225
 Overweight  |    1.71992   .8084226     1.15   0.249     .6845637    4.321184
      Obese  |   .5535493   .3286679    -1.00   0.319     .1728855    1.772369
Morbidly ..  |   2.771568   1.797867     1.57   0.116     .7772598    9.882911
             |
     smoking |
Current s..  |   .7467465   .4128615    -0.53   0.597      .252674    2.206916
  Ex-smoker  |   .4529362   .3503449    -1.02   0.306     .0994569    2.062714
             |
severe_dis~e |   .7818041   .3166143    -0.61   0.543     .3534916    1.729087
covid_vacc~t |   1.125558   .4163689     0.32   0.749     .5451168    2.324054
 liver_trans |   1.50e-14   1.36e-14   -35.18   0.000     2.55e-15    8.85e-14
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_pbc_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_pbc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.08629         0.73        1         0.3915
      age_tv      |      0.27882         4.83        1         0.0279
      male        |     -0.19120         3.30        1         0.0693
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.10571         0.67        1         0.4134
      2.eth_bin   |      0.11443         0.92        1         0.3368
      1b.imd      |            .            .        1             .
      2.imd       |     -0.16480         1.64        1         0.2010
      3.imd       |     -0.24646         4.16        1         0.0415
      4.imd       |      0.31738         6.59        1         0.0103
      5.imd       |      0.09359         0.59        1         0.4430
      6.imd       |      0.01124         0.01        1         0.9393
      1.bmi_cat   |      0.09536         0.59        1         0.4406
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.35001        11.73        1         0.0006
      4.bmi_cat   |      0.16788         1.92        1         0.1655
      5.bmi_cat   |      0.18145         2.84        1         0.0917
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.14571         2.02        1         0.1555
      2.smoking   |      0.04898         0.22        1         0.6414
      severe_dis~e|     -0.17254         2.80        1         0.0940
      covid_vacc~t|      0.13361         0.79        1         0.3732
      liver_trans |      0.07281         0.07        1         0.7854
      ------------+---------------------------------------------------
      global test |                     35.52       19         0.0121
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_pbc_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_pbc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -155.53963
Iteration 1:   log pseudolikelihood = -144.01231
Iteration 2:   log pseudolikelihood = -142.77352
Iteration 3:   log pseudolikelihood =  -142.7499
Iteration 4:   log pseudolikelihood = -142.74402
Iteration 5:   log pseudolikelihood = -142.74186
Iteration 6:   log pseudolikelihood = -142.74107
Iteration 7:   log pseudolikelihood = -142.74078
Iteration 8:   log pseudolikelihood = -142.74067
Iteration 9:   log pseudolikelihood = -142.74063
Iteration 10:  log pseudolikelihood = -142.74062
Iteration 11:  log pseudolikelihood = -142.74061
Iteration 12:  log pseudolikelihood = -142.74061
Iteration 13:  log pseudolikelihood = -142.74061
Iteration 14:  log pseudolikelihood = -142.74061
Iteration 15:  log pseudolikelihood = -142.74061
Iteration 16:  log pseudolikelihood = -142.74061
Iteration 17:  log pseudolikelihood = -142.74061
Iteration 18:  log pseudolikelihood = -142.74061
Iteration 19:  log pseudolikelihood = -142.74061
Iteration 20:  log pseudolikelihood = -142.74061
Iteration 21:  log pseudolikelihood = -142.74061
Iteration 22:  log pseudolikelihood = -142.74061
Iteration 23:  log pseudolikelihood = -142.74061
Iteration 24:  log pseudolikelihood = -142.74061
Iteration 25:  log pseudolikelihood = -142.74061
Iteration 26:  log pseudolikelihood = -142.74061
Iteration 27:  log pseudolikelihood = -142.74061
Iteration 28:  log pseudolikelihood = -142.74061
Iteration 29:  log pseudolikelihood = -142.74061
Refining estimates:
Iteration 0:   log pseudolikelihood = -142.74061
Iteration 1:   log pseudolikelihood = -142.74061
Iteration 2:   log pseudolikelihood = -142.74061

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         771
No. of failures      =           82
Time at risk         =       337400
                                                Wald chi2(22)    =     1525.59
Log pseudolikelihood =   -142.74061             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .3936858   .3241789    -1.13   0.258     .0783847    1.977279
      age_tv |   .9987157   .0070738    -0.18   0.856     .9849472    1.012677
        male |   1.019914   .3903849     0.05   0.959     .4816768    2.159592
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .3849615   .2801031    -1.31   0.190     .0924851     1.60237
      Asian  |   .9355655   .5455397    -0.11   0.909     .2983515     2.93373
      Black  |   .8594562   .6529076    -0.20   0.842     .1939041    3.809435
      Other  |   1.832143   1.157397     0.96   0.338     .5311781    6.319437
    Unknown  |   1.263403   1.213028     0.24   0.808      .192433    8.294767
             |
         imd |
          2  |   .7312233   .4927673    -0.46   0.642     .1951777    2.739491
          3  |   .7342209   .4233309    -0.54   0.592     .2371636    2.273031
          4  |   .9927681   .4881813    -0.01   0.988     .3786867    2.602649
          5  |    1.09978   .5508899     0.19   0.849     .4120323    2.935489
          6  |   2.013811   1.080932     1.30   0.192     .7032805    5.766456
             |
     bmi_cat |
Underweight  |    2.31555    1.10523     1.76   0.079     .9085925    5.901184
 Overweight  |   1.925134   .9253798     1.36   0.173     .7504171    4.938776
      Obese  |    .496099   .2976003    -1.17   0.243     .1530907    1.607637
Morbidly ..  |   2.446338   1.652808     1.32   0.185     .6507637    9.196228
             |
     smoking |
Current s..  |   .6303557    .353907    -0.82   0.411     .2097427    1.894455
  Ex-smoker  |   .4244217   .3402386    -1.07   0.285     .0881922    2.042515
             |
severe_dis~e |   .7981088   .3294622    -0.55   0.585     .3553719    1.792426
covid_vacc~t |   1.107406   .4203563     0.27   0.788     .5262619    2.330298
 liver_trans |   2.00e-14   2.03e-14   -31.19   0.000     2.76e-15    1.45e-13
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,012       66.80       66.80
          1 |      1,000       33.20      100.00
------------+-----------------------------------
      Total |      3,012      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  73
no udca events = 73
(2012 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        438      606518           0     606518     606518
20217.267
361.07749

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        438       87.60       87.60
          1 |         62       12.40      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 10

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,933                          
 vars:            21                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
         57  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  28

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_pbc_hosp_any.svg not found)
(file ./output/graphs/km_pbc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -66.380983
Iteration 1:   log pseudolikelihood = -66.349488
Iteration 2:   log pseudolikelihood = -66.349366
Iteration 3:   log pseudolikelihood = -66.349366
Refining estimates:
Iteration 0:   log pseudolikelihood = -66.349366

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         752
No. of failures      =           28
Time at risk         =       327427
                                                Wald chi2(1)     =        0.06
Log pseudolikelihood =   -66.349366             Prob > chi2      =      0.8030

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8299649   .6200183    -0.25   0.803      .191945    3.588746
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_pbc_hosp_any.dta not found)
file ./output/tempdata/surv_crude_pbc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.39418         2.51        1         0.1134
      ------------+---------------------------------------------------
      global test |                      2.51        1         0.1134
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -61.906997
Iteration 1:   log pseudolikelihood =  -60.08674
Iteration 2:   log pseudolikelihood = -60.083021
Iteration 3:   log pseudolikelihood = -60.083021
Refining estimates:
Iteration 0:   log pseudolikelihood = -60.083021

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         746
No. of failures      =           27
Time at risk         =       325147
                                                Wald chi2(3)     =        3.18
Log pseudolikelihood =   -60.083021             Prob > chi2      =      0.3641

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8706141   .6505232    -0.19   0.853     .2012832    3.765684
      age_tv |   1.011597   .0120602     0.97   0.333     .9882332    1.035513
        male |   2.409971    1.29932     1.63   0.103     .8377068    6.933167
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_pbc_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_pbc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.38242         3.26        1         0.0708
      age_tv      |     -0.22704         1.16        1         0.2813
      male        |      0.14190         0.39        1         0.5348
      ------------+---------------------------------------------------
      global test |                      3.78        3         0.2864
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -61.906997
Iteration 1:   log pseudolikelihood =  -48.73349
Iteration 2:   log pseudolikelihood = -46.696713
Iteration 3:   log pseudolikelihood = -46.304877
Iteration 4:   log pseudolikelihood = -46.188487
Iteration 5:   log pseudolikelihood = -46.146187
Iteration 6:   log pseudolikelihood = -46.130682
Iteration 7:   log pseudolikelihood = -46.124986
Iteration 8:   log pseudolikelihood = -46.122891
Iteration 9:   log pseudolikelihood = -46.122121
Iteration 10:  log pseudolikelihood = -46.121837
Iteration 11:  log pseudolikelihood = -46.121733
Iteration 12:  log pseudolikelihood = -46.121695
Iteration 13:  log pseudolikelihood = -46.121681
Iteration 14:  log pseudolikelihood = -46.121676
Iteration 15:  log pseudolikelihood = -46.121674
Iteration 16:  log pseudolikelihood = -46.121673
Iteration 17:  log pseudolikelihood = -46.121673
Iteration 18:  log pseudolikelihood = -46.121673
Iteration 19:  log pseudolikelihood = -46.121673
Iteration 20:  log pseudolikelihood = -46.121673
Iteration 21:  log pseudolikelihood = -46.121673
Iteration 22:  log pseudolikelihood = -46.121673
Iteration 23:  log pseudolikelihood = -46.121673
Iteration 24:  log pseudolikelihood = -46.121673
Iteration 25:  log pseudolikelihood = -46.121673
Iteration 26:  log pseudolikelihood = -46.121673
Iteration 27:  log pseudolikelihood = -46.121673
Iteration 28:  log pseudolikelihood = -46.121673
Iteration 29:  log pseudolikelihood = -46.121673
Iteration 30:  log pseudolikelihood = -46.121673
Iteration 31:  log pseudolikelihood = -46.121673
Iteration 32:  log pseudolikelihood = -46.121673
Iteration 33:  log pseudolikelihood = -46.121673
Iteration 34:  log pseudolikelihood = -46.121673
Refining estimates:
Iteration 0:   log pseudolikelihood = -46.121673
Iteration 1:   log pseudolikelihood = -46.121673
Iteration 2:   log pseudolikelihood = -46.121673
Iteration 3:   log pseudolikelihood = -46.121673
Iteration 4:   log pseudolikelihood = -46.121673
Iteration 5:   log pseudolikelihood = -46.121673

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         746
No. of failures      =           27
Time at risk         =       325147
                                                Wald chi2(19)    =    15356.79
Log pseudolikelihood =   -46.121673             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7134487   .4571003    -0.53   0.598     .2032382    2.504495
      age_tv |   1.001441   .0175183     0.08   0.934     .9676877    1.036372
        male |   2.827122    2.13841     1.37   0.169     .6419532    12.45047
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |    .821856   .5245677    -0.31   0.759     .2352327    2.871401
    Unknown  |   6.30e-18   5.93e-18   -42.13   0.000     9.99e-19    3.98e-17
             |
         imd |
          2  |   9.93e-18   9.53e-18   -40.75   0.000     1.51e-18    6.52e-17
          3  |   1.716627   1.917738     0.48   0.629     .1921994    15.33204
          4  |   2.673456   2.692562     0.98   0.329     .3713541    19.24677
          5  |   .3386001   .4556661    -0.80   0.421     .0242212    4.733463
          6  |   5.077821   8.532529     0.97   0.334     .1885206    136.7716
             |
     bmi_cat |
Underweight  |   3.63e-18   1.88e-18   -77.58   0.000     1.32e-18    1.00e-17
 Overweight  |   .1333791   .1112191    -2.42   0.016       .02602    .6837043
      Obese  |   .1968793   .1676705    -1.91   0.056     .0370922    1.045004
Morbidly ..  |   .7891545   .8646373    -0.22   0.829     .0921601    6.757425
             |
     smoking |
Current s..  |   .5144872   .2857931    -1.20   0.232     .1731967    1.528303
  Ex-smoker  |   .3716831   .5354282    -0.69   0.492     .0220787    6.257078
             |
severe_dis~e |   .5131066    .295346    -1.16   0.246     .1660554    1.585486
covid_vacc~t |    2.10942   1.767767     0.89   0.373     .4081561    10.90184
 liver_trans |   1.88e-17   5.57e-17   -13.02   0.000     5.71e-20    6.21e-15
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_pbc_hosp_any.dta not found)
file ./output/tempdata/surv_adj_pbc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.19358         1.53        1         0.2155
      age_tv      |      0.01174         0.01        1         0.9078
      male        |     -0.19813         5.90        1         0.0151
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.14884         0.88        1         0.3490
      2.eth_bin   |     -0.19698         1.66        1         0.1970
      1b.imd      |            .            .        1             .
      2.imd       |     -0.30572        12.32        1         0.0004
      3.imd       |     -0.28719        11.05        1         0.0009
      4.imd       |     -0.30505        12.25        1         0.0005
      5.imd       |     -0.25343         5.71        1         0.0168
      6.imd       |     -0.25108         9.05        1         0.0026
      1.bmi_cat   |      0.02342         0.02        1         0.8962
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.08738         0.57        1         0.4496
      4.bmi_cat   |      0.27076         8.99        1         0.0027
      5.bmi_cat   |     -0.05719         0.17        1         0.6840
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.43349         5.15        1         0.0232
      2.smoking   |      0.22833         7.02        1         0.0081
      severe_dis~e|      0.26001         7.09        1         0.0078
      covid_vacc~t|     -0.01417         0.02        1         0.8946
      liver_trans |     -0.29118        13.66        1         0.0002
      ------------+---------------------------------------------------
      global test |                     29.26       19         0.0621
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_pbc_hosp_any.svg not found)
(file ./output/graphs/schoenplot_pbc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -61.906997
Iteration 1:   log pseudolikelihood = -48.130217
Iteration 2:   log pseudolikelihood =  -46.15947
Iteration 3:   log pseudolikelihood = -45.828404
Iteration 4:   log pseudolikelihood =   -45.7277
Iteration 5:   log pseudolikelihood = -45.690916
Iteration 6:   log pseudolikelihood = -45.677417
Iteration 7:   log pseudolikelihood = -45.672456
Iteration 8:   log pseudolikelihood = -45.670631
Iteration 9:   log pseudolikelihood =  -45.66996
Iteration 10:  log pseudolikelihood = -45.669713
Iteration 11:  log pseudolikelihood = -45.669623
Iteration 12:  log pseudolikelihood = -45.669589
Iteration 13:  log pseudolikelihood = -45.669577
Iteration 14:  log pseudolikelihood = -45.669572
Iteration 15:  log pseudolikelihood = -45.669571
Iteration 16:  log pseudolikelihood =  -45.66957
Iteration 17:  log pseudolikelihood =  -45.66957
Iteration 18:  log pseudolikelihood =  -45.66957
Iteration 19:  log pseudolikelihood =  -45.66957
Iteration 20:  log pseudolikelihood =  -45.66957
Iteration 21:  log pseudolikelihood =  -45.66957
Iteration 22:  log pseudolikelihood =  -45.66957
Iteration 23:  log pseudolikelihood =  -45.66957
Iteration 24:  log pseudolikelihood =  -45.66957
Iteration 25:  log pseudolikelihood =  -45.66957
Iteration 26:  log pseudolikelihood =  -45.66957
Iteration 27:  log pseudolikelihood =  -45.66957
Iteration 28:  log pseudolikelihood =  -45.66957
Iteration 29:  log pseudolikelihood =  -45.66957
Iteration 30:  log pseudolikelihood =  -45.66957
Iteration 31:  log pseudolikelihood =  -45.66957
Iteration 32:  log pseudolikelihood =  -45.66957
Iteration 33:  log pseudolikelihood =  -45.66957
Iteration 34:  log pseudolikelihood =  -45.66957
Iteration 35:  log pseudolikelihood =  -45.66957
Refining estimates:
Iteration 0:   log pseudolikelihood =  -45.66957
Iteration 1:   log pseudolikelihood =  -45.66957
Iteration 2:   log pseudolikelihood =  -45.66957

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         746
No. of failures      =           27
Time at risk         =       325147
                                                Wald chi2(22)    =    14452.17
Log pseudolikelihood =    -45.66957             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6464708   .5008361    -0.56   0.573      .141613    2.951173
      age_tv |   1.001685   .0178561     0.09   0.925     .9672916    1.037301
        male |   2.458919   1.744403     1.27   0.205     .6121894     9.87649
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .5144676   .6661393    -0.51   0.608     .0406641    6.508858
      Asian  |   .9167415   .5704116    -0.14   0.889     .2707792    3.103691
      Black  |   1.165259   1.159225     0.15   0.878      .165817    8.188719
      Other  |   .4663579   .5439069    -0.65   0.513     .0474214    4.586317
    Unknown  |   4.26e-17   4.02e-17   -39.94   0.000     6.70e-18    2.71e-16
             |
         imd |
          2  |   6.14e-17   6.55e-17   -35.00   0.000     7.59e-18    4.96e-16
          3  |   1.689122    1.82401     0.49   0.627      .203463    14.02286
          4  |   2.650983   2.723322     0.95   0.343     .3539793    19.85345
          5  |   .3522353   .4938466    -0.74   0.457     .0225641    5.498547
          6  |   4.659222   7.341818     0.98   0.329      .212336    102.2358
             |
     bmi_cat |
Underweight  |   2.36e-17   1.47e-17   -61.60   0.000     6.97e-18    7.97e-17
 Overweight  |    .149026   .1280692    -2.22   0.027     .0276542    .8030883
      Obese  |   .2279651    .170562    -1.98   0.048     .0526023     .987943
Morbidly ..  |   .6892259   .8259095    -0.31   0.756     .0658194    7.217204
             |
     smoking |
Current s..  |   .4664901   .2768758    -1.28   0.199     .1457568    1.492987
  Ex-smoker  |   .4752874   .6991081    -0.51   0.613     .0266017    8.491858
             |
severe_dis~e |   .4873648   .2622404    -1.34   0.182     .1697622    1.399159
covid_vacc~t |   2.243654   2.003329     0.91   0.365     .3898788    12.91167
 liver_trans |   1.65e-16   5.63e-16   -10.65   0.000     2.05e-19    1.33e-13
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  24
no udca events = 24
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        438      583882           0     583882     583882
19462.733
123.31259

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        438       87.60       87.60
          1 |         62       12.40      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = .

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,933                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
        214  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  105

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_pbc_composite_any.svg not found)
(file ./output/graphs/km_pbc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -208.98467
Iteration 1:   log pseudolikelihood = -208.23049
Iteration 2:   log pseudolikelihood = -208.20416
Iteration 3:   log pseudolikelihood = -208.20411
Refining estimates:
Iteration 0:   log pseudolikelihood = -208.20411

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         752
No. of failures      =          105
Time at risk         =       327427
                                                Wald chi2(1)     =        1.39
Log pseudolikelihood =   -208.20411             Prob > chi2      =      0.2388

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5487199   .2795527    -1.18   0.239     .2021598    1.489384
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_pbc_composite_any.dta not found)
file ./output/tempdata/surv_crude_pbc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.08049         0.31        1         0.5781
      ------------+---------------------------------------------------
      global test |                      0.31        1         0.5781
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -204.2753
Iteration 1:   log pseudolikelihood = -203.18296
Iteration 2:   log pseudolikelihood = -203.16095
Iteration 3:   log pseudolikelihood = -203.16091
Refining estimates:
Iteration 0:   log pseudolikelihood = -203.16091

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         746
No. of failures      =          104
Time at risk         =       325147
                                                Wald chi2(3)     =        2.54
Log pseudolikelihood =   -203.16091             Prob > chi2      =      0.4677

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5529494   .2823929    -1.16   0.246     .2032236    1.504515
      age_tv |    1.00209   .0063459     0.33   0.742     .9897295    1.014605
        male |    1.25951   .3572509     0.81   0.416     .7223777    2.196032
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_pbc_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_pbc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.06038         0.24        1         0.6261
      age_tv      |     -0.11468         0.74        1         0.3906
      male        |     -0.11603         0.77        1         0.3796
      ------------+---------------------------------------------------
      global test |                      1.81        3         0.6129
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -204.2753
Iteration 1:   log pseudolikelihood = -194.55841
Iteration 2:   log pseudolikelihood = -194.07143
Iteration 3:   log pseudolikelihood =  -194.0398
Iteration 4:   log pseudolikelihood = -194.02887
Iteration 5:   log pseudolikelihood = -194.02486
Iteration 6:   log pseudolikelihood = -194.02338
Iteration 7:   log pseudolikelihood = -194.02284
Iteration 8:   log pseudolikelihood = -194.02264
Iteration 9:   log pseudolikelihood = -194.02256
Iteration 10:  log pseudolikelihood = -194.02254
Iteration 11:  log pseudolikelihood = -194.02253
Iteration 12:  log pseudolikelihood = -194.02252
Iteration 13:  log pseudolikelihood = -194.02252
Iteration 14:  log pseudolikelihood = -194.02252
Iteration 15:  log pseudolikelihood = -194.02252
Iteration 16:  log pseudolikelihood = -194.02252
Iteration 17:  log pseudolikelihood = -194.02252
Iteration 18:  log pseudolikelihood = -194.02252
Iteration 19:  log pseudolikelihood = -194.02252
Iteration 20:  log pseudolikelihood = -194.02252
Iteration 21:  log pseudolikelihood = -194.02252
Iteration 22:  log pseudolikelihood = -194.02252
Iteration 23:  log pseudolikelihood = -194.02252
Iteration 24:  log pseudolikelihood = -194.02252
Iteration 25:  log pseudolikelihood = -194.02252
Iteration 26:  log pseudolikelihood = -194.02252
Iteration 27:  log pseudolikelihood = -194.02252
Iteration 28:  log pseudolikelihood = -194.02252
Iteration 29:  log pseudolikelihood = -194.02252
Iteration 30:  log pseudolikelihood = -194.02252
Iteration 31:  log pseudolikelihood = -194.02252
Iteration 32:  log pseudolikelihood = -194.02252
Iteration 33:  log pseudolikelihood = -194.02252
Iteration 34:  log pseudolikelihood = -194.02252
Iteration 35:  log pseudolikelihood = -194.02252
Iteration 36:  log pseudolikelihood = -194.02252
Iteration 37:  log pseudolikelihood = -194.02252
Iteration 38:  log pseudolikelihood = -194.02252
Iteration 39:  log pseudolikelihood = -194.02252
Iteration 40:  log pseudolikelihood = -194.02252
Refining estimates:
Iteration 0:   log pseudolikelihood = -194.02252
Iteration 1:   log pseudolikelihood = -194.02252
Iteration 2:   log pseudolikelihood = -194.02252

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         746
No. of failures      =          104
Time at risk         =       325147
                                                Wald chi2(19)    =     2816.37
Log pseudolikelihood =   -194.02252             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6098433   .3146243    -0.96   0.338     .2218578    1.676339
      age_tv |   .9982994    .006146    -0.28   0.782      .986326    1.010418
        male |   1.238266   .3847376     0.69   0.492     .6735031    2.276606
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .9335981   .4116564    -0.16   0.876     .3934007    2.215567
    Unknown  |   .7167203   .6382991    -0.37   0.708     .1251076    4.105968
             |
         imd |
          2  |   .4646697   .2903615    -1.23   0.220     .1365362    1.581397
          3  |   .7378833   .3736603    -0.60   0.548     .2734914    1.990819
          4  |     1.3336   .5624395     0.68   0.495     .5834924    3.048006
          5  |   .8481784   .4237157    -0.33   0.742     .3186114    2.257944
          6  |   1.854038   1.270304     0.90   0.368     .4840759    7.101072
             |
     bmi_cat |
Underweight  |   1.244845   .5204164     0.52   0.600     .5486106     2.82466
 Overweight  |   .8268081   .3362633    -0.47   0.640     .3725809    1.834801
      Obese  |   .3832177   .1785848    -2.06   0.040     .1537354    .9552506
Morbidly ..  |   1.315197   .8153484     0.44   0.659     .3902055    4.432901
             |
     smoking |
Current s..  |   .6605952   .2848345    -0.96   0.336     .2837367    1.537996
  Ex-smoker  |   .4247159   .2718734    -1.34   0.181     .1211208    1.489286
             |
severe_dis~e |   .7090927   .2408023    -1.01   0.311     .3644531    1.379635
covid_vacc~t |   1.040496   .4354059     0.09   0.924     .4581911    2.362839
 liver_trans |   6.92e-19   6.63e-19   -43.65   0.000     1.06e-19    4.52e-18
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_pbc_composite_any.dta not found)
file ./output/tempdata/surv_adj_pbc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.06258         0.37        1         0.5418
      age_tv      |      0.03481         0.12        1         0.7309
      male        |     -0.20639         5.02        1         0.0251
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.07911         0.45        1         0.5043
      2.eth_bin   |     -0.07777         0.55        1         0.4579
      1b.imd      |            .            .        1             .
      2.imd       |     -0.17611         2.51        1         0.1130
      3.imd       |     -0.33017        12.23        1         0.0005
      4.imd       |      0.04600         0.21        1         0.6438
      5.imd       |      0.03452         0.11        1         0.7405
      6.imd       |     -0.08492         0.53        1         0.4676
      1.bmi_cat   |      0.04657         0.14        1         0.7103
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.26213         7.86        1         0.0051
      4.bmi_cat   |      0.21352         4.66        1         0.0309
      5.bmi_cat   |      0.03634         0.13        1         0.7234
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.09462         1.01        1         0.3159
      2.smoking   |     -0.02388         0.05        1         0.8198
      severe_dis~e|     -0.02369         0.07        1         0.7894
      covid_vacc~t|      0.02992         0.08        1         0.7791
      liver_trans |     -0.07911         0.18        1         0.6746
      ------------+---------------------------------------------------
      global test |                     31.69       19         0.0338
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_pbc_composite_any.svg not found)
(file ./output/graphs/schoenplot_pbc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood =  -204.2753
Iteration 1:   log pseudolikelihood =  -192.0798
Iteration 2:   log pseudolikelihood = -191.54919
Iteration 3:   log pseudolikelihood = -191.51893
Iteration 4:   log pseudolikelihood = -191.50818
Iteration 5:   log pseudolikelihood = -191.50422
Iteration 6:   log pseudolikelihood = -191.50277
Iteration 7:   log pseudolikelihood = -191.50224
Iteration 8:   log pseudolikelihood = -191.50204
Iteration 9:   log pseudolikelihood = -191.50197
Iteration 10:  log pseudolikelihood = -191.50194
Iteration 11:  log pseudolikelihood = -191.50193
Iteration 12:  log pseudolikelihood = -191.50193
Iteration 13:  log pseudolikelihood = -191.50193
Iteration 14:  log pseudolikelihood = -191.50193
Iteration 15:  log pseudolikelihood = -191.50193
Iteration 16:  log pseudolikelihood = -191.50193
Iteration 17:  log pseudolikelihood = -191.50193
Iteration 18:  log pseudolikelihood = -191.50193
Iteration 19:  log pseudolikelihood = -191.50193
Iteration 20:  log pseudolikelihood = -191.50193
Iteration 21:  log pseudolikelihood = -191.50193
Iteration 22:  log pseudolikelihood = -191.50193
Iteration 23:  log pseudolikelihood = -191.50193
Iteration 24:  log pseudolikelihood = -191.50193
Iteration 25:  log pseudolikelihood = -191.50193
Iteration 26:  log pseudolikelihood = -191.50193
Iteration 27:  log pseudolikelihood = -191.50193
Iteration 28:  log pseudolikelihood = -191.50193
Iteration 29:  log pseudolikelihood = -191.50193
Iteration 30:  log pseudolikelihood = -191.50193
Iteration 31:  log pseudolikelihood = -191.50193
Iteration 32:  log pseudolikelihood = -191.50193
Iteration 33:  log pseudolikelihood = -191.50193
Refining estimates:
Iteration 0:   log pseudolikelihood = -191.50193
Iteration 1:   log pseudolikelihood = -191.50193
Iteration 2:   log pseudolikelihood = -191.50193

Stratified Cox regr. -- no ties

No. of subjects      =          496             Number of obs    =         746
No. of failures      =          104
Time at risk         =       325147
                                                Wald chi2(22)    =     1721.86
Log pseudolikelihood =   -191.50193             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 251 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5705342   .3356789    -0.95   0.340     .1800817    1.807564
      age_tv |   .9976836   .0068532    -0.34   0.736     .9843416    1.011206
        male |   1.235829   .4004277     0.65   0.513     .6548713    2.332173
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .4546329   .2765715    -1.30   0.195     .1379878    1.497894
      Asian  |   1.016653   .4831382     0.03   0.972     .4005537    2.580384
      Black  |   .9563466   .6098468    -0.07   0.944     .2740424    3.337435
      Other  |   1.410602   .7473128     0.65   0.516     .4994049    3.984341
    Unknown  |   .6582144   .5980126    -0.46   0.645     .1109223    3.905854
             |
         imd |
          2  |   .5121479   .3277254    -1.05   0.296     .1461196    1.795074
          3  |   .8264619    .410743    -0.38   0.701     .3120214    2.189078
          4  |   1.269541   .5545904     0.55   0.585     .5392682    2.988741
          5  |   .9254338   .4544588    -0.16   0.875       .35346    2.422984
          6  |    2.12512   1.291791     1.24   0.215     .6456036    6.995217
             |
     bmi_cat |
Underweight  |   1.114344   .4732563     0.25   0.799     .4847504    2.561653
 Overweight  |   .8832561   .3669297    -0.30   0.765      .391267    1.993884
      Obese  |   .3552943    .163649    -2.25   0.025     .1440535    .8763001
Morbidly ..  |   1.159358   .7633925     0.22   0.822     .3189584    4.214062
             |
     smoking |
Current s..  |   .5796889   .2659685    -1.19   0.235     .2358594    1.424744
  Ex-smoker  |   .4275587   .2785113    -1.30   0.192      .119268    1.532737
             |
severe_dis~e |    .697293   .2361395    -1.06   0.287     .3590495    1.354179
covid_vacc~t |   1.032635   .4350191     0.08   0.939      .452231    2.357943
 liver_trans |   4.85e-16   5.07e-16   -33.77   0.000     6.27e-17    3.76e-15
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  91
no udca events = 91
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        438      583882           0     583882     583882
19462.733
467.56023

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        438       87.60       87.60
          1 |         62       12.40      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 14

. 
. file write tablecontent _n ("PSC only sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  6.     count if `outcome'_flag==1 & has_pbc==0
  7.     if r(N) > 10 {
  8.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
  9.         graph export ./output/graphs/km_psc_`outcome'.svg, as(svg) replace
 10.         * Cox model - crude
.         stcox udca if has_pbc==0, strata(stp) vce(robust)
 11.         estimates save "./output/tempdata/crude_`outcome'", replace 
 12.         eststo model10
 13.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_psc_`outcome'", replace) idstr("crude_`outcome'") 
 14.         estat phtest, detail
 15.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_psc_`outcome') ///
>                     note("")
 16.         * Cox model - age and sex adjusted
.         stcox udca age_tv male if has_pbc==0, strata(stp) vce(robust)
 17.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 18.         eststo model11
 19.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_psc_`outcome'", replace) idstr("adj_`outcome'") 
 20.         estat phtest, detail
 21.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==0, st
> rata(stp) vce(robust)
 22.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 23.         eststo model12
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_psc_`outcome'", replace) idstr("adj_`outcome'") 
 25.         estat phtest, detail
 26.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_psc_`outcome') ///
>                     note("")
 27.         graph combine uni_plot_psc_`outcome' adj_plot_psc_`outcome'
 28.         graph export ./output/graphs/schoenplot_psc_`outcome'.svg, as(svg)
>  replace 
 29.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans if has_pbc==0, 
> strata(stp) vce(robust)
 30.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 31.         tab number 
 32.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 33.         tab unexposed_ever if number==1 & has_pbc==0
 34.         safecount if unexposed_ever==0 & has_pbc==0 & number==1
 35.         local denominator = r(N)
 36.         safecount if udca == 0 & `outcome'_flag == 1 & has_pbc==0
 37.         local event = r(N)
 38.         di "no udca events = " `event'
 39.         bysort udca: egen total_follow_up = total(_t) if number==1
 40.         su total_follow_up if udca==0 & number==1 & has_pbc==0
 41.         local person_mth = r(mean)/30
 42.         di `person_mth'
 43.         local rate = 100000*(`event'/`person_mth')
 44.         di `rate'
 45.         if `event'>10 & `event'!=. {
 46.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 47.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 48.             }
 49.         else {
 50.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 51.             continue
 52.         }
 53.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 54.         tab exposed_ever if number==1 & has_pbc==0
 55.         qui safecount if exposed_ever==1 & number==1 & has_pbc==0
 56.         local denominator = r(N)
 57.         qui safecount if udca == 1 & `outcome'_flag == 1 & has_pbc==0
 58.         local event = r(N)
 59.         di "udca events = " `event'
 60.         qui su total_follow_up if udca==1 & number==1 & has_pbc==0
 61.         local person_mth = r(mean)/30
 62.         local rate = 100000*(`event'/`person_mth')
 63.         if `event'>10 & `event'!=. {
 64.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 65.             cap estimates use "./output/tempdata/crude_`outcome'" 
 66.             cap lincom udca, eform
 67.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 68.             cap estimates clear
 69.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 70.             cap lincom udca, eform
 71.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 72.             cap estimates clear
 73.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 74.             cap lincom udca, eform
 75.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 76.             cap estimates clear
 77.         }
 78.         else {
 79.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 80.             continue
 81.         }
 82.     
. drop total_follow_up
 83.     }
 84. else { 
 85.     file write tablecontent ("`outcome'") _tab ("redact") _n
 86.     continue
 87. }
 88. 
. }

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         3,012                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      3,012  total observations
          0  exclusions
------------------------------------------------------------------------------
      3,012  observations remaining, representing
      1,000  subjects
        165  failures in single-failure-per-subject data
    676,087  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  82

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_psc_died_covid_any.svg not found)
(file ./output/graphs/km_psc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -155.01237
Iteration 1:   log pseudolikelihood = -154.78202
Iteration 2:   log pseudolikelihood = -154.77386
Iteration 3:   log pseudolikelihood = -154.77386
Refining estimates:
Iteration 0:   log pseudolikelihood = -154.77386

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          500             Number of obs    =         732
No. of failures      =           82
Time at risk         =       335823
                                                Wald chi2(1)     =        0.59
Log pseudolikelihood =   -154.77386             Prob > chi2      =      0.4409

                           (Std. Err. adjusted for 246 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.471588   .7376558     0.77   0.441     .5509454    3.930646
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_psc_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_psc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.12063         0.47        1         0.4935
      ------------+---------------------------------------------------
      global test |                      0.47        1         0.4935
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -154.70314
Iteration 1:   log pseudolikelihood = -154.25975
Iteration 2:   log pseudolikelihood = -154.25238
Iteration 3:   log pseudolikelihood = -154.25238
Refining estimates:
Iteration 0:   log pseudolikelihood = -154.25238

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         727
No. of failures      =           80
Time at risk         =       333819
                                                Wald chi2(3)     =        0.94
Log pseudolikelihood =   -154.25238             Prob > chi2      =      0.8153

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.439388   .7138434     0.73   0.463     .5445493    3.804686
      age_tv |   .9997472   .0071501    -0.04   0.972     .9858311     1.01386
        male |   .8046548   .2561136    -0.68   0.495     .4312018    1.501546
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_psc_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_psc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.10219         0.35        1         0.5566
      age_tv      |      0.09267         0.44        1         0.5090
      male        |      0.06644         0.16        1         0.6851
      ------------+---------------------------------------------------
      global test |                      0.95        3         0.8143
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -154.70314
Iteration 1:   log pseudolikelihood = -148.35018
Iteration 2:   log pseudolikelihood = -147.70141
Iteration 3:   log pseudolikelihood = -147.56892
Iteration 4:   log pseudolikelihood = -147.52111
Iteration 5:   log pseudolikelihood = -147.50356
Iteration 6:   log pseudolikelihood = -147.49711
Iteration 7:   log pseudolikelihood = -147.49474
Iteration 8:   log pseudolikelihood = -147.49387
Iteration 9:   log pseudolikelihood = -147.49354
Iteration 10:  log pseudolikelihood = -147.49343
Iteration 11:  log pseudolikelihood = -147.49338
Iteration 12:  log pseudolikelihood = -147.49337
Iteration 13:  log pseudolikelihood = -147.49336
Iteration 14:  log pseudolikelihood = -147.49336
Iteration 15:  log pseudolikelihood = -147.49336
Iteration 16:  log pseudolikelihood = -147.49336
Iteration 17:  log pseudolikelihood = -147.49336
Iteration 18:  log pseudolikelihood = -147.49336
Iteration 19:  log pseudolikelihood = -147.49336
Iteration 20:  log pseudolikelihood = -147.49336
Iteration 21:  log pseudolikelihood = -147.49336
Iteration 22:  log pseudolikelihood = -147.49336
Iteration 23:  log pseudolikelihood = -147.49336
Iteration 24:  log pseudolikelihood = -147.49336
Iteration 25:  log pseudolikelihood = -147.49336
Iteration 26:  log pseudolikelihood = -147.49336
Iteration 27:  log pseudolikelihood = -147.49336
Iteration 28:  log pseudolikelihood = -147.49336
Iteration 29:  log pseudolikelihood = -147.49336
Iteration 30:  log pseudolikelihood = -147.49336
Iteration 31:  log pseudolikelihood = -147.49336
Iteration 32:  log pseudolikelihood = -147.49336
Iteration 33:  log pseudolikelihood = -147.49336
Iteration 34:  log pseudolikelihood = -147.49336
Iteration 35:  log pseudolikelihood = -147.49336
Iteration 36:  log pseudolikelihood = -147.49336
Iteration 37:  log pseudolikelihood = -147.49336
Iteration 38:  log pseudolikelihood = -147.49336
Iteration 39:  log pseudolikelihood = -147.49336
Iteration 40:  log pseudolikelihood = -147.49336
Iteration 41:  log pseudolikelihood = -147.49336
Iteration 42:  log pseudolikelihood = -147.49336
Iteration 43:  log pseudolikelihood = -147.49336
Refining estimates:
Iteration 0:   log pseudolikelihood = -147.49336
Iteration 1:   log pseudolikelihood = -147.49336
Iteration 2:   log pseudolikelihood = -147.49336

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         727
No. of failures      =           80
Time at risk         =       333819
                                                Wald chi2(17)    =       13.93
Log pseudolikelihood =   -147.49336             Prob > chi2      =      0.6722

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.307643   .6070334     0.58   0.563     .5264353    3.248131
      age_tv |   .9994739   .0075606    -0.07   0.945     .9847647    1.014403
        male |   .7494707   .2337905    -0.92   0.355     .4066588    1.381272
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .6191297   .2634137    -1.13   0.260      .268925    1.425385
    Unknown  |   2.08e-20          .        .       .            .           .
             |
         imd |
          2  |   1.497069   .8138388     0.74   0.458     .5158347    4.344834
          3  |   .6347271   .4731016    -0.61   0.542     .1472765    2.735524
          4  |   1.067834   .6627866     0.11   0.916      .316357    3.604377
          5  |   1.030029   .5714441     0.05   0.957     .3472293    3.055504
          6  |   .7712179   .8694598    -0.23   0.818      .084634    7.027637
             |
     bmi_cat |
Underweight  |    .928456   .5395761    -0.13   0.898     .2972227    2.900285
 Overweight  |   .5041849   .2844928    -1.21   0.225     .1668355    1.523671
      Obese  |   1.141725   .4684908     0.32   0.747     .5108378    2.551762
Morbidly ..  |   .3159968   .3618195    -1.01   0.314     .0335003    2.980692
             |
     smoking |
Current s..  |   1.045623   .6407335     0.07   0.942     .3146144    3.475135
  Ex-smoker  |   1.997476   1.454851     0.95   0.342     .4791962    8.326257
             |
severe_dis~e |   .9334603   .3725073    -0.17   0.863     .4269871     2.04069
covid_vacc~t |   .6029031   .3328127    -0.92   0.359     .2043478    1.778792
 liver_trans |   1.79e-18          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_psc_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_psc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.00043         0.00        1         0.9979
      age_tv      |      0.25126         5.53        1         0.0187
      male        |      0.18665         2.22        1         0.1364
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.12151         0.99        1         0.3191
      2.eth_bin   |            .            .        1             .
      1b.imd      |            .            .        1             .
      2.imd       |      0.32056         8.01        1         0.0046
      3.imd       |      0.04594         0.12        1         0.7331
      4.imd       |      0.26112         6.44        1         0.0111
      5.imd       |      0.29788         6.67        1         0.0098
      6.imd       |      0.26356         4.02        1         0.0449
      1.bmi_cat   |      0.18912         2.50        1         0.1142
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.01656         0.01        1         0.9047
      4.bmi_cat   |      0.40126        12.60        1         0.0004
      5.bmi_cat   |      0.16701         2.59        1         0.1076
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.29057         6.73        1         0.0095
      2.smoking   |      0.27510         6.51        1         0.0107
      severe_dis~e|      0.08357         0.58        1         0.4445
      covid_vacc~t|     -0.02888         0.05        1         0.8199
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     27.62       17         0.0495
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_psc_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_psc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -154.70314
Iteration 1:   log pseudolikelihood = -147.36238
Iteration 2:   log pseudolikelihood = -146.67117
Iteration 3:   log pseudolikelihood = -146.53829
Iteration 4:   log pseudolikelihood = -146.49042
Iteration 5:   log pseudolikelihood = -146.47285
Iteration 6:   log pseudolikelihood = -146.46639
Iteration 7:   log pseudolikelihood = -146.46402
Iteration 8:   log pseudolikelihood = -146.46315
Iteration 9:   log pseudolikelihood = -146.46282
Iteration 10:  log pseudolikelihood = -146.46271
Iteration 11:  log pseudolikelihood = -146.46266
Iteration 12:  log pseudolikelihood = -146.46265
Iteration 13:  log pseudolikelihood = -146.46264
Iteration 14:  log pseudolikelihood = -146.46264
Iteration 15:  log pseudolikelihood = -146.46264
Iteration 16:  log pseudolikelihood = -146.46264
Iteration 17:  log pseudolikelihood = -146.46264
Iteration 18:  log pseudolikelihood = -146.46264
Iteration 19:  log pseudolikelihood = -146.46264
Iteration 20:  log pseudolikelihood = -146.46264
Iteration 21:  log pseudolikelihood = -146.46264
Iteration 22:  log pseudolikelihood = -146.46264
Iteration 23:  log pseudolikelihood = -146.46264
Iteration 24:  log pseudolikelihood = -146.46264
Iteration 25:  log pseudolikelihood = -146.46264
Iteration 26:  log pseudolikelihood = -146.46264
Iteration 27:  log pseudolikelihood = -146.46264
Iteration 28:  log pseudolikelihood = -146.46264
Iteration 29:  log pseudolikelihood = -146.46264
Iteration 30:  log pseudolikelihood = -146.46264
Iteration 31:  log pseudolikelihood = -146.46264
Iteration 32:  log pseudolikelihood = -146.46264
Refining estimates:
Iteration 0:   log pseudolikelihood = -146.46264
Iteration 1:   log pseudolikelihood = -146.46264

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         727
No. of failures      =           80
Time at risk         =       333819
                                                Wald chi2(22)    =     5111.98
Log pseudolikelihood =   -146.46264             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.179912   .5421419     0.36   0.719     .4794489    2.903734
      age_tv |   .9997628   .0079406    -0.03   0.976     .9843201    1.015448
        male |   .7546049   .2517991    -0.84   0.399     .3923629    1.451281
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6555701   .3385621    -0.82   0.414     .2382459    1.803902
      Asian  |   .8080403   .4091809    -0.42   0.674     .2994993    2.180069
      Black  |    .358325   .2174951    -1.69   0.091     .1090479    1.177435
      Other  |   .5629488   .3276013    -0.99   0.323     .1799378    1.761227
    Unknown  |   3.34e-15   2.42e-15   -46.06   0.000     8.09e-16    1.38e-14
             |
         imd |
          2  |   1.493166   .8335961     0.72   0.473     .4999243    4.459765
          3  |   .5512826   .4381227    -0.75   0.454      .116117    2.617294
          4  |   1.049571    .647849     0.08   0.938     .3130446    3.518982
          5  |   1.007348    .583074     0.01   0.990     .3239561    3.132368
          6  |   .7263675   .8011361    -0.29   0.772     .0836251    6.309229
             |
     bmi_cat |
Underweight  |   .8937523   .4997279    -0.20   0.841     .2987314    2.673951
 Overweight  |   .4790336   .2697666    -1.31   0.191     .1588598    1.444501
      Obese  |   1.091654   .4658993     0.21   0.837     .4729404    2.519784
Morbidly ..  |   .3047061   .3467644    -1.04   0.296     .0327483    2.835132
             |
     smoking |
Current s..  |   1.087887   .6668136     0.14   0.891     .3272238    3.616784
  Ex-smoker  |   2.172256    1.59882     1.05   0.292     .5133472    9.192017
             |
severe_dis~e |   .9782893   .3906305    -0.05   0.956     .4472835    2.139694
covid_vacc~t |   .5904189   .3254193    -0.96   0.339     .2004501    1.739059
 liver_trans |   4.88e-15   6.53e-15   -24.61   0.000     3.54e-16    6.73e-14
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,012       66.80       66.80
          1 |      1,000       33.20      100.00
------------+-----------------------------------
      Total |      3,012      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  75
no udca events = 75
(2012 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        462      606518           0     606518     606518
20217.267
370.97003

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        462       92.40       92.40
          1 |         38        7.60      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 7

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,933                          
 vars:            21                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
         57  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  29

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_psc_hosp_any.svg not found)
(file ./output/graphs/km_psc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -50.973492
Iteration 1:   log pseudolikelihood = -50.971246
Iteration 2:   log pseudolikelihood = -50.971244
Refining estimates:
Iteration 0:   log pseudolikelihood = -50.971244

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         718
No. of failures      =           29
Time at risk         =       324704
                                                Wald chi2(1)     =        0.00
Log pseudolikelihood =   -50.971244             Prob > chi2      =      0.9479

                           (Std. Err. adjusted for 246 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9329221   .9916991    -0.07   0.948      .116149    7.493337
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_psc_hosp_any.dta not found)
file ./output/tempdata/surv_crude_psc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.10792         0.16        1         0.6934
      ------------+---------------------------------------------------
      global test |                      0.16        1         0.6934
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -50.911891
Iteration 1:   log pseudolikelihood = -50.880256
Iteration 2:   log pseudolikelihood = -50.880254
Refining estimates:
Iteration 0:   log pseudolikelihood = -50.880254

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         713
No. of failures      =           29
Time at risk         =       322700
                                                Wald chi2(3)     =        0.11
Log pseudolikelihood =   -50.880254             Prob > chi2      =      0.9910

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9562831   1.064453    -0.04   0.968     .1079198    8.473678
      age_tv |   1.000286   .0115992     0.02   0.980     .9778078     1.02328
        male |   1.144816   .6366472     0.24   0.808     .3849205    3.404866
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_psc_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_psc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.08454         0.14        1         0.7059
      age_tv      |      0.49703         4.25        1         0.0392
      male        |     -0.26589         1.61        1         0.2048
      ------------+---------------------------------------------------
      global test |                      4.97        3         0.1737
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -50.911891
Iteration 1:   log pseudolikelihood = -50.356611
Iteration 2:   log pseudolikelihood = -49.995503
Iteration 3:   log pseudolikelihood = -42.770859
Iteration 4:   log pseudolikelihood = -39.987841
Iteration 5:   log pseudolikelihood = -39.425034
Iteration 6:   log pseudolikelihood = -39.377511
Iteration 7:   log pseudolikelihood = -39.365344
Iteration 8:   log pseudolikelihood = -39.360882
Iteration 9:   log pseudolikelihood = -39.359242
Iteration 10:  log pseudolikelihood = -39.358639
Iteration 11:  log pseudolikelihood = -39.358417
Iteration 12:  log pseudolikelihood = -39.358336
Iteration 13:  log pseudolikelihood = -39.358306
Iteration 14:  log pseudolikelihood = -39.358295
Iteration 15:  log pseudolikelihood = -39.358291
Iteration 16:  log pseudolikelihood = -39.358289
Iteration 17:  log pseudolikelihood = -39.358289
Iteration 18:  log pseudolikelihood = -39.358288
Iteration 19:  log pseudolikelihood = -39.358288
Iteration 20:  log pseudolikelihood = -39.358288
Iteration 21:  log pseudolikelihood = -39.358288
Iteration 22:  log pseudolikelihood = -39.358288
Iteration 23:  log pseudolikelihood = -39.358288
Iteration 24:  log pseudolikelihood = -39.358288
Iteration 25:  log pseudolikelihood = -39.358288
Iteration 26:  log pseudolikelihood = -39.358288
Iteration 27:  log pseudolikelihood = -39.358288
Iteration 28:  log pseudolikelihood = -39.358288
Iteration 29:  log pseudolikelihood = -39.358288
Iteration 30:  log pseudolikelihood = -39.358288
Iteration 31:  log pseudolikelihood = -39.358288
Iteration 32:  log pseudolikelihood = -39.358288
Iteration 33:  log pseudolikelihood = -39.358288
Iteration 34:  log pseudolikelihood = -39.358288
Iteration 35:  log pseudolikelihood = -39.358288
Refining estimates:
Iteration 0:   log pseudolikelihood = -39.358288
Iteration 1:   log pseudolikelihood = -39.358288
Iteration 2:   log pseudolikelihood = -39.358288
Iteration 3:   log pseudolikelihood = -39.358288
Iteration 4:   log pseudolikelihood = -39.358288
Iteration 5:   log pseudolikelihood = -39.358288
Iteration 6:   log pseudolikelihood = -39.358288
Iteration 7:   log pseudolikelihood = -39.358288
Iteration 8:   log pseudolikelihood = -39.358288

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         713
No. of failures      =           29
Time at risk         =       322700
                                                Wald chi2(16)    =     2527.74
Log pseudolikelihood =   -39.358288             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.057996   1.681994     0.04   0.972     .0469084     23.8626
      age_tv |   .9926334   .0119801    -0.61   0.540     .9694283    1.016394
        male |   1.036541   .5962222     0.06   0.950     .3357165    3.200374
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .6768907   .6025588    -0.44   0.661     .1182471    3.874775
    Unknown  |   13.52757   14.71305     2.39   0.017     1.604812    114.0291
             |
         imd |
          2  |   1.05e+10   1.54e+10    15.75   0.000     5.94e+08    1.85e+11
          3  |   2.91e+10   4.56e+10    15.36   0.000     1.34e+09    6.30e+11
          4  |   2.82e+09          .        .       .            .           .
          5  |   1.46e+10   2.12e+10    16.10   0.000     8.46e+08    2.52e+11
          6  |   1.86e+10   2.59e+10    16.94   0.000     1.20e+09    2.86e+11
             |
     bmi_cat |
Underweight  |   3.34e-20          .        .       .            .           .
 Overweight  |    .940956   .6074911    -0.09   0.925     .2654756    3.335139
      Obese  |   1.452785   1.086958     0.50   0.618     .3352292    6.295945
Morbidly ..  |   1.22e-19   1.89e-19   -28.24   0.000     5.95e-21    2.51e-18
             |
     smoking |
Current s..  |   .7567588   .5813473    -0.36   0.717      .167903    3.410801
  Ex-smoker  |    1.08314   1.958062     0.04   0.965     .0313266     37.4504
             |
severe_dis~e |   1.010088   .6816939     0.01   0.988      .269089    3.791603
covid_vacc~t |   1.102898   .8626013     0.13   0.900     .2381176    5.108334
 liver_trans |   .0024784          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_psc_hosp_any.dta not found)
file ./output/tempdata/surv_adj_psc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.00308         0.00        1         0.9734
      age_tv      |      0.34064         7.47        1         0.0063
      male        |     -0.10155         0.69        1         0.4061
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.59194        20.65        1         0.0000
      2.eth_bin   |     -0.40330         5.22        1         0.0223
      1b.imd      |            .            .        1             .
      2.imd       |      0.24025         3.29        1         0.0697
      3.imd       |      0.35637         8.07        1         0.0045
      4.imd       |            .            .        1             .
      5.imd       |      0.01791         0.01        1         0.9048
      6.imd       |      0.33340         4.49        1         0.0342
      1.bmi_cat   |            .            .        1             .
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.13754         1.06        1         0.3038
      4.bmi_cat   |     -0.12771         1.22        1         0.2691
      5.bmi_cat   |     -0.12873         0.26        1         0.6097
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.40667         6.21        1         0.0127
      2.smoking   |      0.15348         2.68        1         0.1019
      severe_dis~e|      0.06167         0.17        1         0.6780
      covid_vacc~t|      0.32685         3.59        1         0.0583
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     37.81       16         0.0016
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_psc_hosp_any.svg not found)
(file ./output/graphs/schoenplot_psc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -50.911891
Iteration 1:   log pseudolikelihood = -49.935991
Iteration 2:   log pseudolikelihood = -49.727026
Iteration 3:   log pseudolikelihood = -42.297307
Iteration 4:   log pseudolikelihood = -39.345778
Iteration 5:   log pseudolikelihood = -38.748383
Iteration 6:   log pseudolikelihood = -38.680219
Iteration 7:   log pseudolikelihood = -38.667801
Iteration 8:   log pseudolikelihood =  -38.66325
Iteration 9:   log pseudolikelihood = -38.661578
Iteration 10:  log pseudolikelihood = -38.660963
Iteration 11:  log pseudolikelihood = -38.660737
Iteration 12:  log pseudolikelihood = -38.660653
Iteration 13:  log pseudolikelihood = -38.660623
Iteration 14:  log pseudolikelihood = -38.660612
Iteration 15:  log pseudolikelihood = -38.660607
Iteration 16:  log pseudolikelihood = -38.660606
Iteration 17:  log pseudolikelihood = -38.660605
Iteration 18:  log pseudolikelihood = -38.660605
Iteration 19:  log pseudolikelihood = -38.660605
Iteration 20:  log pseudolikelihood = -38.660605
Iteration 21:  log pseudolikelihood = -38.660605
Iteration 22:  log pseudolikelihood = -38.660605
Iteration 23:  log pseudolikelihood = -38.660605
Iteration 24:  log pseudolikelihood = -38.660605
Iteration 25:  log pseudolikelihood = -38.660605
Iteration 26:  log pseudolikelihood = -38.660605
Iteration 27:  log pseudolikelihood = -38.660605
Iteration 28:  log pseudolikelihood = -38.660605
Iteration 29:  log pseudolikelihood = -38.660605
Iteration 30:  log pseudolikelihood = -38.660605
Iteration 31:  log pseudolikelihood = -38.660605
Iteration 32:  log pseudolikelihood = -38.660605
Iteration 33:  log pseudolikelihood = -38.660605
Iteration 34:  log pseudolikelihood = -38.660605
Iteration 35:  log pseudolikelihood = -38.660605
Refining estimates:
Iteration 0:   log pseudolikelihood = -38.660605
Iteration 1:   log pseudolikelihood = -38.660605
Iteration 2:   log pseudolikelihood = -38.660605
Iteration 3:   log pseudolikelihood = -38.660605
Iteration 4:   log pseudolikelihood = -38.660605
Iteration 5:   log pseudolikelihood = -38.660605

Stratified Cox regr. -- no ties

No. of subjects      =          495             Number of obs    =         713
No. of failures      =           29
Time at risk         =       322700
                                                Wald chi2(20)    =     8537.92
Log pseudolikelihood =   -38.660605             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9388014   1.593582    -0.04   0.970     .0337046    26.14918
      age_tv |   .9944786   .0119294    -0.46   0.644     .9713702    1.018137
        male |   1.025112    .600774     0.04   0.966     .3250266    3.233135
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |    .762591   .8646297    -0.24   0.811     .0826408    7.037016
      Asian  |   .6716639   .6451222    -0.41   0.679      .102232     4.41283
      Black  |   .2645406   .3104827    -1.13   0.257     .0265133     2.63949
      Other  |   1.056252   1.172093     0.05   0.961      .120009    9.296545
    Unknown  |   14.02846   15.58929     2.38   0.017     1.588922    123.8561
             |
         imd |
          2  |   9.94e+09   1.50e+10    15.27   0.000     5.18e+08    1.91e+11
          3  |   3.28e+10   5.36e+10    14.83   0.000     1.34e+09    8.05e+11
          4  |   2.62e+09          .        .       .            .           .
          5  |   1.31e+10   2.07e+10    14.78   0.000     5.98e+08    2.88e+11
          6  |   1.60e+10   2.29e+10    16.45   0.000     9.74e+08    2.63e+11
             |
     bmi_cat |
Underweight  |   6.59e-19   8.44e-19   -32.65   0.000     5.34e-20    8.13e-18
 Overweight  |   1.008237   .7515413     0.01   0.991     .2339245    4.345597
      Obese  |   1.484818   1.279782     0.46   0.647     .2741655    8.041437
Morbidly ..  |   2.24e-18   3.56e-18   -25.53   0.000     9.88e-20    5.07e-17
             |
     smoking |
Current s..  |   .7913908   .5651936    -0.33   0.743     .1952009    3.208486
  Ex-smoker  |     1.4253   2.805324     0.18   0.857     .0300984    67.49468
             |
severe_dis~e |   1.092439   .7444564     0.13   0.897     .2872996    4.153931
covid_vacc~t |   1.062123   .8975978     0.07   0.943      .202687    5.565747
 liver_trans |   .0019786          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  27
no udca events = 27
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        462      583882           0     583882     583882
19462.733
138.72666

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        462       92.40       92.40
          1 |         38        7.60      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = .

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,933                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,933  total observations
          0  exclusions
------------------------------------------------------------------------------
      2,933  observations remaining, representing
      1,000  subjects
        214  failures in single-failure-per-subject data
    652,131  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  109

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_psc_composite_any.svg not found)
(file ./output/graphs/km_psc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -200.68232
Iteration 1:   log pseudolikelihood = -200.52939
Iteration 2:   log pseudolikelihood = -200.52699
Iteration 3:   log pseudolikelihood = -200.52698
Refining estimates:
Iteration 0:   log pseudolikelihood = -200.52698

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          500             Number of obs    =         718
No. of failures      =          109
Time at risk         =       324704
                                                Wald chi2(1)     =        0.37
Log pseudolikelihood =   -200.52698             Prob > chi2      =      0.5438

                           (Std. Err. adjusted for 246 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    1.31542   .5940231     0.61   0.544     .5428444    3.187526
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_psc_composite_any.dta not found)
file ./output/tempdata/surv_crude_psc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.05662         0.14        1         0.7089
      ------------+---------------------------------------------------
      global test |                      0.14        1         0.7089
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -200.30796
Iteration 1:   log pseudolikelihood = -200.12907
Iteration 2:   log pseudolikelihood = -200.12693
Iteration 3:   log pseudolikelihood = -200.12693
Refining estimates:
Iteration 0:   log pseudolikelihood = -200.12693

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         713
No. of failures      =          107
Time at risk         =       322700
                                                Wald chi2(3)     =        0.41
Log pseudolikelihood =   -200.12693             Prob > chi2      =      0.9380

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.294205   .5852538     0.57   0.568     .5334338    3.139973
      age_tv |   .9996779   .0060989    -0.05   0.958     .9877954    1.011703
        male |   .9299501   .2574684    -0.26   0.793     .5404977     1.60002
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_psc_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_psc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.05804         0.15        1         0.7028
      age_tv      |      0.20526         2.53        1         0.1119
      male        |     -0.00892         0.00        1         0.9522
      ------------+---------------------------------------------------
      global test |                      2.67        3         0.4446
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -200.30796
Iteration 1:   log pseudolikelihood = -194.71292
Iteration 2:   log pseudolikelihood =  -194.4801
Iteration 3:   log pseudolikelihood = -194.47022
Iteration 4:   log pseudolikelihood = -194.46867
Iteration 5:   log pseudolikelihood =  -194.4681
Iteration 6:   log pseudolikelihood = -194.46789
Iteration 7:   log pseudolikelihood = -194.46782
Iteration 8:   log pseudolikelihood = -194.46779
Iteration 9:   log pseudolikelihood = -194.46778
Iteration 10:  log pseudolikelihood = -194.46778
Iteration 11:  log pseudolikelihood = -194.46777
Iteration 12:  log pseudolikelihood = -194.46777
Iteration 13:  log pseudolikelihood = -194.46777
Iteration 14:  log pseudolikelihood = -194.46777
Iteration 15:  log pseudolikelihood = -194.46777
Iteration 16:  log pseudolikelihood = -194.46777
Iteration 17:  log pseudolikelihood = -194.46777
Iteration 18:  log pseudolikelihood = -194.46777
Iteration 19:  log pseudolikelihood = -194.46777
Iteration 20:  log pseudolikelihood = -194.46777
Iteration 21:  log pseudolikelihood = -194.46777
Iteration 22:  log pseudolikelihood = -194.46777
Iteration 23:  log pseudolikelihood = -194.46777
Iteration 24:  log pseudolikelihood = -194.46777
Iteration 25:  log pseudolikelihood = -194.46777
Iteration 26:  log pseudolikelihood = -194.46777
Iteration 27:  log pseudolikelihood = -194.46777
Iteration 28:  log pseudolikelihood = -194.46777
Iteration 29:  log pseudolikelihood = -194.46777
Iteration 30:  log pseudolikelihood = -194.46777
Refining estimates:
Iteration 0:   log pseudolikelihood = -194.46777
Iteration 1:   log pseudolikelihood = -194.46777

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         713
No. of failures      =          107
Time at risk         =       322700
                                                Wald chi2(19)    =      674.62
Log pseudolikelihood =   -194.46777             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    1.25208   .5400963     0.52   0.602      .537599    2.916122
      age_tv |   .9999007   .0063072    -0.02   0.987      .987615    1.012339
        male |   .8818753   .2487903    -0.45   0.656     .5073065    1.533006
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .6299903   .2374772    -1.23   0.220     .3009333    1.318856
    Unknown  |   .8660144   .7193354    -0.17   0.863     .1700175    4.411198
             |
         imd |
          2  |   1.805897   .9194964     1.16   0.246     .6657211    4.898843
          3  |    1.55722   .9315609     0.74   0.459     .4821071    5.029863
          4  |   1.159266   .6822683     0.25   0.802     .3657815    3.674047
          5  |   1.375807   .7337261     0.60   0.550     .4837344    3.912987
          6  |   2.122035   1.469144     1.09   0.277     .5463136     8.24258
             |
     bmi_cat |
Underweight  |   .6315249   .3596687    -0.81   0.420     .2068286    1.928281
 Overweight  |    .708554   .3181417    -0.77   0.443     .2938884    1.708298
      Obese  |   1.274068   .4265759     0.72   0.469     .6609955    2.455766
Morbidly ..  |   .2321013   .2564623    -1.32   0.186     .0266155    2.024043
             |
     smoking |
Current s..  |   .9781142   .4584646    -0.05   0.962     .3903119    2.451135
  Ex-smoker  |   2.005396   1.138747     1.23   0.220     .6589506    6.103058
             |
severe_dis~e |   1.082476   .3642915     0.24   0.814     .5597049    2.093523
covid_vacc~t |    .727707   .3620253    -0.64   0.523     .2744696    1.929385
 liver_trans |   3.59e-14   4.73e-14   -23.50   0.000     2.71e-15    4.75e-13
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_psc_composite_any.dta not found)
file ./output/tempdata/surv_adj_psc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.02081         0.02        1         0.8778
      age_tv      |      0.23763         4.93        1         0.0263
      male        |      0.04342         0.13        1         0.7169
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.02553         0.06        1         0.8102
      2.eth_bin   |     -0.05713         0.30        1         0.5817
      1b.imd      |            .            .        1             .
      2.imd       |      0.21134         4.08        1         0.0434
      3.imd       |      0.06224         0.39        1         0.5308
      4.imd       |      0.16906         2.90        1         0.0886
      5.imd       |      0.12063         1.33        1         0.2496
      6.imd       |      0.28474         4.73        1         0.0297
      1.bmi_cat   |      0.15990         1.93        1         0.1645
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.03119         0.08        1         0.7783
      4.bmi_cat   |      0.31626         6.66        1         0.0099
      5.bmi_cat   |      0.09928         1.03        1         0.3098
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.18501         2.69        1         0.1013
      2.smoking   |      0.16541         1.94        1         0.1642
      severe_dis~e|      0.08195         0.68        1         0.4080
      covid_vacc~t|     -0.02978         0.06        1         0.8087
      liver_trans |      0.00146         0.00        1         0.9955
      ------------+---------------------------------------------------
      global test |                     17.74       19         0.5399
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_psc_composite_any.svg not found)
(file ./output/graphs/schoenplot_psc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -200.30796
Iteration 1:   log pseudolikelihood = -193.58094
Iteration 2:   log pseudolikelihood = -193.31475
Iteration 3:   log pseudolikelihood = -193.30567
Iteration 4:   log pseudolikelihood = -193.30417
Iteration 5:   log pseudolikelihood = -193.30363
Iteration 6:   log pseudolikelihood = -193.30342
Iteration 7:   log pseudolikelihood = -193.30335
Iteration 8:   log pseudolikelihood = -193.30332
Iteration 9:   log pseudolikelihood = -193.30331
Iteration 10:  log pseudolikelihood = -193.30331
Iteration 11:  log pseudolikelihood = -193.30331
Iteration 12:  log pseudolikelihood = -193.30331
Iteration 13:  log pseudolikelihood = -193.30331
Iteration 14:  log pseudolikelihood = -193.30331
Iteration 15:  log pseudolikelihood = -193.30331
Iteration 16:  log pseudolikelihood = -193.30331
Iteration 17:  log pseudolikelihood = -193.30331
Iteration 18:  log pseudolikelihood = -193.30331
Iteration 19:  log pseudolikelihood = -193.30331
Iteration 20:  log pseudolikelihood = -193.30331
Iteration 21:  log pseudolikelihood = -193.30331
Iteration 22:  log pseudolikelihood = -193.30331
Iteration 23:  log pseudolikelihood = -193.30331
Iteration 24:  log pseudolikelihood = -193.30331
Iteration 25:  log pseudolikelihood = -193.30331
Iteration 26:  log pseudolikelihood = -193.30331
Iteration 27:  log pseudolikelihood = -193.30331
Refining estimates:
Iteration 0:   log pseudolikelihood = -193.30331
Iteration 1:   log pseudolikelihood = -193.30331
Iteration 2:   log pseudolikelihood = -193.30331
Iteration 3:   log pseudolikelihood = -193.30331

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          495             Number of obs    =         713
No. of failures      =          107
Time at risk         =       322700
                                                Wald chi2(22)    =      692.67
Log pseudolikelihood =   -193.30331             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 244 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.178632   .5030745     0.39   0.700     .5105763    2.720795
      age_tv |   1.001336   .0063365     0.21   0.833     .9889934    1.013833
        male |   .8840904   .2634888    -0.41   0.679     .4929579    1.585563
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .7138796   .3344165    -0.72   0.472     .2850231     1.78801
      Asian  |   .7097919   .3170357    -0.77   0.443     .2957558    1.703448
      Black  |   .3488777    .184391    -1.99   0.046       .12382    .9830045
      Other  |   .6999082   .3521726    -0.71   0.478     .2610612    1.876463
    Unknown  |   .8792241   .7416469    -0.15   0.879     .1683025     4.59313
             |
         imd |
          2  |   1.900672    1.01061     1.21   0.227     .6703676    5.388912
          3  |   1.567973   .9890879     0.71   0.476     .4554017    5.398614
          4  |   1.234742   .7300646     0.36   0.721     .3875136     3.93428
          5  |   1.444192   .8133984     0.65   0.514     .4788624     4.35551
          6  |   2.079114   1.426781     1.07   0.286     .5416839    7.980144
             |
     bmi_cat |
Underweight  |   .5831126   .3338328    -0.94   0.346     .1898621     1.79088
 Overweight  |   .6676742   .3110548    -0.87   0.386      .267922    1.663875
      Obese  |   1.227666   .4204398     0.60   0.549     .6274346    2.402105
Morbidly ..  |   .2319978   .2552267    -1.33   0.184     .0268569    2.004068
             |
     smoking |
Current s..  |   1.007634   .4692413     0.02   0.987      .404492    2.510127
  Ex-smoker  |   2.173023   1.246229     1.35   0.176     .7061549    6.686956
             |
severe_dis~e |   1.144805   .3796668     0.41   0.683      .597635     2.19294
covid_vacc~t |   .6909049   .3450726    -0.74   0.459     .2595886     1.83887
 liver_trans |   8.69e-14   1.14e-13   -22.95   0.000     6.67e-15    1.13e-12
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,933       65.91       65.91
          1 |      1,000       34.09      100.00
------------+-----------------------------------
      Total |      2,933      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  100
no udca events = 100
(1933 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        462      583882           0     583882     583882
19462.733
513.80245

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        462       92.40       92.40
          1 |         38        7.60      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 9

. 
. * Take out people prescribed OCA at baseline  
. file write tablecontent _n ("Remove people prescribed OCA sensitivity analysi
> s") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_mths") _tab ("Rate") _tab ("unadj_hr
> ") _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome', clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2020", "DMY")
  5.     drop if oca_bl==1
  6.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  7.     count if `outcome'_flag==1
  8.     if r(N) > 10 {
  9.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
 10.         graph export ./output/graphs/km_oca_`outcome'.svg, as(svg) replace
 11.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 12.         estimates save "./output/tempdata/crude_`outcome'", replace 
 13.         eststo model7
 14.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_oca_`outcome'", replace) idstr("crude_`outcome'") 
 15.         estat phtest, detail
 16.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_oca_`outcome') ///
>                     note("")
 17.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 18.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 19.         eststo model8
 20.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_oca_`outcome'", replace) idstr("adj_`outcome'") 
 21.         estat phtest, detail
 22.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vce(
> robust)
 23.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 24.         eststo model9
 25.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_oca_`outcome'", replace) idstr("adj_`outcome'") 
 26.         estat phtest, detail
 27.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_oca_`outcome') ///
>                     note("")
 28.         graph combine uni_plot_oca_`outcome' adj_plot_oca_`outcome'
 29.         graph export ./output/graphs/schoenplot_oca_`outcome'.svg, as(svg)
>  replace 
 30.         * Cox model - fully adjusted with binary ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease covid_vacc_first liver_trans, strata(stp) vc
> e(robust)
 31.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 32.         tab number 
 33.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 34.         tab unexposed_ever if number==1
 35.         safecount if unexposed_ever==0 & number==1
 36.         local denominator = r(N)
 37.         safecount if udca == 0 & `outcome'_flag == 1
 38.         local event = r(N)
 39.         di "no udca events = " `event'
 40.         bysort udca: egen total_follow_up = total(_t) if number==1
 41.         su total_follow_up if udca==0 & number==1
 42.         local person_mth = r(mean)/30
 43.         di `person_mth'
 44.         local rate = 100000*(`event'/`person_mth')
 45.         di `rate'
 46.         if `event'>10 & `event'!=. {
 47.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 48.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 49.             }
 50.         else {
 51.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 52.             continue
 53.         }
 54.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 55.         tab exposed_ever if number==1
 56.         qui safecount if exposed_ever==1 & number==1
 57.         local denominator = r(N)
 58.         qui safecount if udca == 1 & `outcome'_flag == 1
 59.         local event = r(N)
 60.         di "udca events = " `event'
 61.         qui su total_follow_up if udca==1 & number==1
 62.         local person_mth = r(mean)/30
 63.         local rate = 100000*(`event'/`person_mth')
 64.         if `event'>10 & `event'!=. {
 65.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 66.             cap estimates use "./output/tempdata/crude_`outcome'" 
 67.             cap lincom udca, eform
 68.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 69.             cap estimates clear
 70.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 71.             cap lincom udca, eform
 72.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 73.             cap estimates clear
 74.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 75.             cap lincom udca, eform
 76.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 77.             cap estimates clear
 78.         }
 79.         else {
 80.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 81.             continue
 82.         }
 83.     
. drop total_follow_up
 84.     }
 85. else { 
 86.     file write tablecontent ("`outcome'") _tab ("redact") _n
 87.     continue
 88. }
 89. 
. }

Contains data from ./output/an_dataset_died_covid_any.dta
  obs:         3,012                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1,510 observations deleted)

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,502  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,502  observations remaining, representing
        500  subjects
         87  failures in single-failure-per-subject data
    328,994  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  87

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_oca_died_covid_any.svg not found)
(file ./output/graphs/km_oca_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -166.24385
Iteration 1:   log pseudolikelihood = -165.46603
Iteration 2:   log pseudolikelihood = -165.41449
Iteration 3:   log pseudolikelihood = -165.41406
Iteration 4:   log pseudolikelihood = -165.41406
Refining estimates:
Iteration 0:   log pseudolikelihood = -165.41406

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         759
No. of failures      =           87
Time at risk         =       328994
                                                Wald chi2(1)     =        1.39
Log pseudolikelihood =   -165.41406             Prob > chi2      =      0.2380

                           (Std. Err. adjusted for 255 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .4390626   .3062707    -1.18   0.238     .1118835    1.723007
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_oca_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_oca_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17523         1.14        1         0.2860
      ------------+---------------------------------------------------
      global test |                      1.14        1         0.2860
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -165.91885
Iteration 1:   log pseudolikelihood = -164.38377
Iteration 2:   log pseudolikelihood =  -164.3304
Iteration 3:   log pseudolikelihood = -164.32995
Iteration 4:   log pseudolikelihood = -164.32995
Refining estimates:
Iteration 0:   log pseudolikelihood = -164.32995

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         755
No. of failures      =           87
Time at risk         =       326924
                                                Wald chi2(3)     =        2.88
Log pseudolikelihood =   -164.32995             Prob > chi2      =      0.4105

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .4520045    .308947    -1.16   0.245     .1183976     1.72561
      age_tv |   1.007981   .0063918     1.25   0.210     .9955307    1.020587
        male |    .945503   .2925471    -0.18   0.856      .515577    1.733933
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_oca_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_oca_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17459         1.16        1         0.2811
      age_tv      |      0.13675         0.72        1         0.3973
      male        |     -0.11523         0.59        1         0.4421
      ------------+---------------------------------------------------
      global test |                      2.15        3         0.5423
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -165.91885
Iteration 1:   log pseudolikelihood = -160.08731
Iteration 2:   log pseudolikelihood = -159.59395
Iteration 3:   log pseudolikelihood =  -159.5685
Iteration 4:   log pseudolikelihood = -159.55968
Iteration 5:   log pseudolikelihood = -159.55644
Iteration 6:   log pseudolikelihood = -159.55525
Iteration 7:   log pseudolikelihood = -159.55481
Iteration 8:   log pseudolikelihood = -159.55465
Iteration 9:   log pseudolikelihood = -159.55459
Iteration 10:  log pseudolikelihood = -159.55457
Iteration 11:  log pseudolikelihood = -159.55456
Iteration 12:  log pseudolikelihood = -159.55456
Iteration 13:  log pseudolikelihood = -159.55456
Iteration 14:  log pseudolikelihood = -159.55456
Iteration 15:  log pseudolikelihood = -159.55456
Iteration 16:  log pseudolikelihood = -159.55456
Iteration 17:  log pseudolikelihood = -159.55456
Iteration 18:  log pseudolikelihood = -159.55456
Iteration 19:  log pseudolikelihood = -159.55456
Iteration 20:  log pseudolikelihood = -159.55456
Iteration 21:  log pseudolikelihood = -159.55456
Iteration 22:  log pseudolikelihood = -159.55456
Iteration 23:  log pseudolikelihood = -159.55456
Iteration 24:  log pseudolikelihood = -159.55456
Iteration 25:  log pseudolikelihood = -159.55456
Iteration 26:  log pseudolikelihood = -159.55456
Iteration 27:  log pseudolikelihood = -159.55456
Iteration 28:  log pseudolikelihood = -159.55456
Iteration 29:  log pseudolikelihood = -159.55456
Iteration 30:  log pseudolikelihood = -159.55456
Iteration 31:  log pseudolikelihood = -159.55456
Iteration 32:  log pseudolikelihood = -159.55456
Iteration 33:  log pseudolikelihood = -159.55456
Iteration 34:  log pseudolikelihood = -159.55456
Refining estimates:
Iteration 0:   log pseudolikelihood = -159.55456
Iteration 1:   log pseudolikelihood = -159.55456
Iteration 2:   log pseudolikelihood = -159.55456

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         755
No. of failures      =           87
Time at risk         =       326924
                                                Wald chi2(19)    =     2410.82
Log pseudolikelihood =   -159.55456             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5168542    .376241    -0.91   0.365     .1240911    2.152759
      age_tv |   1.011715   .0070791     1.66   0.096     .9979352    1.025686
        male |   .9815196   .3044183    -0.06   0.952     .5344399    1.802599
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .6756007   .3563516    -0.74   0.457     .2402793    1.899608
    Unknown  |   1.591763    1.63121     0.45   0.650      .213591    11.86244
             |
         imd |
          2  |   1.147056   .6246853     0.25   0.801     .3944766      3.3354
          3  |   .8778937   .5008518    -0.23   0.819     .2869581    2.685749
          4  |   1.360829   .6577138     0.64   0.524     .5277181    3.509174
          5  |   .8473831   .4905225    -0.29   0.775     .2724877    2.635195
          6  |   .8489416    .574669    -0.24   0.809     .2252574    3.199459
             |
     bmi_cat |
Underweight  |   2.873374    1.35707     2.23   0.025     1.138616    7.251157
 Overweight  |   1.778605   .7609097     1.35   0.178     .7689967    4.113716
      Obese  |   1.018576   .5089066     0.04   0.971     .3825703    2.711911
Morbidly ..  |   2.259824   1.807658     1.02   0.308     .4711825    10.83827
             |
     smoking |
Current s..  |   1.317866    .868681     0.42   0.675     .3620726    4.796749
  Ex-smoker  |   1.576378   1.256112     0.57   0.568     .3306694     7.51496
             |
severe_dis~e |      1.111   .4356029     0.27   0.788     .5151968    2.395823
covid_vacc~t |     1.0879   .4853756     0.19   0.850     .4537515    2.608312
 liver_trans |   1.18e-16   1.12e-16   -38.81   0.000     1.85e-17    7.53e-16
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_oca_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_oca_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.10243         0.74        1         0.3908
      age_tv      |      0.26226         5.03        1         0.0249
      male        |     -0.00084         0.00        1         0.9942
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.25177         4.32        1         0.0377
      2.eth_bin   |      0.11001         1.08        1         0.2987
      1b.imd      |            .            .        1             .
      2.imd       |      0.22074         2.90        1         0.0887
      3.imd       |     -0.26906         3.85        1         0.0497
      4.imd       |      0.26150         3.31        1         0.0688
      5.imd       |      0.10809         1.14        1         0.2859
      6.imd       |      0.19679         2.46        1         0.1167
      1.bmi_cat   |      0.02099         0.02        1         0.8767
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.14951         1.67        1         0.1969
      4.bmi_cat   |      0.14689         1.90        1         0.1678
      5.bmi_cat   |      0.07187         0.50        1         0.4812
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.32341        10.74        1         0.0011
      2.smoking   |      0.29284         9.53        1         0.0020
      severe_dis~e|      0.02290         0.06        1         0.8121
      covid_vacc~t|     -0.04519         0.15        1         0.6968
      liver_trans |     -0.10637         0.49        1         0.4833
      ------------+---------------------------------------------------
      global test |                     33.37       19         0.0218
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_oca_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_oca_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -165.91885
Iteration 1:   log pseudolikelihood = -157.91241
Iteration 2:   log pseudolikelihood = -157.23866
Iteration 3:   log pseudolikelihood = -157.21416
Iteration 4:   log pseudolikelihood = -157.20591
Iteration 5:   log pseudolikelihood = -157.20287
Iteration 6:   log pseudolikelihood = -157.20176
Iteration 7:   log pseudolikelihood = -157.20135
Iteration 8:   log pseudolikelihood =  -157.2012
Iteration 9:   log pseudolikelihood = -157.20114
Iteration 10:  log pseudolikelihood = -157.20112
Iteration 11:  log pseudolikelihood = -157.20111
Iteration 12:  log pseudolikelihood = -157.20111
Iteration 13:  log pseudolikelihood = -157.20111
Iteration 14:  log pseudolikelihood = -157.20111
Iteration 15:  log pseudolikelihood = -157.20111
Iteration 16:  log pseudolikelihood = -157.20111
Iteration 17:  log pseudolikelihood = -157.20111
Iteration 18:  log pseudolikelihood = -157.20111
Iteration 19:  log pseudolikelihood = -157.20111
Iteration 20:  log pseudolikelihood = -157.20111
Iteration 21:  log pseudolikelihood = -157.20111
Iteration 22:  log pseudolikelihood = -157.20111
Iteration 23:  log pseudolikelihood = -157.20111
Iteration 24:  log pseudolikelihood = -157.20111
Iteration 25:  log pseudolikelihood = -157.20111
Iteration 26:  log pseudolikelihood = -157.20111
Iteration 27:  log pseudolikelihood = -157.20111
Iteration 28:  log pseudolikelihood = -157.20111
Iteration 29:  log pseudolikelihood = -157.20111
Iteration 30:  log pseudolikelihood = -157.20111
Iteration 31:  log pseudolikelihood = -157.20111
Refining estimates:
Iteration 0:   log pseudolikelihood = -157.20111
Iteration 1:   log pseudolikelihood = -157.20111
Iteration 2:   log pseudolikelihood = -157.20111

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         755
No. of failures      =           87
Time at risk         =       326924
                                                Wald chi2(22)    =     2037.87
Log pseudolikelihood =   -157.20111             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5287105   .3919758    -0.86   0.390     .1236385    2.260905
      age_tv |   1.011996   .0072251     1.67   0.095     .9979335    1.026256
        male |   1.031796   .3427736     0.09   0.925      .538041    1.978664
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .2860266   .2231933    -1.60   0.109     .0619717    1.320137
      Asian  |   .7066379   .4038705    -0.61   0.543     .2305169    2.166163
      Black  |   .7807422   .4857832    -0.40   0.691     .2306132    2.643207
      Other  |   .9726504   .5746083    -0.05   0.963     .3055598    3.096116
    Unknown  |   1.425392   1.505703     0.34   0.737     .1797934    11.30043
             |
         imd |
          2  |   1.437934   .8276202     0.63   0.528     .4653929    4.442815
          3  |   1.038168    .594231     0.07   0.948     .3381062    3.187733
          4  |    1.64344   .7958008     1.03   0.305     .6361766    4.245512
          5  |   1.072276   .6036993     0.12   0.901     .3556919    3.232506
          6  |    1.02193   .6685938     0.03   0.974     .2834822    3.683973
             |
     bmi_cat |
Underweight  |   2.748438   1.290992     2.15   0.031     1.094613    6.900986
 Overweight  |   1.941126   .8603253     1.50   0.135     .8143162    4.627157
      Obese  |   1.017638   .5179783     0.03   0.973      .375259    2.759659
Morbidly ..  |   2.257065   1.800273     1.02   0.307     .4727281    10.77647
             |
     smoking |
Current s..  |    1.20426   .7985851     0.28   0.779     .3282916     4.41754
  Ex-smoker  |   1.385106   1.121688     0.40   0.687     .2832446    6.773362
             |
severe_dis~e |   1.238724   .4987788     0.53   0.595      .562644     2.72719
covid_vacc~t |   1.204004   .5269876     0.42   0.671     .5105758    2.839196
 liver_trans |   1.90e-15   1.78e-15   -36.30   0.000     3.05e-16    1.19e-14
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,002       66.71       66.71
          1 |        500       33.29      100.00
------------+-----------------------------------
      Total |      1,502      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  77
no udca events = 77
(1002 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        450      293386           0     293386     293386
9779.5333
787.35863

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        450       90.00       90.00
          1 |         50       10.00      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 10

Contains data from ./output/an_dataset_hosp_any.dta
  obs:         2,933                          
 vars:            21                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1,470 observations deleted)

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,463  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,463  observations remaining, representing
        500  subjects
         26  failures in single-failure-per-subject data
    317,369  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  26

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_oca_hosp_any.svg not found)
(file ./output/graphs/km_oca_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -48.365786
Iteration 1:   log pseudolikelihood = -48.348044
Iteration 2:   log pseudolikelihood = -48.347952
Iteration 3:   log pseudolikelihood = -48.347952
Refining estimates:
Iteration 0:   log pseudolikelihood = -48.347952

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         739
No. of failures      =           26
Time at risk         =       317369
                                                Wald chi2(1)     =        0.03
Log pseudolikelihood =   -48.347952             Prob > chi2      =      0.8532

                           (Std. Err. adjusted for 255 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8249698   .8578155    -0.19   0.853     .1074846    6.331837
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_oca_hosp_any.dta not found)
file ./output/tempdata/surv_crude_oca_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.32582         1.21        1         0.2721
      ------------+---------------------------------------------------
      global test |                      1.21        1         0.2721
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -48.304826
Iteration 1:   log pseudolikelihood = -44.006778
Iteration 2:   log pseudolikelihood = -43.970772
Iteration 3:   log pseudolikelihood = -43.970728
Refining estimates:
Iteration 0:   log pseudolikelihood = -43.970728

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         735
No. of failures      =           26
Time at risk         =       315299
                                                Wald chi2(3)     =        8.00
Log pseudolikelihood =   -43.970728             Prob > chi2      =      0.0460

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.459923   1.553059     0.36   0.722      .181479    11.74448
      age_tv |   1.029842   .0139049     2.18   0.029     1.002947    1.057459
        male |    3.65015   2.517851     1.88   0.061     .9444022    14.10796
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_oca_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_oca_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.12573         0.25        1         0.6163
      age_tv      |      0.10770         0.18        1         0.6750
      male        |     -0.06092         0.06        1         0.8113
      ------------+---------------------------------------------------
      global test |                      0.82        3         0.8449
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -48.304826
Iteration 1:   log pseudolikelihood = -38.292324
Iteration 2:   log pseudolikelihood =  -37.10314
Iteration 3:   log pseudolikelihood = -32.049873
Iteration 4:   log pseudolikelihood = -30.761343
Iteration 5:   log pseudolikelihood = -30.631387
Iteration 6:   log pseudolikelihood = -30.605968
Iteration 7:   log pseudolikelihood = -30.596875
Iteration 8:   log pseudolikelihood = -30.593546
Iteration 9:   log pseudolikelihood = -30.592324
Iteration 10:  log pseudolikelihood = -30.591874
Iteration 11:  log pseudolikelihood = -30.591709
Iteration 12:  log pseudolikelihood = -30.591648
Iteration 13:  log pseudolikelihood = -30.591626
Iteration 14:  log pseudolikelihood = -30.591618
Iteration 15:  log pseudolikelihood = -30.591615
Iteration 16:  log pseudolikelihood = -30.591613
Iteration 17:  log pseudolikelihood = -30.591613
Iteration 18:  log pseudolikelihood = -30.591613
Iteration 19:  log pseudolikelihood = -30.591613
Iteration 20:  log pseudolikelihood = -30.591613
Iteration 21:  log pseudolikelihood = -30.591613
Iteration 22:  log pseudolikelihood = -30.591613
Iteration 23:  log pseudolikelihood = -30.591613
Iteration 24:  log pseudolikelihood = -30.591613
Iteration 25:  log pseudolikelihood = -30.591613
Iteration 26:  log pseudolikelihood = -30.591613
Iteration 27:  log pseudolikelihood = -30.591613
Iteration 28:  log pseudolikelihood = -30.591613
Iteration 29:  log pseudolikelihood = -30.591613
Iteration 30:  log pseudolikelihood = -30.591613
Iteration 31:  log pseudolikelihood = -30.591613
Iteration 32:  log pseudolikelihood = -30.591613
Iteration 33:  log pseudolikelihood = -30.591613
Iteration 34:  log pseudolikelihood = -30.591613
Iteration 35:  log pseudolikelihood = -30.591613
Refining estimates:
Iteration 0:   log pseudolikelihood = -30.591613
Iteration 1:   log pseudolikelihood = -30.591613
Iteration 2:   log pseudolikelihood = -30.591613

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         735
No. of failures      =           26
Time at risk         =       315299
                                                Wald chi2(18)    =     6708.78
Log pseudolikelihood =   -30.591613             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   3.665369   6.325705     0.75   0.452     .1244835    107.9254
      age_tv |   1.048864   .0291073     1.72   0.086     .9933388    1.107494
        male |   5.503986   6.856828     1.37   0.171     .4789125    63.25552
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .2231396   .2795834    -1.20   0.231     .0191453    2.600711
    Unknown  |    6.66549   7.513674     1.68   0.092     .7316697    60.72242
             |
         imd |
          2  |   .0946876   .1239618    -1.80   0.072     .0072766    1.232133
          3  |   1.123192   1.271398     0.10   0.918     .1221619    10.32696
          4  |   .6613483   1.047401    -0.26   0.794     .0296724    14.74036
          5  |   .0791478   .1240266    -1.62   0.106     .0036693    1.707233
          6  |   1.365761   1.635251     0.26   0.795     .1306819    14.27362
             |
     bmi_cat |
Underweight  |   1.56e-17   1.09e-17   -55.02   0.000     3.92e-18    6.17e-17
 Overweight  |   .5730112   .4525466    -0.71   0.481     .1218738    2.694113
      Obese  |   .1024959   .1026903    -2.27   0.023     .0143843    .7303357
Morbidly ..  |   2.03e-16   2.68e-16   -27.31   0.000     1.52e-17    2.71e-15
             |
     smoking |
Current s..  |   .2226768   .1983726    -1.69   0.092     .0388489    1.276355
  Ex-smoker  |   .3495624   .5281572    -0.70   0.487     .0180899    6.754813
             |
severe_dis~e |   .2369004    .286344    -1.19   0.233     .0221671    2.531756
covid_vacc~t |   8.368253    10.5129     1.69   0.091     .7133196     98.1715
 liver_trans |   1.41e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_oca_hosp_any.dta not found)
file ./output/tempdata/surv_adj_oca_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.41370        20.02        1         0.0000
      age_tv      |      0.16941         2.90        1         0.0888
      male        |      0.33135        12.47        1         0.0004
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.33277         9.17        1         0.0025
      2.eth_bin   |     -0.19092         1.60        1         0.2056
      1b.imd      |            .            .        1             .
      2.imd       |     -0.44961        15.36        1         0.0001
      3.imd       |     -0.42998        10.95        1         0.0009
      4.imd       |     -0.54095        26.43        1         0.0000
      5.imd       |     -0.41258        18.29        1         0.0000
      6.imd       |     -0.37503        10.12        1         0.0015
      1.bmi_cat   |      0.06233         0.07        1         0.7873
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.10932         0.52        1         0.4713
      4.bmi_cat   |     -0.42271         8.77        1         0.0031
      5.bmi_cat   |      0.08798         0.19        1         0.6592
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.44947        19.08        1         0.0000
      2.smoking   |     -0.29877         8.33        1         0.0039
      severe_dis~e|     -0.19654         4.53        1         0.0333
      covid_vacc~t|      0.17201         2.42        1         0.1198
      liver_trans |            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     35.07       18         0.0093
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_oca_hosp_any.svg not found)
(file ./output/graphs/schoenplot_oca_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -48.304826
Iteration 1:   log pseudolikelihood = -36.837916
Iteration 2:   log pseudolikelihood = -33.724908
Iteration 3:   log pseudolikelihood = -27.811644
Iteration 4:   log pseudolikelihood = -26.041218
Iteration 5:   log pseudolikelihood = -25.575172
Iteration 6:   log pseudolikelihood = -25.537066
Iteration 7:   log pseudolikelihood = -25.526763
Iteration 8:   log pseudolikelihood = -25.522996
Iteration 9:   log pseudolikelihood = -25.521612
Iteration 10:  log pseudolikelihood = -25.521104
Iteration 11:  log pseudolikelihood = -25.520917
Iteration 12:  log pseudolikelihood = -25.520848
Iteration 13:  log pseudolikelihood = -25.520822
Iteration 14:  log pseudolikelihood = -25.520813
Iteration 15:  log pseudolikelihood =  -25.52081
Iteration 16:  log pseudolikelihood = -25.520808
Iteration 17:  log pseudolikelihood = -25.520808
Iteration 18:  log pseudolikelihood = -25.520808
Iteration 19:  log pseudolikelihood = -25.520808
Iteration 20:  log pseudolikelihood = -25.520808
Iteration 21:  log pseudolikelihood = -25.520808
Iteration 22:  log pseudolikelihood = -25.520808
Iteration 23:  log pseudolikelihood = -25.520808
Iteration 24:  log pseudolikelihood = -25.520808
Iteration 25:  log pseudolikelihood = -25.520808
Iteration 26:  log pseudolikelihood = -25.520808
Iteration 27:  log pseudolikelihood = -25.520808
Iteration 28:  log pseudolikelihood = -25.520808
Iteration 29:  log pseudolikelihood = -25.520808
Iteration 30:  log pseudolikelihood = -25.520808
Iteration 31:  log pseudolikelihood = -25.520808
Iteration 32:  log pseudolikelihood = -25.520808
Iteration 33:  log pseudolikelihood = -25.520808
Iteration 34:  log pseudolikelihood = -25.520808
Iteration 35:  log pseudolikelihood = -25.520808
Iteration 36:  log pseudolikelihood = -25.520808
Iteration 37:  log pseudolikelihood = -25.520808
Iteration 38:  log pseudolikelihood = -25.520808
Iteration 39:  log pseudolikelihood = -25.520808
Iteration 40:  log pseudolikelihood = -25.520808
Iteration 41:  log pseudolikelihood = -25.520808
Iteration 42:  log pseudolikelihood = -25.520808
Iteration 43:  log pseudolikelihood = -25.520808
Iteration 44:  log pseudolikelihood = -25.520808
Iteration 45:  log pseudolikelihood = -25.520808
Iteration 46:  log pseudolikelihood = -25.520808
Refining estimates:
Iteration 0:   log pseudolikelihood = -25.520808

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         735
No. of failures      =           26
Time at risk         =       315299
                                                Wald chi2(18)    =       72.41
Log pseudolikelihood =   -25.520808             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   7.694461   12.67263     1.24   0.215      .304976    194.1292
      age_tv |   1.074893   .0387887     2.00   0.045     1.001495    1.153671
        male |   13.25208   18.76479     1.82   0.068      .826024     212.606
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .6605536   1.470421    -0.19   0.852     .0084158    51.84652
      Asian  |   .1577944   .2826783    -1.03   0.303     .0047122    5.284004
      Black  |   .0142446   .0447629    -1.35   0.176     .0000301    6.737477
      Other  |   8.05e-22          .        .       .            .           .
    Unknown  |   11.16585   15.52248     1.74   0.083     .7321041    170.2984
             |
         imd |
          2  |   .0359167   .0598174    -2.00   0.046      .001373    .9395686
          3  |   2.752346   2.565043     1.09   0.277     .4430241    17.09931
          4  |   .7868843   1.300706    -0.14   0.885      .030824     20.0878
          5  |   .0194684   .0332393    -2.31   0.021     .0006855    .5528787
          6  |   1.274108   1.987032     0.16   0.877       .05994    27.08292
             |
     bmi_cat |
Underweight  |   9.51e-20          .        .       .            .           .
 Overweight  |   .4633772   .4014879    -0.89   0.375     .0848049    2.531912
      Obese  |   .0589647   .0533053    -3.13   0.002     .0100251    .3468134
Morbidly ..  |   3.38e-21          .        .       .            .           .
             |
     smoking |
Current s..  |   .2380442   .2640989    -1.29   0.196     .0270576    2.094238
  Ex-smoker  |   1.162544   1.584243     0.11   0.912      .080435     16.8025
             |
severe_dis~e |   .1585599   .1913081    -1.53   0.127     .0149001    1.687322
covid_vacc~t |   8.872883   13.17177     1.47   0.141     .4835693    162.8061
 liver_trans |   6.55e-19          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        963       65.82       65.82
          1 |        500       34.18      100.00
------------+-----------------------------------
      Total |      1,463      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  23
no udca events = 23
(963 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        450      282474           0     282474     282474
9415.8
244.27027

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        450       90.00       90.00
          1 |         50       10.00      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = .

Contains data from ./output/an_dataset_composite_any.dta
  obs:         2,933                          
 vars:            20                          25 Sep 2023 12:27
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1,470 observations deleted)

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,463  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,463  observations remaining, representing
        500  subjects
        108  failures in single-failure-per-subject data
    317,369  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     1,035
  108

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_oca_composite_any.svg not found)
(file ./output/graphs/km_oca_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -205.14359
Iteration 1:   log pseudolikelihood = -204.48814
Iteration 2:   log pseudolikelihood = -204.45991
Iteration 3:   log pseudolikelihood = -204.45982
Refining estimates:
Iteration 0:   log pseudolikelihood = -204.45982

Stratified Cox regr. -- no ties

No. of subjects      =          500             Number of obs    =         739
No. of failures      =          108
Time at risk         =       317369
                                                Wald chi2(1)     =        1.29
Log pseudolikelihood =   -204.45982             Prob > chi2      =      0.2559

                           (Std. Err. adjusted for 255 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |    .530362   .2960811    -1.14   0.256     .1775737     1.58404
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_oca_composite_any.dta not found)
file ./output/tempdata/surv_crude_oca_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.20286         1.78        1         0.1819
      ------------+---------------------------------------------------
      global test |                      1.78        1         0.1819
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -204.73718
Iteration 1:   log pseudolikelihood =  -201.9644
Iteration 2:   log pseudolikelihood = -201.93825
Iteration 3:   log pseudolikelihood = -201.93818
Refining estimates:
Iteration 0:   log pseudolikelihood = -201.93818

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         735
No. of failures      =          108
Time at risk         =       315299
                                                Wald chi2(3)     =        5.51
Log pseudolikelihood =   -201.93818             Prob > chi2      =      0.1381

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5774747   .3202834    -0.99   0.322     .1947301    1.712509
      age_tv |   1.011604   .0059115     1.97   0.048     1.000083    1.023256
        male |   1.193252   .3314122     0.64   0.525      .692342    2.056571
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_oca_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_oca_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.18821         1.54        1         0.2150
      age_tv      |      0.08919         0.40        1         0.5291
      male        |     -0.15213         1.16        1         0.2817
      ------------+---------------------------------------------------
      global test |                      3.23        3         0.3575
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -204.73718
Iteration 1:   log pseudolikelihood = -197.27742
Iteration 2:   log pseudolikelihood = -195.98612
Iteration 3:   log pseudolikelihood = -195.91202
Iteration 4:   log pseudolikelihood = -195.89951
Iteration 5:   log pseudolikelihood = -195.89496
Iteration 6:   log pseudolikelihood = -195.89329
Iteration 7:   log pseudolikelihood = -195.89268
Iteration 8:   log pseudolikelihood = -195.89245
Iteration 9:   log pseudolikelihood = -195.89237
Iteration 10:  log pseudolikelihood = -195.89234
Iteration 11:  log pseudolikelihood = -195.89232
Iteration 12:  log pseudolikelihood = -195.89232
Iteration 13:  log pseudolikelihood = -195.89232
Iteration 14:  log pseudolikelihood = -195.89232
Iteration 15:  log pseudolikelihood = -195.89232
Iteration 16:  log pseudolikelihood = -195.89232
Iteration 17:  log pseudolikelihood = -195.89232
Iteration 18:  log pseudolikelihood = -195.89232
Iteration 19:  log pseudolikelihood = -195.89232
Iteration 20:  log pseudolikelihood = -195.89232
Iteration 21:  log pseudolikelihood = -195.89232
Iteration 22:  log pseudolikelihood = -195.89232
Iteration 23:  log pseudolikelihood = -195.89232
Iteration 24:  log pseudolikelihood = -195.89232
Iteration 25:  log pseudolikelihood = -195.89232
Iteration 26:  log pseudolikelihood = -195.89232
Iteration 27:  log pseudolikelihood = -195.89232
Iteration 28:  log pseudolikelihood = -195.89232
Iteration 29:  log pseudolikelihood = -195.89232
Iteration 30:  log pseudolikelihood = -195.89232
Iteration 31:  log pseudolikelihood = -195.89232
Iteration 32:  log pseudolikelihood = -195.89232
Refining estimates:
Iteration 0:   log pseudolikelihood = -195.89232
Iteration 1:   log pseudolikelihood = -195.89232

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         735
No. of failures      =          108
Time at risk         =       315299
                                                Wald chi2(19)    =     2183.04
Log pseudolikelihood =   -195.89232             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5886519    .360063    -0.87   0.386      .177501    1.952164
      age_tv |   1.012992   .0065285     2.00   0.045     1.000277    1.025869
        male |   1.119598   .3240934     0.39   0.696     .6348369    1.974522
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .6053563   .2697349    -1.13   0.260      .252774    1.449739
    Unknown  |   2.520019   1.845399     1.26   0.207     .5998915    10.58608
             |
         imd |
          2  |   .8456914   .4299334    -0.33   0.742     .3122319    2.290586
          3  |   1.041241   .5197984     0.08   0.935     .3914018    2.770001
          4  |   1.345858   .6336191     0.63   0.528     .5348853    3.386399
          5  |     .68325    .378864    -0.69   0.492      .230455    2.025691
          6  |   1.126512   .6885394     0.19   0.845     .3399928    3.732516
             |
     bmi_cat |
Underweight  |   1.720348   .7717564     1.21   0.227     .7141072    4.144474
 Overweight  |   1.254992   .4809016     0.59   0.553        .5922    2.659584
      Obese  |   .6523425   .2862534    -0.97   0.330     .2760332    1.541665
Morbidly ..  |   1.153695   .8843985     0.19   0.852     .2567898    5.183276
             |
     smoking |
Current s..  |   .7732404   .3656084    -0.54   0.587     .3060865    1.953372
  Ex-smoker  |   1.095614   .6618518     0.15   0.880     .3353155    3.579824
             |
severe_dis~e |   .8238793   .2880626    -0.55   0.580     .4151911    1.634855
covid_vacc~t |    1.11932   .5329726     0.24   0.813     .4401983    2.846166
 liver_trans |   2.01e-15   1.67e-15   -40.82   0.000     3.96e-16    1.02e-14
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_oca_composite_any.dta not found)
file ./output/tempdata/surv_adj_oca_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.12300         1.32        1         0.2501
      age_tv      |      0.02276         0.05        1         0.8305
      male        |     -0.12734         1.44        1         0.2303
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |      0.12721         1.47        1         0.2251
      2.eth_bin   |      0.04209         0.17        1         0.6779
      1b.imd      |            .            .        1             .
      2.imd       |      0.17851         2.12        1         0.1453
      3.imd       |     -0.28662         4.31        1         0.0379
      4.imd       |      0.15206         1.46        1         0.2266
      5.imd       |      0.09829         1.21        1         0.2722
      6.imd       |      0.02611         0.06        1         0.8118
      1.bmi_cat   |      0.10845         0.65        1         0.4204
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.16060         1.67        1         0.1967
      4.bmi_cat   |      0.15310         2.48        1         0.1156
      5.bmi_cat   |      0.03991         0.16        1         0.6887
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.02578         0.07        1         0.7880
      2.smoking   |      0.05012         0.22        1         0.6407
      severe_dis~e|      0.03524         0.18        1         0.6708
      covid_vacc~t|     -0.11948         1.73        1         0.1878
      liver_trans |      0.01096         0.00        1         0.9527
      ------------+---------------------------------------------------
      global test |                     22.90       19         0.2419
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_oca_composite_any.svg not found)
(file ./output/graphs/schoenplot_oca_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -204.73718
Iteration 1:   log pseudolikelihood =   -196.674
Iteration 2:   log pseudolikelihood = -195.35114
Iteration 3:   log pseudolikelihood =  -195.2782
Iteration 4:   log pseudolikelihood = -195.26641
Iteration 5:   log pseudolikelihood = -195.26213
Iteration 6:   log pseudolikelihood = -195.26056
Iteration 7:   log pseudolikelihood = -195.25998
Iteration 8:   log pseudolikelihood = -195.25976
Iteration 9:   log pseudolikelihood = -195.25968
Iteration 10:  log pseudolikelihood = -195.25966
Iteration 11:  log pseudolikelihood = -195.25964
Iteration 12:  log pseudolikelihood = -195.25964
Iteration 13:  log pseudolikelihood = -195.25964
Iteration 14:  log pseudolikelihood = -195.25964
Iteration 15:  log pseudolikelihood = -195.25964
Iteration 16:  log pseudolikelihood = -195.25964
Iteration 17:  log pseudolikelihood = -195.25964
Iteration 18:  log pseudolikelihood = -195.25964
Iteration 19:  log pseudolikelihood = -195.25964
Iteration 20:  log pseudolikelihood = -195.25964
Iteration 21:  log pseudolikelihood = -195.25964
Iteration 22:  log pseudolikelihood = -195.25964
Iteration 23:  log pseudolikelihood = -195.25964
Iteration 24:  log pseudolikelihood = -195.25964
Iteration 25:  log pseudolikelihood = -195.25964
Iteration 26:  log pseudolikelihood = -195.25964
Iteration 27:  log pseudolikelihood = -195.25964
Iteration 28:  log pseudolikelihood = -195.25964
Iteration 29:  log pseudolikelihood = -195.25964
Iteration 30:  log pseudolikelihood = -195.25964
Iteration 31:  log pseudolikelihood = -195.25964
Iteration 32:  log pseudolikelihood = -195.25964
Iteration 33:  log pseudolikelihood = -195.25964
Refining estimates:
Iteration 0:   log pseudolikelihood = -195.25964
Iteration 1:   log pseudolikelihood = -195.25964

Stratified Cox regr. -- no ties

No. of subjects      =          498             Number of obs    =         735
No. of failures      =          108
Time at risk         =       315299
                                                Wald chi2(22)    =     2335.78
Log pseudolikelihood =   -195.25964             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 254 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .5898613   .3749489    -0.83   0.406     .1696987    2.050318
      age_tv |   1.012708   .0065552     1.95   0.051     .9999416    1.025638
        male |   1.123753   .3362552     0.39   0.697     .6251294    2.020095
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .4218867   .2629733    -1.38   0.166     .1243424    1.431438
      Asian  |   .6266161   .3113512    -0.94   0.347     .2366241    1.659373
      Black  |   .7024683   .3822158    -0.65   0.516     .2418158    2.040652
      Other  |   .7065355   .3618044    -0.68   0.498     .2589695    1.927611
    Unknown  |   2.434791   1.824219     1.19   0.235     .5606809    10.57323
             |
         imd |
          2  |   .9364344   .5126733    -0.12   0.905     .3202336    2.738343
          3  |   1.105903    .560414     0.20   0.843     .4096116    2.985806
          4  |   1.457934    .679911     0.81   0.419     .5844909    3.636619
          5  |   .7518402   .4128829    -0.52   0.603     .2562578     2.20584
          6  |   1.229953   .7640451     0.33   0.739     .3640182    4.155792
             |
     bmi_cat |
Underweight  |   1.655882   .7601491     1.10   0.272     .6734061    4.071757
 Overweight  |   1.312206    .528862     0.67   0.500       .59558    2.891107
      Obese  |   .6514724   .2884999    -0.97   0.333     .2734938    1.551831
Morbidly ..  |   1.164541   .8865287     0.20   0.841     .2619158    5.177832
             |
     smoking |
Current s..  |   .7367955   .3484158    -0.65   0.518     .2916291      1.8615
  Ex-smoker  |   1.024651   .6282522     0.04   0.968      .308086    3.407845
             |
severe_dis~e |   .8661641   .3094211    -0.40   0.688     .4300552    1.744521
covid_vacc~t |   1.185887   .5726432     0.35   0.724     .4602706    3.055435
 liver_trans |   6.51e-16   5.41e-16   -42.11   0.000     1.28e-16    3.31e-15
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        963       65.82       65.82
          1 |        500       34.18      100.00
------------+-----------------------------------
      Total |      1,463      100.00

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        500      100.00      100.00
------------+-----------------------------------
      Total |        500      100.00
  500
  95
no udca events = 95
(963 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        450      282474           0     282474     282474
9415.8
1008.9424

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        450       90.00       90.00
          1 |         50       10.00      100.00
------------+-----------------------------------
      Total |        500      100.00
udca events = 13

. 
. * sensitivity analysis - explore vaccinations  
. file write tablecontent _n ("vaccinations sensitivity analysis") _n 

. file write tablecontent ("Outcome") _tab ("Exposure status") _tab ("denominat
> or") _tab ("events") _tab ("total_person_wks") _tab ("Rate") _tab ("unadj_hr"
> ) _tab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci")  _tab ("p_adj_hr") _tab ("
> p_adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_a
> dj_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. * Cox models and Schoenfeld residual plots for each outcome
. foreach outcome in died_covid_any hosp_any composite_any {
  2.     use ./output/an_dataset_`outcome'_vacc, clear 
  3.     * Open file to write results
.     describe
  4.     gen index_date = date("01/03/2021", "DMY")
  5.         * Flag records where outcome or end_date prior to 1st March 2021
.     bys patient_id: egen end_date = max(stop) 
  6.     stset stop, fail(`outcome'_flag) id(patient_id) enter(index_date) orig
> in(index_date)
  7.     count if `outcome'_flag==1
  8.     if r(N) > 10 {
  9.         sts graph, by(udca) title("`outcome'") graphregion(fcolor(white)) 
> ylabel(.75(.1)1)
 10.         graph export ./output/graphs/km_vacc_`outcome'.svg, as(svg) replac
> e
 11.         * Cox model - crude
.         stcox udca, strata(stp) vce(robust)
 12.         estimates save "./output/tempdata/crude_`outcome'", replace 
 13.         eststo model7
 14.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_vacc_`outcome'", replace) idstr("crude_`outcome'") 
 15.         estat phtest, detail
 16.         * Plot schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("`outcome'", position(11) size(medsmall)) ///
>                     name(uni_plot_vacc_`outcome') ///
>                     note("")
 17.         * Cox model - age and sex adjusted
.         stcox udca age_tv male, strata(stp) vce(robust)
 18.         estimates save "./output/tempdata/p_adj_model_`outcome'", replace 
 19.         eststo model8
 20.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/p_surv_adj_vacc_`outcome'", replace) idstr("adj_`outcome'") 
 21.         estat phtest, detail
 22.         * Cox model - fully adjusted
.         stcox udca age_tv male any_high_risk_condition i.eth_bin i.imd ib2.bm
> i_cat i.smoking severe_disease i.vacc_count_tv liver_trans ib5.time_vacc_cat,
>  strata(stp) vce(robust)
 23.         estimates save "./output/tempdata/adj_model_`outcome'", replace 
 24.         eststo model9
 25.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_adj_vacc_`outcome'", replace) idstr("adj_`outcome'") 
 26.         estat phtest, detail
 27.         * Plot Schoenfeld residuals 
.         estat phtest, plot(udca) ///
>                     graphregion(fcolor(white)) ///
>                     ylabel(, nogrid labsize(small)) ///
>                     xlabel(, labsize(small)) ///
>                     xtitle("Time", size(small)) ///
>                     ytitle("Scaled Schoenfeld Residuals", size(small)) ///
>                     msize(small) ///
>                     mcolor(gs6) ///
>                     msymbol(circle_hollow) ///
>                     scheme(s1mono) ///
>                     title ("Adjusted `outcome'", position(11) size(medsmall))
>  ///
>                     name(adj_plot_vacc_`outcome') ///
>                     note("")
 28.         graph combine uni_plot_vacc_`outcome' adj_plot_vacc_`outcome'
 29.         graph export ./output/graphs/schoenplot_vacc_`outcome'.svg, as(svg
> ) replace 
 30.         * Cox model - fully adjusted with categorical ethnicity variable 
.         stcox udca age_tv male any_high_risk_condition i.ethnicity i.imd ib2.
> bmi_cat i.smoking severe_disease i.vacc_count_tv liver_trans ib5.time_vacc_ca
> t, strata(stp) vce(robust)
 31.         * flag single row for each person
.         bys patient_id (start): gen number = _n==_N 
 32.         tab number 
 33.         * Count number unexposed at any time 
.         bys patient_id : egen unexposed_ever = min(udca) 
 34.         tab unexposed_ever if number==1
 35.         safecount if unexposed_ever==0 & number==1
 36.         local denominator = r(N)
 37.         safecount if udca == 0 & `outcome'_flag == 1 
 38.         local event = r(N)
 39.         di "no udca events = " `event'
 40.         bysort udca: egen total_follow_up = total(_t) if number==1 
 41.         su total_follow_up if udca==0 & number==1 
 42.         local person_mth = r(mean)/30
 43.         di `person_mth'
 44.         local rate = 100000*(`event'/`person_mth')
 45.         di `rate'
 46.         if `event'>10 & `event'!=. {
 47.             file write tablecontent  ("`outcome'") _tab ("No UDCA") _tab (
> `denominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') 
> _tab
 48.             file write tablecontent ("1.00") _tab _tab ("1.00")  _n
 49.             }
 50.         else {
 51.             file write tablecontent ("`outcome'") _tab ("No UDCA") _tab ("
> redact") _n
 52.             continue
 53.         }
 54.         * Count number exposed at any time 
.         bys patient_id : egen exposed_ever = max(udca) 
 55.         tab exposed_ever if number==1
 56.         qui safecount if exposed_ever==1 & number==1
 57.         local denominator = r(N)
 58.         qui safecount if udca == 1 & `outcome'_flag == 1 
 59.         local event = r(N)
 60.         di "udca events = " `event'
 61.         qui su total_follow_up if udca==1 & number==1 
 62.         local person_mth = r(mean)/30
 63.         local rate = 100000*(`event'/`person_mth')
 64.         if `event'>10 & `event'!=. {
 65.             file write tablecontent ("`outcome'") _tab ("UDCA") _tab (`den
> ominator') _tab (`event') _tab %10.0f (`person_mth') _tab %3.2f (`rate') _tab
 66.             cap estimates use "./output/tempdata/crude_`outcome'" 
 67.             cap lincom udca, eform
 68.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 69.             cap estimates clear
 70.             cap estimates use "./output/tempdata/p_adj_model_`outcome'" 
 71.             cap lincom udca, eform
 72.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b 
 73.             cap estimates clear
 74.             cap estimates use "./output/tempdata/adj_model_`outcome'" 
 75.             cap lincom udca, eform
 76.             file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4.2f 
> (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub)) _ta
> b _n 
 77.             cap estimates clear
 78.         }
 79.         else {
 80.             file write tablecontent  ("`outcome'") _tab ("UDCA") _tab ("re
> dact") _n
 81.             continue
 82.         }
 83.     
. drop total_follow_up
 84.     }
 85. else { 
 86.     file write tablecontent ("`outcome'") _tab ("redact") _n
 87.     continue
 88. }
 89. 
. }

Contains data from ./output/an_dataset_died_covid_any_vacc.dta
  obs:         2,871                          
 vars:            21                          25 Sep 2023 12:29
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
died_covid_an~g byte    %8.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
vacc_count_tv   float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1 missing value generated)

                id:  patient_id
     failure event:  died_covid_any_flag != 0 & died_covid_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,871  total observations
          1  event time missing (stop>=.)                       PROBABLE ERROR
         10  multiple records at same instant                   PROBABLE ERROR
             (stop[_n-1]==stop)
------------------------------------------------------------------------------
      2,860  observations remaining, representing
        999  subjects
        106  failures in single-failure-per-subject data
    512,147  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       670
  106

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_vacc_died_covid_any.svg not found)
(file ./output/graphs/km_vacc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -269.13958
Iteration 1:   log pseudolikelihood = -269.13951
Iteration 2:   log pseudolikelihood = -269.13951
Refining estimates:
Iteration 0:   log pseudolikelihood = -269.13951

Stratified Cox regr. -- no ties

No. of subjects      =          999             Number of obs    =       1,438
No. of failures      =          106
Time at risk         =       512147
                                                Wald chi2(1)     =        0.00
Log pseudolikelihood =   -269.13951             Prob > chi2      =      0.9909

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9951793   .4207945    -0.01   0.991     .4344956    2.279383
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_died_covid_any.ster saved
(note: file ./output/tempdata/surv_crude_vacc_died_covid_any.dta not found)
file ./output/tempdata/surv_crude_vacc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.18012         1.69        1         0.1939
      ------------+---------------------------------------------------
      global test |                      1.69        1         0.1939
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -263.20986
Iteration 1:   log pseudolikelihood = -263.08564
Iteration 2:   log pseudolikelihood = -263.08564
Refining estimates:
Iteration 0:   log pseudolikelihood = -263.08564

Stratified Cox regr. -- no ties

No. of subjects      =          985             Number of obs    =       1,428
No. of failures      =          105
Time at risk         =       505221
                                                Wald chi2(3)     =        0.23
Log pseudolikelihood =   -263.08564             Prob > chi2      =      0.9734

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.013563   .4345183     0.03   0.975      .437459    2.348357
      age_tv |   .9971383   .0060641    -0.47   0.637     .9853233    1.009095
        male |   .9740528   .2687908    -0.10   0.924      .567143    1.672909
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/p_surv_adj_vacc_died_covid_any.dta not found)
file ./output/tempdata/p_surv_adj_vacc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17201         1.63        1         0.2014
      age_tv      |      0.10354         0.72        1         0.3971
      male        |      0.05649         0.19        1         0.6636
      ------------+---------------------------------------------------
      global test |                      2.34        3         0.5048
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -263.20986
Iteration 1:   log pseudolikelihood = -253.33324
Iteration 2:   log pseudolikelihood = -249.94647
Iteration 3:   log pseudolikelihood =  -249.5558
Iteration 4:   log pseudolikelihood =  -249.4701
Iteration 5:   log pseudolikelihood = -249.43967
Iteration 6:   log pseudolikelihood = -249.42849
Iteration 7:   log pseudolikelihood = -249.42438
Iteration 8:   log pseudolikelihood = -249.42287
Iteration 9:   log pseudolikelihood = -249.42231
Iteration 10:  log pseudolikelihood =  -249.4221
Iteration 11:  log pseudolikelihood = -249.42203
Iteration 12:  log pseudolikelihood =   -249.422
Iteration 13:  log pseudolikelihood = -249.42199
Iteration 14:  log pseudolikelihood = -249.42199
Iteration 15:  log pseudolikelihood = -249.42199
Iteration 16:  log pseudolikelihood = -249.42199
Iteration 17:  log pseudolikelihood = -249.42198
Iteration 18:  log pseudolikelihood = -249.42198
Iteration 19:  log pseudolikelihood = -249.42198
Iteration 20:  log pseudolikelihood = -249.42198
Iteration 21:  log pseudolikelihood = -249.42198
Iteration 22:  log pseudolikelihood = -249.42198
Iteration 23:  log pseudolikelihood = -249.42198
Iteration 24:  log pseudolikelihood = -249.42198
Iteration 25:  log pseudolikelihood = -249.42198
Iteration 26:  log pseudolikelihood = -249.42198
Iteration 27:  log pseudolikelihood = -249.42198
Iteration 28:  log pseudolikelihood = -249.42198
Iteration 29:  log pseudolikelihood = -249.42198
Iteration 30:  log pseudolikelihood = -249.42198
Iteration 31:  log pseudolikelihood = -249.42198
Iteration 32:  log pseudolikelihood = -249.42198
Iteration 33:  log pseudolikelihood = -249.42198
Refining estimates:
Iteration 0:   log pseudolikelihood = -249.42198
Iteration 1:   log pseudolikelihood = -249.42198
Iteration 2:   log pseudolikelihood = -249.42198

Stratified Cox regr. -- no ties

No. of subjects      =          985             Number of obs    =       1,428
No. of failures      =          105
Time at risk         =       505221
                                                Wald chi2(27)    =    16120.44
Log pseudolikelihood =   -249.42198             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9354544   .4046155    -0.15   0.877     .4007277    2.183715
      age_tv |   .9973066   .0067126    -0.40   0.689     .9842366     1.01055
        male |   .9843896    .289474    -0.05   0.957     .5531704    1.751762
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.333501   .6221675     0.62   0.537     .5343804    3.327636
    Unknown  |   1.222926   .9444413     0.26   0.794     .2691749    5.556049
             |
         imd |
          2  |   .3469212   .1875959    -1.96   0.050      .120212    1.001184
          3  |   .8063223   .3163232    -0.55   0.583     .3737482    1.739555
          4  |   .6662643   .2759128    -0.98   0.327     .2959019    1.500187
          5  |   .3993691   .2011312    -1.82   0.068     .1488299    1.071664
          6  |    .694772   .5098847    -0.50   0.620     .1648754    2.927714
             |
     bmi_cat |
Underweight  |   .9344127   .5372385    -0.12   0.906     .3027905    2.883601
 Overweight  |   1.133147   .4473227     0.32   0.752     .5227149    2.456449
      Obese  |   1.279335   .4387041     0.72   0.473     .6532721    2.505386
Morbidly ..  |   2.611579   1.335144     1.88   0.060     .9588149    7.113309
             |
     smoking |
Current s..  |   1.654592   1.068683     0.78   0.436     .4665619    5.867766
  Ex-smoker  |   .5896041   .4965023    -0.63   0.530     .1131797    3.071514
             |
severe_dis~e |   .9719323    .272529    -0.10   0.919     .5609961    1.683884
             |
vacc_count~v |
          1  |   .8108678   .3633143    -0.47   0.640     .3369489    1.951354
          2  |   .5607561     .26281    -1.23   0.217     .2237901      1.4051
          3  |   3.292163   2.547542     1.54   0.124     .7224442    15.00232
          4  |   4.61e-16   2.89e-16   -56.48   0.000     1.35e-16    1.57e-15
          5  |   6.89e-16   6.13e-16   -39.22   0.000     1.20e-16    3.94e-15
             |
 liver_trans |   3.89e-16   2.57e-16   -53.55   0.000     1.06e-16    1.42e-15
             |
time_vacc_~t |
Q1 closes..  |   6.61e-16   4.59e-16   -50.36   0.000     1.70e-16    2.58e-15
         Q2  |   4.49e-16   2.61e-16   -60.80   0.000     1.44e-16    1.40e-15
         Q3  |    4.05628   3.432277     1.65   0.098     .7724532     21.3002
Q4 furthe..  |   4.399786   3.392402     1.92   0.055     .9707847    19.94069
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_died_covid_any.ster saved
(note: file ./output/tempdata/surv_adj_vacc_died_covid_any.dta not found)
file ./output/tempdata/surv_adj_vacc_died_covid_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17257         2.88        1         0.0899
      age_tv      |      0.06667         0.71        1         0.3985
      male        |      0.10641         1.04        1         0.3079
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.02485         0.09        1         0.7661
      2.eth_bin   |     -0.01012         0.01        1         0.9028
      1b.imd      |            .            .        1             .
      2.imd       |      0.02272         0.06        1         0.7991
      3.imd       |     -0.02975         0.08        1         0.7758
      4.imd       |     -0.02831         0.06        1         0.8080
      5.imd       |      0.01221         0.02        1         0.8925
      6.imd       |     -0.09552         1.36        1         0.2443
      1.bmi_cat   |     -0.09652         1.03        1         0.3113
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.06285         0.55        1         0.4582
      4.bmi_cat   |     -0.03499         0.16        1         0.6931
      5.bmi_cat   |      0.01631         0.03        1         0.8711
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.16925         3.29        1         0.0699
      2.smoking   |      0.09756         1.18        1         0.2780
      severe_dis~e|      0.17349         2.98        1         0.0841
      0b.vacc_co~v|            .            .        1             .
      1.vacc_cou~v|     -0.07479         0.66        1         0.4161
      2.vacc_cou~v|     -0.02630         0.08        1         0.7786
      3.vacc_cou~v|     -0.08850         0.60        1         0.4391
      4.vacc_cou~v|      0.00188         0.00        1         0.9933
      5.vacc_cou~v|      0.05230         0.06        1         0.8017
      liver_trans |      0.08726         0.09        1         0.7611
      1.time_vac~t|      0.11474         0.40        1         0.5263
      2.time_vac~t|      0.13667         0.60        1         0.4396
      3.time_vac~t|     -0.00301         0.00        1         0.9738
      4.time_vac~t|     -0.01857         0.03        1         0.8698
      5b.time_va~t|            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     14.20       27         0.9792
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_vacc_died_covid_any.svg not found)
(file ./output/graphs/schoenplot_vacc_died_covid_any.svg written in SVG format)

         failure _d:  died_covid_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -263.20986
Iteration 1:   log pseudolikelihood =  -249.6053
Iteration 2:   log pseudolikelihood = -245.83121
Iteration 3:   log pseudolikelihood = -245.44135
Iteration 4:   log pseudolikelihood =  -245.3612
Iteration 5:   log pseudolikelihood = -245.33292
Iteration 6:   log pseudolikelihood = -245.32253
Iteration 7:   log pseudolikelihood =  -245.3187
Iteration 8:   log pseudolikelihood =  -245.3173
Iteration 9:   log pseudolikelihood = -245.31678
Iteration 10:  log pseudolikelihood = -245.31659
Iteration 11:  log pseudolikelihood = -245.31652
Iteration 12:  log pseudolikelihood = -245.31649
Iteration 13:  log pseudolikelihood = -245.31648
Iteration 14:  log pseudolikelihood = -245.31648
Iteration 15:  log pseudolikelihood = -245.31648
Iteration 16:  log pseudolikelihood = -245.31648
Iteration 17:  log pseudolikelihood = -245.31648
Iteration 18:  log pseudolikelihood = -245.31648
Iteration 19:  log pseudolikelihood = -245.31648
Iteration 20:  log pseudolikelihood = -245.31648
Iteration 21:  log pseudolikelihood = -245.31648
Iteration 22:  log pseudolikelihood = -245.31648
Iteration 23:  log pseudolikelihood = -245.31648
Iteration 24:  log pseudolikelihood = -245.31648
Iteration 25:  log pseudolikelihood = -245.31648
Iteration 26:  log pseudolikelihood = -245.31648
Iteration 27:  log pseudolikelihood = -245.31648
Iteration 28:  log pseudolikelihood = -245.31648
Iteration 29:  log pseudolikelihood = -245.31648
Iteration 30:  log pseudolikelihood = -245.31648
Iteration 31:  log pseudolikelihood = -245.31648
Iteration 32:  log pseudolikelihood = -245.31648
Iteration 33:  log pseudolikelihood = -245.31648
Iteration 34:  log pseudolikelihood = -245.31648
Iteration 35:  log pseudolikelihood = -245.31648
Iteration 36:  log pseudolikelihood = -245.31648
Iteration 37:  log pseudolikelihood = -245.31648
Refining estimates:
Iteration 0:   log pseudolikelihood = -245.31648
Iteration 1:   log pseudolikelihood = -245.31648
Iteration 2:   log pseudolikelihood = -245.31648
Iteration 3:   log pseudolikelihood = -245.31648
Iteration 4:   log pseudolikelihood = -245.31648
Iteration 5:   log pseudolikelihood = -245.31648

Stratified Cox regr. -- no ties

No. of subjects      =          985             Number of obs    =       1,428
No. of failures      =          105
Time at risk         =       505221
                                                Wald chi2(29)    =    22815.61
Log pseudolikelihood =   -245.31648             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .9823514    .400746    -0.04   0.965     .4415938    2.185299
      age_tv |   .9977018   .0068798    -0.33   0.739     .9843084    1.011278
        male |   .9715541   .2889568    -0.10   0.923     .5423817    1.740319
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .5060858   .3398619    -1.01   0.311     .1357062    1.887333
      Asian  |   1.909197    .954948     1.29   0.196     .7162986    5.088706
      Black  |   1.694894   .8540729     1.05   0.295     .6312683    4.550624
      Other  |   1.114243   .6249232     0.19   0.847     .3711789    3.344847
    Unknown  |   1.242827   .9622272     0.28   0.779     .2725143    5.668026
             |
         imd |
          2  |   .3724071   .1984084    -1.85   0.064     .1310753    1.058071
          3  |   .8372448   .3200567    -0.46   0.642      .395786    1.771106
          4  |   .6564448   .2819098    -0.98   0.327     .2829113    1.523162
          5  |   .3821548   .1944792    -1.89   0.059     .1409489    1.036137
          6  |   .6693402   .5006787    -0.54   0.591     .1545014    2.899755
             |
     bmi_cat |
Underweight  |   .9984306   .5911742    -0.00   0.998     .3128373    3.186524
 Overweight  |   1.127488   .4487594     0.30   0.763     .5167962    2.459827
      Obese  |   1.263505   .4321649     0.68   0.494     .6463007    2.470125
Morbidly ..  |   2.370206   1.236194     1.65   0.098     .8527799    6.587719
             |
     smoking |
Current s..  |   1.585163   1.026025     0.71   0.477     .4457776    5.636758
  Ex-smoker  |   .5840035   .4981155    -0.63   0.528     .1097484    3.107655
             |
severe_dis~e |    .959165   .2771128    -0.14   0.885     .5444679    1.689718
             |
vacc_count~v |
          1  |   .8087379   .3629962    -0.47   0.636      .335546    1.949232
          2  |   .5736017   .2676019    -1.19   0.233     .2298794    1.431267
          3  |   3.334302   2.624936     1.53   0.126     .7126806    15.59966
          4  |   3.68e-19   2.40e-19   -65.14   0.000     1.03e-19    1.32e-18
          5  |   5.07e-19          .        .       .            .           .
             |
 liver_trans |   2.36e-19   1.58e-19   -64.17   0.000     6.38e-20    8.75e-19
             |
time_vacc_~t |
Q1 closes..  |   5.33e-19   3.73e-19   -60.08   0.000     1.35e-19    2.10e-18
         Q2  |   5.21e-19   2.81e-19   -78.11   0.000     1.81e-19    1.50e-18
         Q3  |   3.840745   3.253639     1.59   0.112     .7300133    20.20692
Q4 furthe..  |   4.808725   3.361845     2.25   0.025      1.22164    18.92852
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,871       65.17       65.17
          1 |      1,000       34.83      100.00
------------+-----------------------------------
      Total |      2,871      100.00
(1 missing value generated)

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        903       90.39       90.39
          1 |         96        9.61      100.00
------------+-----------------------------------
      Total |        999      100.00
  903
  97
no udca events = 97
(1871 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        903      458682           0     458682     458682
15289.4
634.42647
(1 missing value generated)

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        903       90.39       90.39
          1 |         96        9.61      100.00
------------+-----------------------------------
      Total |        999      100.00
udca events = 9

Contains data from ./output/an_dataset_hosp_any_vacc.dta
  obs:         2,838                          
 vars:            22                          25 Sep 2023 12:29
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
hosp_any_flag   float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
vacc_count_tv   float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
total_hosp      float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1 missing value generated)

                id:  patient_id
     failure event:  hosp_any_flag != 0 & hosp_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,838  total observations
          1  event time missing (stop>=.)                       PROBABLE ERROR
         10  multiple records at same instant                   PROBABLE ERROR
             (stop[_n-1]==stop)
------------------------------------------------------------------------------
      2,827  observations remaining, representing
        999  subjects
         32  failures in single-failure-per-subject data
    502,630  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       670
  32

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_vacc_hosp_any.svg not found)
(file ./output/graphs/km_vacc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -62.67074
Iteration 1:   log pseudolikelihood = -61.669896
Iteration 2:   log pseudolikelihood = -61.342097
Iteration 3:   log pseudolikelihood = -61.226004
Iteration 4:   log pseudolikelihood = -61.183867
Iteration 5:   log pseudolikelihood = -61.168441
Iteration 6:   log pseudolikelihood = -61.162776
Iteration 7:   log pseudolikelihood = -61.160694
Iteration 8:   log pseudolikelihood = -61.159928
Iteration 9:   log pseudolikelihood = -61.159646
Iteration 10:  log pseudolikelihood = -61.159542
Iteration 11:  log pseudolikelihood = -61.159504
Iteration 12:  log pseudolikelihood =  -61.15949
Iteration 13:  log pseudolikelihood = -61.159485
Iteration 14:  log pseudolikelihood = -61.159483
Iteration 15:  log pseudolikelihood = -61.159482
Iteration 16:  log pseudolikelihood = -61.159482
Iteration 17:  log pseudolikelihood = -61.159482
Iteration 18:  log pseudolikelihood = -61.159482
Iteration 19:  log pseudolikelihood = -61.159482
Iteration 20:  log pseudolikelihood = -61.159482
Iteration 21:  log pseudolikelihood = -61.159482
Iteration 22:  log pseudolikelihood = -61.159482
Iteration 23:  log pseudolikelihood = -61.159482
Iteration 24:  log pseudolikelihood = -61.159482
Iteration 25:  log pseudolikelihood = -61.159482
Iteration 26:  log pseudolikelihood = -61.159482
Iteration 27:  log pseudolikelihood = -61.159482
Iteration 28:  log pseudolikelihood = -61.159482
Iteration 29:  log pseudolikelihood = -61.159482
Iteration 30:  log pseudolikelihood = -61.159482
Iteration 31:  log pseudolikelihood = -61.159482
Iteration 32:  log pseudolikelihood = -61.159482
Iteration 33:  log pseudolikelihood = -61.159482
Iteration 34:  log pseudolikelihood = -61.159482
Iteration 35:  log pseudolikelihood = -61.159482
Refining estimates:
Iteration 0:   log pseudolikelihood = -61.159482
Iteration 1:   log pseudolikelihood = -61.159482

Stratified Cox regr. -- no ties

No. of subjects      =          999             Number of obs    =       1,423
No. of failures      =           32
Time at risk         =       502630
                                                Wald chi2(1)     =    12570.74
Log pseudolikelihood =   -61.159482             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   1.92e-16   6.20e-17  -112.12   0.000     1.02e-16    3.62e-16
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_hosp_any.ster saved
(note: file ./output/tempdata/surv_crude_vacc_hosp_any.dta not found)
file ./output/tempdata/surv_crude_vacc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |            .         0.00        1         1.0000
      ------------+---------------------------------------------------
      global test |                      0.00        1         1.0000
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -62.571335
Iteration 1:   log pseudolikelihood = -61.386746
Iteration 2:   log pseudolikelihood = -61.057088
Iteration 3:   log pseudolikelihood = -60.940379
Iteration 4:   log pseudolikelihood = -60.898023
Iteration 5:   log pseudolikelihood = -60.882517
Iteration 6:   log pseudolikelihood = -60.876823
Iteration 7:   log pseudolikelihood =  -60.87473
Iteration 8:   log pseudolikelihood =  -60.87396
Iteration 9:   log pseudolikelihood = -60.873677
Iteration 10:  log pseudolikelihood = -60.873573
Iteration 11:  log pseudolikelihood = -60.873535
Iteration 12:  log pseudolikelihood =  -60.87352
Iteration 13:  log pseudolikelihood = -60.873515
Iteration 14:  log pseudolikelihood = -60.873513
Iteration 15:  log pseudolikelihood = -60.873513
Iteration 16:  log pseudolikelihood = -60.873512
Iteration 17:  log pseudolikelihood = -60.873512
Iteration 18:  log pseudolikelihood = -60.873512
Iteration 19:  log pseudolikelihood = -60.873512
Iteration 20:  log pseudolikelihood = -60.873512
Iteration 21:  log pseudolikelihood = -60.873512
Iteration 22:  log pseudolikelihood = -60.873512
Iteration 23:  log pseudolikelihood = -60.873512
Iteration 24:  log pseudolikelihood = -60.873512
Iteration 25:  log pseudolikelihood = -60.873512
Iteration 26:  log pseudolikelihood = -60.873512
Iteration 27:  log pseudolikelihood = -60.873512
Iteration 28:  log pseudolikelihood = -60.873512
Iteration 29:  log pseudolikelihood = -60.873512
Iteration 30:  log pseudolikelihood = -60.873512
Iteration 31:  log pseudolikelihood = -60.873512
Iteration 32:  log pseudolikelihood = -60.873512
Iteration 33:  log pseudolikelihood = -60.873512
Iteration 34:  log pseudolikelihood = -60.873512
Iteration 35:  log pseudolikelihood = -60.873512
Iteration 36:  log pseudolikelihood = -60.873512
Iteration 37:  log pseudolikelihood = -60.873512
Iteration 38:  log pseudolikelihood = -60.873512
Iteration 39:  log pseudolikelihood = -60.873512
Iteration 40:  log pseudolikelihood = -60.873512
Iteration 41:  log pseudolikelihood = -60.873512
Refining estimates:
Iteration 0:   log pseudolikelihood = -60.873512
Iteration 1:   log pseudolikelihood = -60.873512

Stratified Cox regr. -- no ties

No. of subjects      =          985             Number of obs    =       1,413
No. of failures      =           32
Time at risk         =       495704
                                                Wald chi2(3)     =    16837.22
Log pseudolikelihood =   -60.873512             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   4.85e-19   1.68e-19  -121.71   0.000     2.46e-19    9.56e-19
      age_tv |   .9931263    .013046    -0.53   0.600     .9678829    1.019028
        male |   1.032946   .5939953     0.06   0.955     .3346529    3.188312
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_hosp_any.ster saved
(note: file ./output/tempdata/p_surv_adj_vacc_hosp_any.dta not found)
file ./output/tempdata/p_surv_adj_vacc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |     -0.01914         0.00        1         0.9794
      age_tv      |      0.21805         0.97        1         0.3256
      male        |      0.03654         0.02        1         0.8882
      ------------+---------------------------------------------------
      global test |                      0.98        3         0.8049
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -62.571335
Iteration 1:   log pseudolikelihood = -54.186798
Iteration 2:   log pseudolikelihood = -49.467674
Iteration 3:   log pseudolikelihood = -48.911977
Iteration 4:   log pseudolikelihood = -48.788743
Iteration 5:   log pseudolikelihood =  -48.74384
Iteration 6:   log pseudolikelihood =  -48.72728
Iteration 7:   log pseudolikelihood = -48.721176
Iteration 8:   log pseudolikelihood = -48.718929
Iteration 9:   log pseudolikelihood = -48.718102
Iteration 10:  log pseudolikelihood = -48.717797
Iteration 11:  log pseudolikelihood = -48.717685
Iteration 12:  log pseudolikelihood = -48.717644
Iteration 13:  log pseudolikelihood = -48.717629
Iteration 14:  log pseudolikelihood = -48.717623
Iteration 15:  log pseudolikelihood = -48.717621
Iteration 16:  log pseudolikelihood = -48.717621
Iteration 17:  log pseudolikelihood =  -48.71762
Iteration 18:  log pseudolikelihood =  -48.71762
Iteration 19:  log pseudolikelihood =  -48.71762
Iteration 20:  log pseudolikelihood =  -48.71762
Iteration 21:  log pseudolikelihood =  -48.71762
Iteration 22:  log pseudolikelihood =  -48.71762
Iteration 23:  log pseudolikelihood =  -48.71762
Iteration 24:  log pseudolikelihood =  -48.71762
Iteration 25:  log pseudolikelihood =  -48.71762
Iteration 26:  log pseudolikelihood =  -48.71762
Iteration 27:  log pseudolikelihood =  -48.71762
Iteration 28:  log pseudolikelihood =  -48.71762
Iteration 29:  log pseudolikelihood =  -48.71762
Iteration 30:  log pseudolikelihood =  -48.71762
Iteration 31:  log pseudolikelihood =  -48.71762
Iteration 32:  log pseudolikelihood =  -48.71762
Iteration 33:  log pseudolikelihood =  -48.71762
Iteration 34:  log pseudolikelihood =  -48.71762
Iteration 35:  log pseudolikelihood =  -48.71762
Iteration 36:  log pseudolikelihood =  -48.71762
Iteration 37:  log pseudolikelihood =  -48.71762
Iteration 38:  log pseudolikelihood =  -48.71762
Iteration 39:  log pseudolikelihood =  -48.71762
Iteration 40:  log pseudolikelihood =  -48.71762
Iteration 41:  log pseudolikelihood =  -48.71762
Iteration 42:  log pseudolikelihood =  -48.71762
Iteration 43:  log pseudolikelihood =  -48.71762
Iteration 44:  log pseudolikelihood =  -48.71762
Iteration 45:  log pseudolikelihood =  -48.71762
Refining estimates:
Iteration 0:   log pseudolikelihood =  -48.71762

Stratified Cox regr. -- no ties

No. of subjects      =          985             Number of obs    =       1,413
No. of failures      =           32
Time at risk         =       495704
                                                Wald chi2(18)    =       69.87
Log pseudolikelihood =    -48.71762             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   5.36e-20          .        .       .            .           .
      age_tv |   .9889099   .0143989    -0.77   0.444     .9610875    1.017538
        male |   .8965261   .6234945    -0.16   0.875     .2293981    3.503775
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   .5600043   .4583729    -0.71   0.479     .1125819     2.78557
    Unknown  |   1.105273   1.455965     0.08   0.939      .083597    14.61332
             |
         imd |
          2  |   .2534632   .3359405    -1.04   0.300     .0188682    3.404855
          3  |   1.145925   .9743911     0.16   0.873     .2164567    6.066541
          4  |   .5305024   .3627862    -0.93   0.354      .138864    2.026679
          5  |   1.10e-20          .        .       .            .           .
          6  |   2.26e-20          .        .       .            .           .
             |
     bmi_cat |
Underweight  |   1.593806   2.341891     0.32   0.751     .0894758       28.39
 Overweight  |    1.18226   1.196007     0.17   0.869     .1627848    8.586418
      Obese  |   .8033908   .6080174    -0.29   0.772     .1822744    3.541018
Morbidly ..  |    3.56076    4.99282     0.91   0.365     .2280375    55.60054
             |
     smoking |
Current s..  |     .29695   .2056101    -1.75   0.080     .0764374    1.153614
  Ex-smoker  |   .1108546   .1120557    -2.18   0.030     .0152873    .8038547
             |
severe_dis~e |   .2481091   .1652948    -2.09   0.036      .067229    .9156479
             |
vacc_count~v |
          1  |   .7270178   .4910114    -0.47   0.637     .1934919    2.731665
          2  |   .3168661   .3321303    -1.10   0.273     .0406134     2.47219
          3  |   9.17e-20          .        .       .            .           .
          4  |   1.70e-17          .        .       .            .           .
          5  |   4.17e-18          .        .       .            .           .
             |
 liver_trans |   4.77e-19          .        .       .            .           .
             |
time_vacc_~t |
Q1 closes..  |   8.38e-20          .        .       .            .           .
         Q2  |   2.586669   5.342181     0.46   0.645     .0451623    148.1514
         Q3  |   18.39517   37.37979     1.43   0.152     .3427874     987.149
Q4 furthe..  |   4.79e-18          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_hosp_any.ster saved
(note: file ./output/tempdata/surv_adj_vacc_hosp_any.dta not found)
file ./output/tempdata/surv_adj_vacc_hosp_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |            .            .        1             .
      age_tv      |      0.09016         0.45        1         0.5027
      male        |      0.02884         0.09        1         0.7677
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.07371         0.43        1         0.5113
      2.eth_bin   |      0.26818         7.16        1         0.0075
      1b.imd      |            .            .        1             .
      2.imd       |     -0.25642         5.80        1         0.0160
      3.imd       |     -0.24723         4.93        1         0.0263
      4.imd       |     -0.14029         0.86        1         0.3526
      5.imd       |            .            .        1             .
      6.imd       |            .            .        1             .
      1.bmi_cat   |     -0.19905         5.95        1         0.0147
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |     -0.32595         7.00        1         0.0082
      4.bmi_cat   |     -0.17556         2.03        1         0.1540
      5.bmi_cat   |     -0.09077         0.50        1         0.4773
      0b.smoking  |            .            .        1             .
      1.smoking   |     -0.29102         5.27        1         0.0217
      2.smoking   |     -0.23982         3.08        1         0.0794
      severe_dis~e|      0.22824         6.39        1         0.0115
      0b.vacc_co~v|            .            .        1             .
      1.vacc_cou~v|     -0.18310         1.51        1         0.2185
      2.vacc_cou~v|      0.26638         5.90        1         0.0151
      3.vacc_cou~v|            .            .        1             .
      4.vacc_cou~v|            .            .        1             .
      5.vacc_cou~v|            .            .        1             .
      liver_trans |            .            .        1             .
      1.time_vac~t|            .            .        1             .
      2.time_vac~t|      0.24432         7.97        1         0.0048
      3.time_vac~t|     -0.04751         0.36        1         0.5487
      4.time_vac~t|            .            .        1             .
      5b.time_va~t|            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     29.13       18         0.0468
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_vacc_hosp_any.svg not found)
(file ./output/graphs/schoenplot_vacc_hosp_any.svg written in SVG format)

         failure _d:  hosp_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
Iteration 0:   log pseudolikelihood = -62.571335
Iteration 1:   log pseudolikelihood = -52.132389
Iteration 2:   log pseudolikelihood = -47.361522
Iteration 3:   log pseudolikelihood = -46.798592
Iteration 4:   log pseudolikelihood = -46.663648
Iteration 5:   log pseudolikelihood = -46.614785
Iteration 6:   log pseudolikelihood = -46.596844
Iteration 7:   log pseudolikelihood = -46.590244
Iteration 8:   log pseudolikelihood = -46.587815
Iteration 9:   log pseudolikelihood = -46.586922
Iteration 10:  log pseudolikelihood = -46.586593
Iteration 11:  log pseudolikelihood = -46.586472
Iteration 12:  log pseudolikelihood = -46.586428
Iteration 13:  log pseudolikelihood = -46.586411
Iteration 14:  log pseudolikelihood = -46.586405
Iteration 15:  log pseudolikelihood = -46.586403
Iteration 16:  log pseudolikelihood = -46.586402
Iteration 17:  log pseudolikelihood = -46.586402
Iteration 18:  log pseudolikelihood = -46.586402
Iteration 19:  log pseudolikelihood = -46.586402
Iteration 20:  log pseudolikelihood = -46.586402
Iteration 21:  log pseudolikelihood = -46.586402
Iteration 22:  log pseudolikelihood = -46.586402
Iteration 23:  log pseudolikelihood = -46.586402
Iteration 24:  log pseudolikelihood = -46.586402
Iteration 25:  log pseudolikelihood = -46.586402
Iteration 26:  log pseudolikelihood = -46.586402
Iteration 27:  log pseudolikelihood = -46.586402
Iteration 28:  log pseudolikelihood = -46.586402
Iteration 29:  log pseudolikelihood = -46.586402
Iteration 30:  log pseudolikelihood = -46.586402
Iteration 31:  log pseudolikelihood = -46.586402
Iteration 32:  log pseudolikelihood = -46.586402
Iteration 33:  log pseudolikelihood = -46.586402
Iteration 34:  log pseudolikelihood = -46.586402
Iteration 35:  log pseudolikelihood = -46.586402
Refining estimates:
Iteration 0:   log pseudolikelihood = -46.586402
Iteration 1:   log pseudolikelihood = -46.586402
Iteration 2:   log pseudolikelihood = -46.586402

Stratified Cox regr. -- no ties

No. of subjects      =          985             Number of obs    =       1,413
No. of failures      =           32
Time at risk         =       495704
                                                Wald chi2(29)    =    15168.46
Log pseudolikelihood =   -46.586402             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   5.17e-17   3.32e-17   -58.39   0.000     1.47e-17    1.82e-16
      age_tv |    .988436   .0142098    -0.81   0.418      .960974    1.016683
        male |   .8225778   .5979593    -0.27   0.788     .1978837    3.419353
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .1126612    .240877    -1.02   0.307     .0017055    7.442157
      Asian  |   .8452109    .658149    -0.22   0.829     .1837178    3.888472
      Black  |   .9728303   1.002804    -0.03   0.979     .1290059     7.33609
      Other  |   .2529721   .3237847    -1.07   0.283     .0205874    3.108456
    Unknown  |   .9834299   1.241721    -0.01   0.989     .0827903    11.68173
             |
         imd |
          2  |   .2535016   .3439574    -1.01   0.312     .0177439    3.621701
          3  |   1.162492   .9544977     0.18   0.855      .232534    5.811571
          4  |   .5697679   .3584867    -0.89   0.371     .1660118    1.955497
          5  |   2.77e-17   2.78e-17   -37.95   0.000     3.87e-18    1.99e-16
          6  |   2.77e-17   2.85e-17   -37.10   0.000     3.70e-18    2.08e-16
             |
     bmi_cat |
Underweight  |   2.182165   2.661399     0.64   0.522     .1998712    23.82456
 Overweight  |   1.341603   1.394408     0.28   0.777     .1749522    10.28794
      Obese  |   .7740487   .5549268    -0.36   0.721     .1899019    3.155057
Morbidly ..  |   2.697668   3.834439     0.70   0.485     .1663792    43.73993
             |
     smoking |
Current s..  |   .2951771   .2174985    -1.66   0.098     .0696438    1.251073
  Ex-smoker  |   .1008507   .0924514    -2.50   0.012     .0167251    .6081185
             |
severe_dis~e |   .2220999   .1617696    -2.07   0.039     .0532799    .9258337
             |
vacc_count~v |
          1  |    .734308   .4587491    -0.49   0.621     .2158248     2.49836
          2  |   .3355712   .3658626    -1.00   0.317     .0396047      2.8433
          3  |   1.04e-17   1.54e-17   -26.43   0.000     5.72e-19    1.89e-16
          4  |   2.12e-15   4.44e-15   -16.12   0.000     3.47e-17    1.29e-13
          5  |   1.37e-18          .        .       .            .           .
             |
 liver_trans |   7.03e-18   7.44e-18   -37.35   0.000     8.85e-19    5.59e-17
             |
time_vacc_~t |
Q1 closes..  |   2.90e-17   4.57e-17   -24.12   0.000     1.31e-18    6.39e-16
         Q2  |   7.145211   11.59123     1.21   0.225     .2972785    171.7381
         Q3  |   16.80284   28.98884     1.64   0.102     .5712953    494.2023
Q4 furthe..  |   5.94e-16   6.41e-16   -32.50   0.000     7.17e-17    4.92e-15
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,838       64.76       64.76
          1 |      1,000       35.24      100.00
------------+-----------------------------------
      Total |      2,838      100.00
(1 missing value generated)

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        903       90.39       90.39
          1 |         96        9.61      100.00
------------+-----------------------------------
      Total |        999      100.00
  903
  30
no udca events = 30
(1838 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        903      449938           0     449938     449938
14997.933
200.02756
(1 missing value generated)

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        903       90.39       90.39
          1 |         96        9.61      100.00
------------+-----------------------------------
      Total |        999      100.00
udca events = .

Contains data from ./output/an_dataset_composite_any_vacc.dta
  obs:         2,838                          
 vars:            21                          25 Sep 2023 12:29
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
stp             str4    %9s                   
imd             byte    %8.0g                 
ethnicity       byte    %8.0g      eth5       
has_pbc         byte    %8.0g                 
oca_bl          byte    %8.0g                 
patient_id      int     %8.0g                 
male            float   %9.0g                 
eth_bin         float   %9.0g      eth_3      
bmi_cat         float   %14.0g     bmi        
smoking         float   %14.0g     smok       
any_high_risk~n float   %9.0g                 
time_vacc_cat   byte    %23.0g     vacc_t     4 quantiles of time_vacc
start           float   %9.0g                 
stop            float   %9.0g                 
composite_any~g float   %9.0g                 
age_tv          float   %9.0g                 
udca            float   %9.0g                 
liver_trans     float   %9.0g                 
vacc_count_tv   float   %9.0g                 
covid_vacc_fi~t float   %9.0g                 
severe_disease  float   %9.0g                 
-------------------------------------------------------------------------------
Sorted by: 
(1 missing value generated)

                id:  patient_id
     failure event:  composite_any_flag != 0 & composite_any_flag < .
obs. time interval:  (stop[_n-1], stop]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      2,838  total observations
          1  event time missing (stop>=.)                       PROBABLE ERROR
         10  multiple records at same instant                   PROBABLE ERROR
             (stop[_n-1]==stop)
------------------------------------------------------------------------------
      2,827  observations remaining, representing
        999  subjects
        136  failures in single-failure-per-subject data
    502,630  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       670
  136

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_vacc_composite_any.svg not found)
(file ./output/graphs/km_vacc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood =  -325.8791
Iteration 1:   log pseudolikelihood = -325.71451
Iteration 2:   log pseudolikelihood = -325.71328
Iteration 3:   log pseudolikelihood = -325.71328
Refining estimates:
Iteration 0:   log pseudolikelihood = -325.71328

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          999             Number of obs    =       1,423
No. of failures      =          136
Time at risk         =       502630
                                                Wald chi2(1)     =        0.33
Log pseudolikelihood =   -325.71328             Prob > chi2      =      0.5656

                           (Std. Err. adjusted for 500 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7877371   .3271525    -0.57   0.566     .3490371    1.777833
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_composite_any.ster saved
(note: file ./output/tempdata/surv_crude_vacc_composite_any.dta not found)
file ./output/tempdata/surv_crude_vacc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17894         2.00        1         0.1575
      ------------+---------------------------------------------------
      global test |                      2.00        1         0.1575
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log pseudolikelihood = -319.84915
Iteration 1:   log pseudolikelihood = -319.53943
Iteration 2:   log pseudolikelihood = -319.53837
Iteration 3:   log pseudolikelihood = -319.53837
Refining estimates:
Iteration 0:   log pseudolikelihood = -319.53837

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          985             Number of obs    =       1,413
No. of failures      =          135
Time at risk         =       495704
                                                Wald chi2(3)     =        0.58
Log pseudolikelihood =   -319.53837             Prob > chi2      =      0.8999

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .8030644   .3373972    -0.52   0.602     .3524755    1.829666
      age_tv |   .9971011   .0055344    -0.52   0.601     .9863127    1.008008
        male |   1.021075   .2550168     0.08   0.933      .625846    1.665897
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/p_adj_model_composite_any.ster saved
(note: file ./output/tempdata/p_surv_adj_vacc_composite_any.dta not found)
file ./output/tempdata/p_surv_adj_vacc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.17853         2.10        1         0.1474
      age_tv      |      0.15243         1.94        1         0.1637
      male        |      0.06961         0.34        1         0.5582
      ------------+---------------------------------------------------
      global test |                      4.01        3         0.2607
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
note: 5.vacc_count_tv omitted because of collinearity
Iteration 0:   log pseudolikelihood = -319.84915
Iteration 1:   log pseudolikelihood = -305.84115
Iteration 2:   log pseudolikelihood = -303.98548
Iteration 3:   log pseudolikelihood = -303.78519
Iteration 4:   log pseudolikelihood = -303.72243
Iteration 5:   log pseudolikelihood = -303.69942
Iteration 6:   log pseudolikelihood = -303.69096
Iteration 7:   log pseudolikelihood = -303.68785
Iteration 8:   log pseudolikelihood = -303.68671
Iteration 9:   log pseudolikelihood = -303.68629
Iteration 10:  log pseudolikelihood = -303.68613
Iteration 11:  log pseudolikelihood = -303.68608
Iteration 12:  log pseudolikelihood = -303.68606
Iteration 13:  log pseudolikelihood = -303.68605
Iteration 14:  log pseudolikelihood = -303.68604
Iteration 15:  log pseudolikelihood = -303.68604
Iteration 16:  log pseudolikelihood = -303.68604
Iteration 17:  log pseudolikelihood = -303.68604
Iteration 18:  log pseudolikelihood = -303.68604
Iteration 19:  log pseudolikelihood = -303.68604
Iteration 20:  log pseudolikelihood = -303.68604
Iteration 21:  log pseudolikelihood = -303.68604
Iteration 22:  log pseudolikelihood = -303.68604
Iteration 23:  log pseudolikelihood = -303.68604
Iteration 24:  log pseudolikelihood = -303.68604
Iteration 25:  log pseudolikelihood = -303.68604
Iteration 26:  log pseudolikelihood = -303.68604
Iteration 27:  log pseudolikelihood = -303.68604
Iteration 28:  log pseudolikelihood = -303.68604
Iteration 29:  log pseudolikelihood = -303.68604
Iteration 30:  log pseudolikelihood = -303.68604
Iteration 31:  log pseudolikelihood = -303.68604
Refining estimates:
Iteration 0:   log pseudolikelihood = -303.68604
Iteration 1:   log pseudolikelihood = -303.68604
Iteration 2:   log pseudolikelihood = -303.68604
Iteration 3:   log pseudolikelihood = -303.68604
Iteration 4:   log pseudolikelihood = -303.68604
Iteration 5:   log pseudolikelihood = -303.68604

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          985             Number of obs    =       1,413
No. of failures      =          135
Time at risk         =       495704
                                                Wald chi2(26)    =     8358.16
Log pseudolikelihood =   -303.68604             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .6926337   .3040302    -0.84   0.403     .2930018    1.637332
      age_tv |   .9962717   .0061227    -0.61   0.543     .9843435    1.008344
        male |    1.02037   .2763805     0.07   0.941     .6000655    1.735069
any_high_r~n |          1  (omitted)
             |
     eth_bin |
  Non-White  |   1.005422   .3827367     0.01   0.989     .4767817    2.120204
    Unknown  |   1.069477   .6969464     0.10   0.918     .2981731    3.835962
             |
         imd |
          2  |    .358011   .1745715    -2.11   0.035     .1376695    .9310113
          3  |   .9197707   .3130146    -0.25   0.806     .4720634    1.792086
          4  |   .6339112   .2352946    -1.23   0.219     .3062529    1.312129
          5  |   .3044633   .1468111    -2.47   0.014     .1183283    .7833961
          6  |   .5584678   .3911639    -0.83   0.406     .1415131     2.20394
             |
     bmi_cat |
Underweight  |   1.202431   .5934384     0.37   0.709     .4570512     3.16341
 Overweight  |   1.133316   .4037538     0.35   0.725      .563771    2.278238
      Obese  |   1.126541   .3674582     0.37   0.715      .594429    2.134982
Morbidly ..  |   2.786455   1.234183     2.31   0.021     1.169596    6.638473
             |
     smoking |
Current s..  |   .9813776    .437623    -0.04   0.966     .4095078    2.351853
  Ex-smoker  |   .3056198   .2100805    -1.72   0.085     .0794461    1.175683
             |
severe_dis~e |   .7645903   .1984001    -1.03   0.301     .4597845    1.271462
             |
vacc_count~v |
          1  |   .7017152   .2850858    -0.87   0.383     .3164778    1.555889
          2  |   .4730957   .2038191    -1.74   0.082     .2033454    1.100687
          3  |   1.645008   1.273464     0.64   0.520     .3607614     7.50094
          4  |   1.45e-16   1.28e-16   -41.25   0.000     2.56e-17    8.19e-16
          5  |          1  (omitted)
             |
 liver_trans |   1.59e-16   1.01e-16   -57.37   0.000     4.59e-17    5.51e-16
             |
time_vacc_~t |
Q1 closes..  |   2.32e-16   1.96e-16   -42.74   0.000     4.46e-17    1.21e-15
         Q2  |   .4791758   .5434743    -0.65   0.517     .0518889    4.425023
         Q3  |   3.349189   3.180614     1.27   0.203     .5206932    21.54257
Q4 furthe..  |   4.507648   3.685191     1.84   0.065     .9079399    22.37911
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/adj_model_composite_any.ster saved
(note: file ./output/tempdata/surv_adj_vacc_composite_any.dta not found)
file ./output/tempdata/surv_adj_vacc_composite_any.dta saved

      Test of proportional-hazards assumption

      Time:  Time
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob>chi2
      ------------+---------------------------------------------------
      udca        |      0.14835         2.58        1         0.1085
      age_tv      |      0.11467         2.23        1         0.1351
      male        |      0.17164         3.07        1         0.0797
      o.any_high~n|            .            .        1             .
      0b.eth_bin  |            .            .        1             .
      1.eth_bin   |     -0.07023         0.68        1         0.4085
      2.eth_bin   |      0.07981         0.97        1         0.3255
      1b.imd      |            .            .        1             .
      2.imd       |     -0.03426         0.19        1         0.6660
      3.imd       |     -0.08230         0.72        1         0.3964
      4.imd       |     -0.05406         0.24        1         0.6212
      5.imd       |      0.02615         0.10        1         0.7523
      6.imd       |     -0.09611         1.44        1         0.2295
      1.bmi_cat   |     -0.14659         3.35        1         0.0671
      2b.bmi_cat  |            .            .        1             .
      3.bmi_cat   |      0.00279         0.00        1         0.9720
      4.bmi_cat   |     -0.07474         0.82        1         0.3653
      5.bmi_cat   |      0.01272         0.02        1         0.8983
      0b.smoking  |            .            .        1             .
      1.smoking   |      0.03359         0.13        1         0.7133
      2.smoking   |     -0.06571         0.53        1         0.4668
      severe_dis~e|      0.20591         6.56        1         0.0104
      0b.vacc_co~v|            .            .        1             .
      1.vacc_cou~v|     -0.04671         0.26        1         0.6074
      2.vacc_cou~v|      0.01882         0.04        1         0.8424
      3.vacc_cou~v|     -0.07461         0.58        1         0.4453
      4.vacc_cou~v|      0.01861         0.01        1         0.9189
      5o.vacc_co~v|            .            .        1             .
      liver_trans |      0.09545         0.10        1         0.7472
      1.time_vac~t|     -0.04480         0.08        1         0.7774
      2.time_vac~t|      0.04643         0.27        1         0.6007
      3.time_vac~t|     -0.13554         3.79        1         0.0516
      4.time_vac~t|     -0.01202         0.02        1         0.9023
      5b.time_va~t|            .            .        1             .
      ------------+---------------------------------------------------
      global test |                     21.67       26         0.7065
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.
(note: file ./output/graphs/schoenplot_vacc_composite_any.svg not found)
(file ./output/graphs/schoenplot_vacc_composite_any.svg written in SVG format)

         failure _d:  composite_any_flag
   analysis time _t:  (stop-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: any_high_risk_condition omitted because of collinearity
note: 5.vacc_count_tv omitted because of collinearity
Iteration 0:   log pseudolikelihood = -319.84915
Iteration 1:   log pseudolikelihood =  -300.6811
Iteration 2:   log pseudolikelihood = -298.38341
Iteration 3:   log pseudolikelihood = -298.19565
Iteration 4:   log pseudolikelihood = -298.13773
Iteration 5:   log pseudolikelihood = -298.11649
Iteration 6:   log pseudolikelihood = -298.10868
Iteration 7:   log pseudolikelihood = -298.10581
Iteration 8:   log pseudolikelihood = -298.10475
Iteration 9:   log pseudolikelihood = -298.10436
Iteration 10:  log pseudolikelihood = -298.10422
Iteration 11:  log pseudolikelihood = -298.10417
Iteration 12:  log pseudolikelihood = -298.10415
Iteration 13:  log pseudolikelihood = -298.10414
Iteration 14:  log pseudolikelihood = -298.10414
Iteration 15:  log pseudolikelihood = -298.10414
Iteration 16:  log pseudolikelihood = -298.10414
Iteration 17:  log pseudolikelihood = -298.10414
Iteration 18:  log pseudolikelihood = -298.10414
Iteration 19:  log pseudolikelihood = -298.10414
Iteration 20:  log pseudolikelihood = -298.10414
Iteration 21:  log pseudolikelihood = -298.10414
Iteration 22:  log pseudolikelihood = -298.10414
Iteration 23:  log pseudolikelihood = -298.10414
Iteration 24:  log pseudolikelihood = -298.10414
Iteration 25:  log pseudolikelihood = -298.10414
Iteration 26:  log pseudolikelihood = -298.10414
Iteration 27:  log pseudolikelihood = -298.10414
Iteration 28:  log pseudolikelihood = -298.10414
Iteration 29:  log pseudolikelihood = -298.10414
Iteration 30:  log pseudolikelihood = -298.10414
Iteration 31:  log pseudolikelihood = -298.10414
Iteration 32:  log pseudolikelihood = -298.10414
Iteration 33:  log pseudolikelihood = -298.10414
Iteration 34:  log pseudolikelihood = -298.10414
Refining estimates:
Iteration 0:   log pseudolikelihood = -298.10414
Iteration 1:   log pseudolikelihood = -298.10414
Iteration 2:   log pseudolikelihood = -298.10414

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =          985             Number of obs    =       1,413
No. of failures      =          135
Time at risk         =       495704
                                                Wald chi2(29)    =     8538.54
Log pseudolikelihood =   -298.10414             Prob > chi2      =      0.0000

                           (Std. Err. adjusted for 494 clusters in patient_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        udca |   .7372717   .3004082    -0.75   0.454     .3317398    1.638542
      age_tv |   .9959512   .0063247    -0.64   0.523     .9836317    1.008425
        male |   .9814328   .2765875    -0.07   0.947     .5649042    1.705086
any_high_r~n |          1  (omitted)
             |
   ethnicity |
      Mixed  |   .3770966   .2219176    -1.66   0.097     .1189951    1.195023
      Asian  |   1.568809   .6503988     1.09   0.277     .6961096    3.535593
      Black  |   1.264409   .5584374     0.53   0.595      .532043    3.004888
      Other  |   .8112319   .3908836    -0.43   0.664     .3155023    2.085871
    Unknown  |   1.101354   .7283199     0.15   0.884     .3013229    4.025522
             |
         imd |
          2  |    .378525   .1839575    -2.00   0.046     .1460237    .9812186
          3  |   .9501852   .3158632    -0.15   0.878     .4952785    1.822917
          4  |   .6306365   .2409264    -1.21   0.228     .2982557    1.333428
          5  |   .2836624   .1370351    -2.61   0.009     .1100507    .7311572
          6  |   .5460342   .3899559    -0.85   0.397     .1346869    2.213677
             |
     bmi_cat |
Underweight  |   1.323028   .6648609     0.56   0.578     .4941002    3.542608
 Overweight  |   1.114923   .4032454     0.30   0.764     .5487596    2.265205
      Obese  |    1.09323   .3515786     0.28   0.782     .5820607    2.053311
Morbidly ..  |   2.287568   1.068028     1.77   0.076     .9161403    5.711971
             |
     smoking |
Current s..  |    .951261   .4247784    -0.11   0.911     .3964624    2.282429
  Ex-smoker  |   .3083766   .2150267    -1.69   0.092     .0786232    1.209518
             |
severe_dis~e |   .7308047   .1942458    -1.18   0.238     .4340645    1.230406
             |
vacc_count~v |
          1  |   .7173236   .2919955    -0.82   0.414     .3230152    1.592969
          2  |   .4989905   .2151316    -1.61   0.107     .2143437    1.161646
          3  |   1.740906   1.355575     0.71   0.476     .3784239    8.008888
          4  |   1.38e-16   1.29e-16   -39.09   0.000     2.22e-17    8.63e-16
          5  |          1  (omitted)
             |
 liver_trans |   9.95e-17   6.57e-17   -55.81   0.000     2.73e-17    3.63e-16
             |
time_vacc_~t |
Q1 closes..  |   2.02e-16   1.58e-16   -46.21   0.000     4.37e-17    9.37e-16
         Q2  |   .6945597   .7137611    -0.35   0.723     .0926779    5.205267
         Q3  |   3.237305   3.085541     1.23   0.218     .4999034    20.96434
Q4 furthe..  |   5.312784   3.819344     2.32   0.020     1.298363    21.73943
------------------------------------------------------------------------------
                                                             Stratified by stp

     number |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,838       64.76       64.76
          1 |      1,000       35.24      100.00
------------+-----------------------------------
      Total |      2,838      100.00
(1 missing value generated)

unexposed_e |
        ver |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        903       90.39       90.39
          1 |         96        9.61      100.00
------------+-----------------------------------
      Total |        999      100.00
  903
  125
no udca events = 125
(1838 missing values generated)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
total_foll~p |        903      449938           0     449938     449938
14997.933
833.44816
(1 missing value generated)

exposed_eve |
          r |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        903       90.39       90.39
          1 |         96        9.61      100.00
------------+-----------------------------------
      Total |        999      100.00
udca events = 11

. 
. file close tablecontent

. 
end of do-file

. . file open output using "/tmp/106_analysis_models.do.Xlak.out", write text r
> eplace

. . file write output "success" 

. . file close output

. 
end of do-file


