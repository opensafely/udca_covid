
. 
. cap mkdir ./output/tables/

. 
. /** First import udca population
> import delimited using ./output/input.csv
> 
> * Format dates 
> foreach var in udca_last_date udca_first_after udca_first_history died_date_o
> ns {
>     gen `var'A = date(`var', "YMD")
>     format `var'A %dD/N/CY
>     *list `var' `var'A in  1/5
>     drop `var'
> }
> 
> /* DEMOGRAPHICS */ 
> 
> * Sex
> gen male = 1 if sex == "M"
> replace male = 0 if sex == "F"
> 
> /*  Age variables  */ 
> 
> * Create categorised age
> recode age 18/39.9999 = 1 /// 
>            40/49.9999 = 2 ///
>                    50/59.9999 = 3 ///
>                60/69.9999 = 4 ///
>                    70/79.9999 = 5 ///
>                    80/max = 6, gen(agegroup) 
> 
> label define agegroup   1 "18-<40" ///
>                                                 2 "40-<50" ///
>                                                 3 "50-<60" ///
>                                                 4 "60-<70" ///
>                                                 5 "70-<80" ///
>                                                 6 "80+"
>                                                 
> label values agegroup agegroup
> 
> /* EXPOSURE INFORMATION ====================================================*
> /
> rename udca_last_date udca_date
> gen udca = 1 if udca_count_bl != . & udca_count_bl >= 2
> recode udca .=0
> 
> gen udca_sa = 1 if udca_count_bl != . & udca_count_bl >= 1 & udca_date != . &
>  udca_date >= mdy(12,1,2019)
> recode udca_sa .=0
> 
> tab1 udca udca_sa, m
> tab udca udca_sa, m
> 
> *tab  udca_count_bl udca, m
> 
> * when was first udca Rx before index date
> gen udca_first = 0 if udca == 0
> replace udca_first = 1 if udca == 1 & udca_first_history >= mdy(9,1,2019) & u
> dca_first_history < mdy(3,1,2020) 
> replace udca_first = 2 if udca == 1 & udca_first_history >= mdy(3,1,2019) & u
> dca_first_history < mdy(9,1,2019) 
> replace udca_first = 3 if udca == 1 & udca_first_history >= mdy(9,1,2018) & u
> dca_first_history < mdy(3,1,2019) 
> replace udca_first = 4 if udca == 1 & udca_first_history >= mdy(9,1,2017) & u
> dca_first_history < mdy(9,1,2018) 
> replace udca_first = 5 if udca == 1 & udca_first_history >= mdy(9,1,2016) & u
> dca_first_history < mdy(9,1,2017) 
> replace udca_first = 6 if udca == 1 & udca_first_history >= mdy(9,1,2015) & u
> dca_first_history < mdy(9,1,2016) 
> replace udca_first = 7 if udca == 1 & udca_first_history >= mdy(9,1,2014) & u
> dca_first_history < mdy(9,1,2015) 
> replace udca_first = 8 if udca == 1 &                                        
>                                      udca_first_history < mdy(9,1,2014) 
> 
> label define udca_first         0 "unexposed"                                
>                            ///
>                                                 1 "within exposure window"   
>                                    ///
>                                                 2 "up to 6 mos before exposur
> e window"          ///
>                                                 3 "6 mos to 1 yr before expos
> ure window"        ///
>                                                 4 "1 to 2 yr before exposure 
> window"            ///
>                                                 5 "2 to 3 yr before exposure 
> window"            ///
>                                                 6 "3 to 4 yr before exposure 
> window"            ///
>                                                 7 "4 to 5 yr before exposure 
> window"            ///
>                                                 8 "5+ yr before exposure wind
> ow"
> label values udca_first udca_first
> 
> * Flag if died
> gen died_flag = died_date_onsA!=.
> * Generate date if died of covid
> gen died_date_onscovid = died_date_onsA if died_ons_covid_flag_any == 1
> 
> gen died_covid_2020 = (died_date_onscovid<date("31Dec2020", "DMY") & died_fla
> g==1)
> 
> gen pbc_psc = (has_pbc==1)
> replace pbc_psc = 2 if has_psc==1
> tab pbc_psc, m
> tab has_pbc has_psc 
> 
> **** Summary INFORMATION
> ** Currently dataset includes all people with at least one udca prescription
> * Tabulate pbc diagnosis vs those with 2+ prescriptions in 6 months prior
> tab has_pbc udca, m 
> 
> * Tabulating time since first prescription by whether have 2+ prescriptions i
> n the last 6 months
> tab udca_first udca, m col
> 
> bys udca: sum udca_count_bl
> 
> * Export to table 
> preserve
> table1_mc, by(udca) vars(has_pbc bin \ has_psc bin) saving(./output/tables/ud
> ca_all.xlsx, replace)
> restore 
> 
> * How many COVID-19 deaths in those with pbc and 2+ prescriptions
> tab died_ons_covid_flag_any has_pbc if udca==1, row
> tab died_covid_2020 has_pbc if udca==1, row col
> tab died_flag has_pbc if udca==1, row col
> 
> * How many COVID-19 deaths in those with psc and 2+ prescriptions
> tab died_ons_covid_flag_any has_psc if udca==1, row
> tab died_covid_2020 has_psc if udca==1, row col
> tab died_flag has_psc if udca==1, row col
> 
> * Summary demographics
> tab agegroup has_pbc if udca==1, row col m 
> tab sex has_pbc if udca==1, row col m 
> 
> tab agegroup has_psc if udca==1, row col m 
> tab sex has_psc if udca==1, row col m 
> 
> * Export to table 
> keep if udca==1
> table1_mc, by(has_pbc) vars(died_ons_covid_flag_any bin \ died_covid_2020 bin
>  \ died_flag bin \ agegroup cat \ male bin) saving(./output/tables/udca_only.
> xlsx, replace)
> 
> table1_mc, by(has_pbc) vars(udca_first cat) saving(./output/tables/udca_first
> _only.xlsx, replace)
> 
> table1_mc, by(has_psc) vars(died_ons_covid_flag_any bin \ died_covid_2020 bin
>  \ died_flag bin \ agegroup cat \ male bin) saving(./output/tables/udca_only.
> xlsx, replace)
> 
> table1_mc, by(has_psc) vars(udca_first cat) saving(./output/tables/udca_first
> _only.xlsx, replace)
> 
> * Deaths in those prescribed OBA with PBC 
> keep if has_pbc 
> table1_mc, by(oba) vars(died_ons_covid_flag_any bin \ died_covid_2020 bin \ d
> ied_flag bin \ agegroup cat \ male bin) saving(./output/tables/oba_only.xlsx,
>  replace) 
> */
. ** Next import the PBC population
. 
. import delimited using ./output/input_pbc.csv, clear
(98 vars, 1,000 obs)

. 
. * Format dates 
. foreach var in udca_last_date udca_first_after udca_first_history died_date_o
> ns hosp_covid_primary hosp_covid_any {
  2.     gen `var'A = date(`var', "YMD")
  3.     format `var'A %dD/N/CY
  4.     *list `var' `var'A in  1/5
.     drop `var'
  5. }
(500 missing values generated)
(500 missing values generated)
(500 missing values generated)
(500 missing values generated)
(900 missing values generated)
(900 missing values generated)

. 
. /* DEMOGRAPHICS */ 
. 
. * Sex
. gen male = 1 if sex == "M"
(518 missing values generated)

. replace male = 0 if sex == "F"
(507 real changes made)

. 
. /*  Age variables  */ 
. 
. * Create categorised age
. recode age 18/39.9999 = 1 /// 
>            40/49.9999 = 2 ///
>                    50/59.9999 = 3 ///
>                60/69.9999 = 4 ///
>                    70/79.9999 = 5 ///
>                    80/max = 6, gen(agegroup) 
(783 differences between age and agegroup)

. 
. label define agegroup   1 "18-<40" ///
>                                                 2 "40-<50" ///
>                                                 3 "50-<60" ///
>                                                 4 "60-<70" ///
>                                                 5 "70-<80" ///
>                                                 6 "80+"

.                                                 
. label values agegroup agegroup

. 
. /* EXPOSURE INFORMATION ====================================================*
> /
. rename udca_last_date udca_date

. * Create variable for 2 or more prescriptions in 6 months prior to baseline
. gen udca_bl = 1 if udca_count_bl != . & udca_count_bl >= 2
(813 missing values generated)

. recode udca_bl .=0
(udca_bl: 813 changes made)

. * Create variable for 1 or more prescriptions in 30 days prior to baseline 
. gen udca_bl_30 = 1 if udca_count_bl != . & udca_count_bl >= 1 & udca_date != 
> . & udca_date >= mdy(2,1,2020)
(976 missing values generated)

. recode udca_bl_30 .=0
(udca_bl_30: 976 changes made)

. * Create variable for 1 or more prescriptions in 90 days prior to baseline 
. gen udca_bl_90 = 1 if udca_count_bl != . & udca_count_bl >= 1 & udca_date != 
> . & udca_date >= mdy(12,1,2019)
(942 missing values generated)

. recode udca_bl_30 .=0
(udca_bl_30: 0 changes made)

. 
. tab udca_bl udca_bl_30, m

           |      udca_bl_30
   udca_bl |         0          1 |     Total
-----------+----------------------+----------
         0 |       809          4 |       813 
         1 |       167         20 |       187 
-----------+----------------------+----------
     Total |       976         24 |     1,000 

. tab udca_bl udca_bl_90, m

           |      udca_bl_90
   udca_bl |         1          . |     Total
-----------+----------------------+----------
         0 |        10        803 |       813 
         1 |        48        139 |       187 
-----------+----------------------+----------
     Total |        58        942 |     1,000 

. 
. *tab  udca_count_bl udca, m
. 
. * when was first udca Rx before index date
. gen udca_first = 0 if udca_bl== 0
(187 missing values generated)

. replace udca_first = 1 if udca_bl== 1 & udca_first_history >= mdy(9,1,2019) &
>  udca_first_history < mdy(3,1,2020) 
(1 real change made)

. replace udca_first = 2 if udca_bl== 1 & udca_first_history >= mdy(3,1,2019) &
>  udca_first_history < mdy(9,1,2019) 
(1 real change made)

. replace udca_first = 3 if udca_bl== 1 & udca_first_history >= mdy(9,1,2018) &
>  udca_first_history < mdy(3,1,2019) 
(0 real changes made)

. replace udca_first = 4 if udca_bl== 1 & udca_first_history >= mdy(9,1,2017) &
>  udca_first_history < mdy(9,1,2018) 
(0 real changes made)

. replace udca_first = 5 if udca_bl== 1 & udca_first_history >= mdy(9,1,2016) &
>  udca_first_history < mdy(9,1,2017) 
(2 real changes made)

. replace udca_first = 6 if udca_bl== 1 & udca_first_history >= mdy(9,1,2015) &
>  udca_first_history < mdy(9,1,2016) 
(0 real changes made)

. replace udca_first = 7 if udca_bl== 1 & udca_first_history >= mdy(9,1,2014) &
>  udca_first_history < mdy(9,1,2015) 
(1 real change made)

. replace udca_first = 8 if udca_bl== 1 &                                      
>                                              udca_first_history < mdy(9,1,201
> 4) 
(84 real changes made)

. 
. label define udca_first         0 "unexposed"                                
>                            ///
>                                                 1 "within exposure window"   
>                                    ///
>                                                 2 "up to 6 mos before exposur
> e window"          ///
>                                                 3 "6 mos to 1 yr before expos
> ure window"        ///
>                                                 4 "1 to 2 yr before exposure 
> window"            ///
>                                                 5 "2 to 3 yr before exposure 
> window"            ///
>                                                 6 "3 to 4 yr before exposure 
> window"            ///
>                                                 7 "4 to 5 yr before exposure 
> window"            ///
>                                                 8 "5+ yr before exposure wind
> ow"

. label values udca_first udca_first

. 
. * Flag if died
. gen died_flag = died_date_onsA!=.

. * Generate date if died of covid
. gen died_date_onscovid = died_date_onsA if died_ons_covid_flag_any == 1
(755 missing values generated)

. gen died_covid_2020 = (died_date_onscovid<date("31Dec2020", "DMY") & died_fla
> g==1)

. 
. * Flag hospitalised with covid 
. gen hosp_primary_flag = hosp_covid_primaryA!=.

. gen hosp_primary_flag_2020 = hosp_covid_primaryA<date("31Dec2020", "DMY") & h
> osp_primary_flag==1

. gen hosp_any_flag = hosp_covid_anyA!=.

. gen hosp_any_flag_2020 = hosp_covid_anyA<date("31Dec2020", "DMY") & hosp_any_
> flag==1

. 
. **** Summary INFORMATION
. ** Currently dataset includes all people with a pbc or psc diagnosis, how man
> y have 2+ udca prescription
. * Tabulate pbc or psc diagnosis vs those with 2+ prescriptions in 6 months pr
> ior
. tab udca_bl, m 

    udca_bl |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        813       81.30       81.30
          1 |        187       18.70      100.00
------------+-----------------------------------
      Total |      1,000      100.00

. 
. * Determine number with psc vs pbc with 2+ prescriptions
. tab has_pbc has_psc if udca_bl==1

           |        has_psc
   has_pbc |         0          1 |     Total
-----------+----------------------+----------
         0 |        41         39 |        80 
         1 |        56         51 |       107 
-----------+----------------------+----------
     Total |        97         90 |       187 

. 
. * Tabulating time since first prescription by whether have 2+ prescriptions i
> n the last 6 months
. tab udca_first udca_bl, col m

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

                      |        udca_bl
           udca_first |         0          1 |     Total
----------------------+----------------------+----------
            unexposed |       813          0 |       813 
                      |    100.00       0.00 |     81.30 
----------------------+----------------------+----------
within exposure windo |         0          1 |         1 
                      |      0.00       0.53 |      0.10 
----------------------+----------------------+----------
up to 6 mos before ex |         0          1 |         1 
                      |      0.00       0.53 |      0.10 
----------------------+----------------------+----------
2 to 3 yr before expo |         0          2 |         2 
                      |      0.00       1.07 |      0.20 
----------------------+----------------------+----------
4 to 5 yr before expo |         0          1 |         1 
                      |      0.00       0.53 |      0.10 
----------------------+----------------------+----------
5+ yr before exposure |         0         84 |        84 
                      |      0.00      44.92 |      8.40 
----------------------+----------------------+----------
                    . |         0         98 |        98 
                      |      0.00      52.41 |      9.80 
----------------------+----------------------+----------
                Total |       813        187 |     1,000 
                      |    100.00     100.00 |    100.00 

. 
. * Check number of prescriptions
. bys udca_bl: sum udca_count_bl

-------------------------------------------------------------------------------
-> udca_bl = 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
udca_count~l |        813    .0516605     .284731         -2          1

-------------------------------------------------------------------------------
-> udca_bl = 1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
udca_count~l |        187    3.652406    1.459869          2          8


. bys udca_bl: sum udca_count_fu, d 

-------------------------------------------------------------------------------
-> udca_bl = 0

                        udca_count_fu
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0             -3
 5%            0             -2
10%            0             -1       Obs                 813
25%            0             -1       Sum of Wgt.         813

50%            0                      Mean           .7306273
                        Largest       Std. Dev.      1.567845
75%            0              7
90%            3              8       Variance       2.458137
95%            4              8       Skewness       2.135217
99%            6              8       Kurtosis       7.106546

-------------------------------------------------------------------------------
-> udca_bl = 1

                        udca_count_fu
-------------------------------------------------------------
      Percentiles      Smallest
 1%           -1             -1
 5%            0             -1
10%            0              0       Obs                 187
25%            0              0       Sum of Wgt.         187

50%            0                      Mean           .7326203
                        Largest       Std. Dev.      1.419206
75%            1              5
90%            3              5       Variance       2.014145
95%            4              5       Skewness       1.803058
99%            5              6       Kurtosis       5.165565


. 
. gen one_udca_bl = udca_count_bl==1

. 
. * How many COVID-19 deaths by whether had 2+ prescriptions
. tab died_ons_covid_flag_any udca_bl, row col 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

died_ons_c |
ovid_flag_ |        udca_bl
       any |         0          1 |     Total
-----------+----------------------+----------
         0 |       404         96 |       500 
           |     80.80      19.20 |    100.00 
           |     49.69      51.34 |     50.00 
-----------+----------------------+----------
         1 |       409         91 |       500 
           |     81.80      18.20 |    100.00 
           |     50.31      48.66 |     50.00 
-----------+----------------------+----------
     Total |       813        187 |     1,000 
           |     81.30      18.70 |    100.00 
           |    100.00     100.00 |    100.00 

. tab died_covid_2020 udca_bl, row col 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

died_covid |        udca_bl
     _2020 |         0          1 |     Total
-----------+----------------------+----------
         0 |       757        178 |       935 
           |     80.96      19.04 |    100.00 
           |     93.11      95.19 |     93.50 
-----------+----------------------+----------
         1 |        56          9 |        65 
           |     86.15      13.85 |    100.00 
           |      6.89       4.81 |      6.50 
-----------+----------------------+----------
     Total |       813        187 |     1,000 
           |     81.30      18.70 |    100.00 
           |    100.00     100.00 |    100.00 

. tab died_flag udca_bl, row col 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

           |        udca_bl
 died_flag |         0          1 |     Total
-----------+----------------------+----------
         0 |       410         90 |       500 
           |     82.00      18.00 |    100.00 
           |     50.43      48.13 |     50.00 
-----------+----------------------+----------
         1 |       403         97 |       500 
           |     80.60      19.40 |    100.00 
           |     49.57      51.87 |     50.00 
-----------+----------------------+----------
     Total |       813        187 |     1,000 
           |     81.30      18.70 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. 
. * Summary demographics
. tab agegroup udca_bl, row col m 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

 RECODE of |        udca_bl
       age |         0          1 |     Total
-----------+----------------------+----------
         0 |         5          4 |         9 
           |     55.56      44.44 |    100.00 
           |      0.62       2.14 |      0.90 
-----------+----------------------+----------
    18-<40 |       226         54 |       280 
           |     80.71      19.29 |    100.00 
           |     27.80      28.88 |     28.00 
-----------+----------------------+----------
    40-<50 |       104         32 |       136 
           |     76.47      23.53 |    100.00 
           |     12.79      17.11 |     13.60 
-----------+----------------------+----------
    50-<60 |       144         22 |       166 
           |     86.75      13.25 |    100.00 
           |     17.71      11.76 |     16.60 
-----------+----------------------+----------
    60-<70 |        86         17 |       103 
           |     83.50      16.50 |    100.00 
           |     10.58       9.09 |     10.30 
-----------+----------------------+----------
    70-<80 |        88         19 |       107 
           |     82.24      17.76 |    100.00 
           |     10.82      10.16 |     10.70 
-----------+----------------------+----------
       80+ |        53         15 |        68 
           |     77.94      22.06 |    100.00 
           |      6.52       8.02 |      6.80 
-----------+----------------------+----------
         7 |         8          2 |        10 
           |     80.00      20.00 |    100.00 
           |      0.98       1.07 |      1.00 
-----------+----------------------+----------
         8 |        11          4 |        15 
           |     73.33      26.67 |    100.00 
           |      1.35       2.14 |      1.50 
-----------+----------------------+----------
         9 |        10          3 |        13 
           |     76.92      23.08 |    100.00 
           |      1.23       1.60 |      1.30 
-----------+----------------------+----------
        10 |         8          2 |        10 
           |     80.00      20.00 |    100.00 
           |      0.98       1.07 |      1.00 
-----------+----------------------+----------
        11 |        12          2 |        14 
           |     85.71      14.29 |    100.00 
           |      1.48       1.07 |      1.40 
-----------+----------------------+----------
        12 |        12          3 |        15 
           |     80.00      20.00 |    100.00 
           |      1.48       1.60 |      1.50 
-----------+----------------------+----------
        13 |        11          1 |        12 
           |     91.67       8.33 |    100.00 
           |      1.35       0.53 |      1.20 
-----------+----------------------+----------
        14 |         6          1 |         7 
           |     85.71      14.29 |    100.00 
           |      0.74       0.53 |      0.70 
-----------+----------------------+----------
        15 |         9          4 |        13 
           |     69.23      30.77 |    100.00 
           |      1.11       2.14 |      1.30 
-----------+----------------------+----------
        16 |        10          2 |        12 
           |     83.33      16.67 |    100.00 
           |      1.23       1.07 |      1.20 
-----------+----------------------+----------
        17 |        10          0 |        10 
           |    100.00       0.00 |    100.00 
           |      1.23       0.00 |      1.00 
-----------+----------------------+----------
     Total |       813        187 |     1,000 
           |     81.30      18.70 |    100.00 
           |    100.00     100.00 |    100.00 

. tab sex udca_bl, row col m 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

           |        udca_bl
       sex |         0          1 |     Total
-----------+----------------------+----------
         F |       420         87 |       507 
           |     82.84      17.16 |    100.00 
           |     51.66      46.52 |     50.70 
-----------+----------------------+----------
         M |       385         97 |       482 
           |     79.88      20.12 |    100.00 
           |     47.36      51.87 |     48.20 
-----------+----------------------+----------
         U |         8          3 |        11 
           |     72.73      27.27 |    100.00 
           |      0.98       1.60 |      1.10 
-----------+----------------------+----------
     Total |       813        187 |     1,000 
           |     81.30      18.70 |    100.00 
           |    100.00     100.00 |    100.00 

. tab oca_bl udca_bl, row col m 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

           |        udca_bl
    oca_bl |         0          1 |     Total
-----------+----------------------+----------
         0 |       409         91 |       500 
           |     81.80      18.20 |    100.00 
           |     50.31      48.66 |     50.00 
-----------+----------------------+----------
         1 |       404         96 |       500 
           |     80.80      19.20 |    100.00 
           |     49.69      51.34 |     50.00 
-----------+----------------------+----------
     Total |       813        187 |     1,000 
           |     81.30      18.70 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. * Export to table 
. * First drop out categories that will not be in real data > should be zero on
>  server
. drop if agegroup<1 | agegroup>6
(140 observations deleted)

. table1_mc, by(udca_bl) vars(has_pbc bin \ one_udca_bl bin \ udca_bl_30 bin \ 
> udca_bl_90 bin \ died_ons_covid_flag_any bin \ died_covid_2020 bin \ died_fla
> g bin \ hosp_primary_flag bin \ hosp_primary_flag_2020 bin \ hosp_any_flag bi
> n \ hosp_any_flag_2020 bin \ agegroup cat \ male bin) clear

  +-------------------------------------------------+
  | factor                    N_0   N_1   m_0   m_1 |
  |-------------------------------------------------|
  | has_pbc                   701   159     0     0 |
  |-------------------------------------------------|
  | one_udca_bl               701   159     0     0 |
  |-------------------------------------------------|
  | udca_bl_30                701   159     0     0 |
  |-------------------------------------------------|
  | udca_bl_90                  8    40   693   119 |
  |-------------------------------------------------|
  | died_ons_covid_flag_any   701   159     0     0 |
  |-------------------------------------------------|
  | died_covid_2020           701   159     0     0 |
  |-------------------------------------------------|
  | died_flag                 701   159     0     0 |
  |-------------------------------------------------|
  | hosp_primary_flag         701   159     0     0 |
  |-------------------------------------------------|
  | hosp_primary_flag_2020    701   159     0     0 |
  |-------------------------------------------------|
  | hosp_any_flag             701   159     0     0 |
  |-------------------------------------------------|
  | hosp_any_flag_2020        701   159     0     0 |
  |-------------------------------------------------|
  | RECODE of age             701   159     0     0 |
  |-------------------------------------------------|
  | male                      694   156     7     3 |
  +-------------------------------------------------+
   N_ ... #records used below,   m_ ... #records not used
 
  +------------------------------------------------------------------------+
  |                                    udca_bl = 0   udca_bl = 1   p-value |
  |------------------------------------------------------------------------|
  |                                    N=701         N=159                 |
  |------------------------------------------------------------------------|
  | has_pbc                            340 (48.5%)   91 (57.2%)     0.047  |
  |------------------------------------------------------------------------|
  | one_udca_bl                        46 ( 6.6%)    0 ( 0.0%)     <0.001  |
  |------------------------------------------------------------------------|
  | udca_bl_30                         2 ( 0.3%)     17 (10.7%)    <0.001  |
  |------------------------------------------------------------------------|
  | udca_bl_90                         8 (100%)      40 (100%)             |
  |------------------------------------------------------------------------|
  | died_ons_covid_flag_any            346 (49.4%)   76 (47.8%)     0.72   |
  |------------------------------------------------------------------------|
  | died_covid_2020                    43 ( 6.1%)    9 ( 5.7%)      0.82   |
  |------------------------------------------------------------------------|
  | died_flag                          341 (48.6%)   82 (51.6%)     0.50   |
  |------------------------------------------------------------------------|
  | hosp_primary_flag                  75 (10.7%)    12 ( 7.5%)     0.23   |
  |------------------------------------------------------------------------|
  | hosp_primary_flag_2020             19 ( 2.7%)    4 ( 2.5%)      0.89   |
  |------------------------------------------------------------------------|
  | hosp_any_flag                      66 ( 9.4%)    21 (13.2%)     0.15   |
  |------------------------------------------------------------------------|
  | hosp_any_flag_2020                 19 ( 2.7%)    9 ( 5.7%)      0.058  |
  |------------------------------------------------------------------------|
  | RECODE of age             18-<40   226 (32.2%)   54 (34.0%)     0.28   |
  |                           40-<50   104 (14.8%)   32 (20.1%)            |
  |                           50-<60   144 (20.5%)   22 (13.8%)            |
  |                           60-<70   86 (12.3%)    17 (10.7%)            |
  |                           70-<80   88 (12.6%)    19 (11.9%)            |
  |                           80+      53 ( 7.6%)    15 ( 9.4%)            |
  |------------------------------------------------------------------------|
  | male                               322 (46.4%)   81 (51.9%)     0.21   |
  +------------------------------------------------------------------------+
Data are presented as n (%).
 

. export delimited using ./output/tables/udca_pbc.csv
file ./output/tables/udca_pbc.csv saved

. describe

Contains data from /tmp/St00015.000001
  obs:            20                          
 vars:            13                          16 Jun 2023 12:03
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
factor          str23   %-23s                 Factor
level           str6    %-9s                  Level
udca_bl_0       str11   %-11s                 udca_bl = 0
udca_bl_1       str11   %-11s                 udca_bl = 1
pvalue          str7    %-9s                  p-value
N_0             str11   %11s                  
N_1             str11   %11s                  
m_0             str11   %11s                  
m_1             str11   %11s                  
_columna_0      str11   %6s                   0 _columna_
_columnb_0      str11   %-11s                 0 _columnb_
_columna_1      str11   %6s                   1 _columna_
_columnb_1      str11   %-11s                 1 _columnb_
-------------------------------------------------------------------------------
Sorted by: 
     Note: Dataset has changed since last saved.

. destring _columna_0, gen(n0) ignore(",") force
_columna_0: contains nonnumeric characters not specified in ignore(); n0 genera
> ted as int
(2 missing values generated)

. destring _columna_1, gen(n1) ignore(",") force
_columna_1: contains nonnumeric characters not specified in ignore(); n1 genera
> ted as byte
(2 missing values generated)

. destring _columnb_0, gen(percent0) ignore("-" "%" "(" ")") force
_columnb_0: contains nonnumeric characters not specified in ignore()
_columnb_0: characters space % ( ) removed; percent0 generated as double
(2 missing values generated)

. destring _columnb_1, gen(percent1) ignore("-" "%" "(" ")") force
_columnb_1: contains nonnumeric characters not specified in ignore()
_columnb_1: characters space % ( ) removed; percent1 generated as double
(2 missing values generated)

. gen rounded_n0 = round(n0, 5)
(2 missing values generated)

. gen rounded_n1 = round(n1, 5)
(2 missing values generated)

. keep factor level rounded_n0 percent0 rounded_n1 percent1

. export delimited using ./output/tables/udca_pbc_rounded.csv
file ./output/tables/udca_pbc_rounded.csv saved

. 
. *import excel using ./output/tables/oba_only.xlsx, clear 
. *export delimited using ./output/tables/oba_only.csv, replace 
. 
. 
. 
. 
end of do-file

. . file open output using "/tmp/feasibility.do.GkBh.out", write text replace

. . file write output "success" 

. . file close output

. 
end of do-file


